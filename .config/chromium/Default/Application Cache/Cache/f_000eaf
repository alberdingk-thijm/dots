Jf.prototype.Zaa=fa(39,function(){return yc(this,3)});Qx.prototype.Zaa=fa(38,function(){return yc(this,5)});Jf.prototype.P9=fa(37,function(){return B(this,3)});Qx.prototype.P9=fa(36,function(){return B(this,5)});Jf.prototype.bba=fa(35,function(){return yc(this,2)});Qx.prototype.bba=fa(34,function(){return yc(this,4)});Jf.prototype.e$=fa(33,function(){return B(this,2)});Qx.prototype.e$=fa(32,function(){return B(this,4)});We.prototype.getHeaderRange=fa(27,function(){return B(this,2)});
function uBc(a){for(var b in a.C)a.eb(b,!0)}function vBc(a,b){a.D=b}function wBc(a){return IC()?(new vC(a.J)).dc("title"):""}function xBc(a,b){var c=zk(a,b);return t(c)?String(zk(a,b)):null}function yBc(a){return null!=a?a:Number.MAX_VALUE}function zBc(a){return null!=a?a:Number.MIN_VALUE}function ABc(a){return yc(a,1)&&yc(a,2)&&a.Tf()==a.Qg()}function BBc(a){return"%"+a.charCodeAt(0).toString(16)}var CBc=/['()]/g;
function DBc(a,b){return ABc(b)?ABc(a)&&a.Tf()==b.Tf():ABc(a)?zBc(a.Tf())>zBc(b.Tf())&&zBc(a.Tf())<yBc(b.Qg()):zBc(a.Tf())>=zBc(b.Tf())&&yBc(a.Qg())<=yBc(b.Qg())}function EBc(a){return a.Hl()+ib(a.C)}function FBc(a){var b=new Vd;b.setType(0);var c=new Fd,d=new Dd;C(d,1,2);a=Xa(a);C(d,2,a);c.gb(d);d=new ld;d.setType(0);C(c,1,d);C(b,5,c);return b}function GBc(a){a=Ya(String(a));CBc.lastIndex=0;return CBc.test(a)?a.replace(CBc,BBc):a}
function HBc(a){return V("<li class='nfd-format-pill'><div class='nfd-format-display'>"+U(a.dgb)+"</div><div class='nfd-format-sample'>"+U(a.KRb)+"</div></li>")};function IBc(a,b,c){R.call(this);this.Ee(a);this.D=b;this.C=c}w(IBc,R);p=IBc.prototype;p.Ga=function(){var a=this.hb(),b=this.C?Haa(bO(a),30):bO(a),a=this.C?GSb(a,this.D):"";this.La=T(HBc,{dgb:b,KRb:a})};p.Sa=function(){IBc.$.Sa.call(this);am(this.getElement(),!0);var a=new zq(this.getElement());F(this,a);this.getHandler().R(a,"key",this.g1b).R(this.getElement(),"mousedown",this.f1b).R(this.getElement(),"dblclick",this.Gqb)};
p.g1b=function(a){function b(a,b){for(;b=a(b);)if(Ip(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(Ul,this.getElement());break;case 38:b(dqa,this.getElement())}};p.f1b=function(a){a.preventDefault();this.dispatchEvent("change")};p.Gqb=function(){this.dispatchEvent("action")};function JBc(a,b,c){R.call(this);this.D=b;this.C=c;KBc(this,a)}w(JBc,R);JBc.prototype.Ga=function(){this.La=this.Ba().Ga("UL","nfd-pill-container")};function KBc(a,b){y(b,function(b){a.Wa(new IBc(b,a.D,a.C),!0)})}JBc.prototype.filter=function(a){a=a.toLowerCase();this.Jf(function(b){var c=Va(ib(a)),d=bO(b.hb()).toLowerCase(),c=c||bb(d,a);Q(b.getElement(),c)})};function nY(a){hq.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Lja();this.Wa(this.input,!0);this.J=new R;this.Wa(this.J,!0);a=this.m$();Qb(a,void 0,EBc);this.C=new JBc(a,this.r0(),this.KVa());this.J.Wa(this.C,!0);tq(this,null);this.Dj=!0}w(nY,hq);p=nY.prototype;p.rYa=Tf;p.KVa=Sf;p.isEmpty=function(){return Va(this.input.Za())};p.Hf=function(){return this.input.hb().Hf()};p.Ga=function(){nY.$.Ga.call(this);var a=Il("DIV","dialog-separator");Pl(a,lq(this))};
p.Sa=function(){nY.$.Sa.call(this);fp(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.Vsb).R(this.C,"action",this.kwa).R(this.input.O,"action",this.kwa).R(this.input,"afterhide",this.plb);this.input.V&&this.getHandler().R(this.input.V,"input",this.Z0b);var a=this.input.Ca;a&&this.getHandler().R(a,"key",this.$0b);a=this.m$()[0];this.input.kO(a)};p.plb=function(a){a.stopPropagation()};p.Vsb=function(a){this.input.kO(a.target.hb());LBc(this.input,!1)};
p.Z0b=function(){this.C.filter(this.input.Za());LBc(this.input,!this.input.hb().Hf())};p.$0b=function(a){13==a.keyCode&&this.kwa()};p.kwa=function(){this.Hf()&&!this.isEmpty()?(X.U4.Ec(new WN(this.K4(),void 0,this.rYa())),this.setVisible(!1)):(LBc(this.input,!0),this.input.SHa())};function oY(a,b,c,d,e){Tq.call(this,b,c,d,e);this.C=a}w(oY,Tq);oY.prototype.An=function(){var a=oY.$.An.call(this),b=this.getParent();return b&&b instanceof zs&&!b.kb()?this.C(a,this.hb()):a};function pY(a){R.call(this);this.J=new R;F(this,this.J);this.D=new JO("");F(this,this.D);this.O=new ts("");F(this,this.O);this.Z=a;this.Ca=null}w(pY,R);p=pY.prototype;
p.Sa=function(){pY.$.Sa.call(this);var a=cq(this,"nfd-icwr");this.J.mb(a);this.Wa(this.J);if(a=cq(this,"nfd-i"))this.D.mb(a),this.D.ud(this.J),hp(this.D.getElement(),"jfk-textinput"),a=new cr,a.mb(this.D.getElement()),F(this,a),this.V=a=new br(this.D.getElement()),F(this,a),this.Ca=a=new zq(this.D.getElement()),F(this,a),a=new mp(this.D.getElement()),this.getHandler().R(a,"focusout",Ha(this.pYa,!1)).R(a,"focusin",Ha(this.pYa,!0)).R(this.V,"input",this.Y0b);a=cq(this,"nfd-a");this.O.mb(a);this.Wa(this.O)};
p.Za=function(){return this.D.Za()};p.Y0b=function(){var a=this.hb(),b=this.Za();C(a.XH,2,b);this.qYa()};p.qYa=Tf;p.pYa=function(a){jp(this.J.getElement(),"nfd-input-focus",a)};p.kO=function(a){this.Ee(a.clone());this.D.gb(bO(a));try{this.D.getElement().focus()}catch(b){}};p.SHa=function(){this.D.getElement().focus()};function LBc(a,b){a=a.J.getElement();jp(a,"nfd-invalid",b)};function MBc(a){var b;a=a||{};return V('<input class="jfk-textinput'+(a.Ce?" "+W(a.Ce):"")+'"'+(a.id?'id="'+W(a.id)+'"':"")+(a.maxLength?'maxlength="'+W(a.maxLength)+'"':"")+(a.Xca&&a.VWb?'label="'+W(a.Xca)+'"':"")+(a.name?'name="'+W(a.name)+'"':"")+(a.Xca?'placeholder="'+W(a.Xca)+'"':"")+'type="'+W(null==(b=a.type)?"text":b)+'"'+(a.pattern?'pattern="'+W(a.pattern)+'"':"")+(a.value?'value="'+W(a.value)+'"':"")+(a.dir?'dir="'+W(a.dir)+'"':"")+(a.attributes?" "+zr(a.attributes):"")+">")};function NBc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.O1)+"'>"+OBc(a)+"</div>"+PBc(a)+"</div>")}function QBc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.O1)+"'></div>"+PBc(a)+"</div>")}
function RBc(a){return V("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+W(a.O1)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+OBc(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+W(a.WHb)+"'></div></div></div></div>"+PBc(a)+"</div>")}
function SBc(){var a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+TBc({label:""})+TBc({label:vr("Negative:")})+TBc({label:vr("Zero:")})+TBc({label:vr("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return V(a)}function TBc(a){return V("<tr><td class='nfd-sample-label'>"+U(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function PBc(a){a=""+U(ss({id:a.Sia,style:2,Ce:"nfd-apply",content:ur("Apply")}));return V(a)}function OBc(a){return V(U(MBc({id:a.lPa,Xca:a.mPa,VWb:!0})))};function UBc(a){pY.call(this,a);this.F=new R;this.C=new NH("")}w(UBc,pY);p=UBc.prototype;p.Ga=function(){this.La=T(RBc,{O1:aq(this,"nfd-icwr"),lPa:aq(this,"nfd-i"),mPa:this.Z,WHb:aq(this,"nfd-ic"),Sia:aq(this,"nfd-a")})};p.Sa=function(){UBc.$.Sa.call(this);var a=cq(this,"nfd-ic");this.F.mb(a);this.F.ud(this.J);this.F.Wa(this.C,!0);this.getHandler().R(this.C,"aftershow",this.a1b).R(this.C,"action",this.sMa).R(this.V,"input",Ha(this.yXa,null))};
p.kO=function(a){UBc.$.kO.call(this,a);a.C&&this.D.gb(Hn[a.C][1]);this.yXa(a)};
p.yXa=function(a){a=a?a.C:void 0;var b=this.C;b.ag(null);if(a){var c=this.hb(),d=c.C;VBc(this,c);c=Lac(d,Hn[d][2]);c=new WN(WBc(c),uR[d],d);VBc(this,c);c=Lac(d,d+" "+Hn[d][1]);d=new WN(WBc(c),uR[d],d);VBc(this,d)}else this.hb().C=null;var e="[$"+this.Za()+"]",d=a?uR[a]:null,c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new WN(WBc(c[e]),d,a);VBc(this,f)}b.Vf(0);this.sMa();fp(b.Hc().getElement(),"number-format-menu")};function VBc(a,b){var c=new oY(function(a){return Haa(a,25)},GSb(b,1E3),b);F(a,c);F(a,b);c.Rq(!0);a=a.C;for(b=0;b<a.Lk();b++)if(a.Bf(b).An()==c.An())return;a.re(c)}p.sMa=function(){for(var a=this.C,b=0;b<a.Lk();b++)a.Bf(b).tc(!1);jt(a)};p.a1b=function(){this.C.Cf().tc(!0)};function WBc(a){var b=new ld;C(b,2,a);b.setType(4);return b};function XBc(a){nY.call(this,a);iq(this,"Custom currencies")}w(XBc,nY);p=XBc.prototype;p.r0=n(1000.12);p.Lja=function(){return new UBc("Custom currency")};p.m$=function(){var a=this;YVb();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=uR[e]:vBc(d,Nac(d.Hl()))}var f=[];$b(Hn,function(b,c){b=Mac(c);F(a,b);f.push(b)});var h=Smc();Tb(f,function(a,b){return h(bO(a),bO(b))});return b.concat(f)};p.K4=function(){var a=new ld;a.setType(4);C(a,3,1);var b=this.input.C.Cf().Za().Hl();C(a,2,b);return a};
p.rYa=function(){return this.input.hb().C};function YBc(a){R.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}w(YBc,R);YBc.prototype.Ga=function(){var a=T(SBc);this.F=Dl("nfd-sample-label",a);this.D=Upa("nfd-rendered-sample",a);this.La=a};function qY(a,b){pY.call(this,a);this.C=new YBc(b);this.Ee(new WN(""))}w(qY,pY);qY.prototype.Ga=function(){this.La=T(NBc,{lPa:aq(this,"nfd-i"),mPa:this.Z,O1:aq(this,"nfd-icwr"),Sia:aq(this,"nfd-a")})};qY.prototype.Sa=function(){qY.$.Sa.call(this);this.Wa(this.C,!0);ZBc(this)};qY.prototype.qYa=function(){ZBc(this)};qY.prototype.kO=function(a){qY.$.kO.call(this,a);ZBc(this)};
function ZBc(a){var b=a.hb();if(b){var c=a.C;a=b.Hl().split(";").length-1;Zl(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=GSb(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Hl()),k=d<=a;Q(Wl(e),k);Zl(e,f);np(e,"color",h||"")}d=b.Hf()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Hl()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Hl());c=c.D[3];Q(Wl(c),3<=a);Zl(c,d);np(c,"color",b||"")}};function rY(a){nY.call(this,a);iq(this,"Custom number formats")}w(rY,nY);rY.prototype.r0=n(1234.56);rY.prototype.Lja=function(){return new qY("Custom number format",1234.56)};
rY.prototype.m$=function(){var a=this.F;a.push(new WN("0"));a.push(new WN("0.00"));a.push(new WN("#,##0"));a.push(new WN("#,##0.00"));a.push(new WN("#,##0_);(#,##0)"));a.push(new WN("#,##0_);[Red](#,##0)"));a.push(new WN("#,##0.00_);(#,##0.00)"));a.push(new WN("#,##0.00_);[Red](#,##0.00)"));a.push(new WN("$#,##0_);($#,##0)"));a.push(new WN("$#,##0_);[Red]($#,##0)"));a.push(new WN("$#,##0.00_);($#,##0.00)"));a.push(new WN("$#,##0.00_);[Red]($#,##0.00)"));a.push(new WN("@"));a.push(new WN("0%"));a.push(new WN("0.00%"));
a.push(new WN("0.00E+00"));a.push(new WN("##0.0E+0"));a.push(new WN("# ?/?"));a.push(new WN("# ??/??"));a.push(new WN('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new WN('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new WN('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new WN('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};rY.prototype.K4=function(){var a=new ld;a.setType(2);C(a,3,1);var b=this.input.Za();C(a,2,b);return a};function sY(a,b){Ms.call(this,b,new $Bc(a))}w(sY,Ms);p=sY.prototype;p.Zh=function(a,b,c){sY.$.Zh.call(this,a,b,c);a.wc()&&this.wc()&&a.getParent()==this&&aCc(this)};p.Sa=function(){sY.$.Sa.call(this);aCc(this)};p.ge=function(a){sY.$.ge.call(this,a);aCc(this)};p.removeChild=function(a,b){a=sY.$.removeChild.call(this,a,b);aCc(this);return a};p.Fn=function(a,b){a=sY.$.Fn.call(this,a,b);aCc(this);return a};
p.ek=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=Cs(this);if(c){b=39==b;this.Pf()&&(b=!b);var c=c.getElement(),c=rb(c.parentNode.childNodes,c);var d=(d=(d=Cs(this))?sqa(d.getElement(),bCc):null)?rb(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=cCc(this,e);b?b=cCc(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.Pda(this.fk+b);b=!0}else b=!1}b=!b}return b?sY.$.ek.call(this,a):!0};
p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function cCc(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function aCc(a){for(var b=a.we(),c=a.kd(),d=Nb(Cl("div",bCc,a.getElement())),e=a.getElement(),f=d.length;f<b.D&&f<c;f++)d[f]=a.Ba().Ga("DIV",bCc),e.appendChild(d[f]);for(var e=d.length,b=Array(e),c=[],f=0,h=!1,k=0;k<a.kd();k++)a.qd(k)instanceof Ls?(c.push(new dCc(f,k,!0)),f=k+1):a.qd(k)instanceof Hs&&(0==k?h=!0:(a.qd(k-1),c.push(new dCc(f,k-1,!1)),f=k));k=a.kd();0<c.length&&qb(c).end!=k-1&&c.push(new dCc(f,k-1,!1));f=h;h=a.kd();if(0==c.length&&f)b[0]=h;else{f=c.length-Math.max(0,c.length-e);f=a.kd()-
f;f=Math.ceil(f/e);if(0==c.length)for(h=0;h<e;h++)b[h]=(h+1)*f-1;else eCc(c,f,e);e=c.length;for(f=0;f<e;f++)b[f]=c[f].end}for(e=c=0;e<a.kd();e++){for(;e>b[c];)++c;f=a.qd(e);h=f.getElement();h.parentNode!=d[c]&&d[c].appendChild(h);e==b[c]&&f instanceof Ls?Q(h,!1):Q(h,!0)}for(a=d.length-1;a>c;--a)d[a].parentNode.removeChild(d[a]),d[a]=null}
function eCc(a,b,c){function d(a){return a.end-a.start-(a.JGb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;Ib(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,Ib(a,l,1))}}function dCc(a,b,c){this.start=a;this.end=b;this.JGb=c}function $Bc(a){Ks.call(this);this.D=a}w($Bc,Ks);var bCc="docs-multi-menu-col";function fCc(a){this.C=a}w(fCc,E);fCc.prototype.create=function(){return new sY(this.C)};function gCc(a,b){pY.call(this,a);this.qa=new R;this.H=new tY;this.F=new R;a=(new fCc(3)).create();a.Wa(new Hs("Date"),!0);a.Wa(new Tq("Day","DAY_TOKEN"),!0);a.Wa(new Tq("Month","MONTH_TOKEN"),!0);a.Wa(new Tq("Year","YEAR_TOKEN"),!0);a.Wa(new Hs("Time:"),!0);a.Wa(new Tq("Hours","HOURS_TOKEN"),!0);a.Wa(new Tq("Minutes","MINUTES_TOKEN"),!0);a.Wa(new Tq("Seconds","SECONDS_TOKEN"),!0);a.Wa(new Tq("Milliseconds","MILLIS_TOKEN"),!0);a.Wa(new Tq("a.m./p.m.","AM_PM_TOKEN"),!0);a.Wa(new Hs("Duration"),!0);
a.Wa(new Tq("Elapsed hours","ELAPSED_HOURS_TOKEN"),!0);a.Wa(new Tq("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Wa(new Tq("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new $ib(a);this.C=b}w(gCc,pY);p=gCc.prototype;p.Ga=function(){this.La=T(QBc,{O1:aq(this,"nfd-icwr"),Sia:aq(this,"nfd-a")})};
p.Sa=function(){gCc.$.Sa.call(this);fp(this.getElement(),"nfd-date-time-input");var a=cq(this,"nfd-icwr"),b=this.qa;b.mb(a);b.ud(this);b.Wa(this.L,!0);fp(this.L.getElement(),"nfd-date-time-menu-button");fp(this.L.Hc().getElement(),"nfd-date-time-menu");cp(this.L.La,"Add a date or time format");b.Wa(this.H,!0);Qc||fp(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Wa(a,!0);np(a.getElement(),"display","inline");this.getHandler().R(this,"Be",Ha(this.sYa,"left")).R(this,"Fe",Ha(this.oNa,"left")).R(this,
"Ge",Ha(this.oNa,"right")).R(this,"He",Ha(this.UNa,"left")).R(this,"Ie",Ha(this.UNa,"right")).R(this,"Ee",Ha(this.sYa,"right")).R(this.L,"action",this.xpb)};p.SHa=function(){this.qa.getElement().focus()};
p.kO=function(a){this.Ee(a.clone());var b=this.F;b.Gd(!0);Zl(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Hl());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?Zl(this.H.getElement(),d[2]):(e=b.qd(b.kd()-1),d=d[2],Zl(e.nA.getElement(),cm(e.nA.getElement())+d)):hCc(this,e).gb(d[1])}0<b.kd()&&b.qd(b.kd()-1).zy.getElement().focus()};
p.Za=function(){for(var a=this.H.toString(),b=0;b<this.F.kd();b++)a+=this.F.qd(b).toString();for(var a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a),b="",c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=db(e,"["),e=db(e,"]")):c=!0}b+=e}return b};p.xpb=function(a){a=a.target.Za();hCc(this,a).zy.getElement().focus()};
function hCc(a,b){LBc(a,!1);switch(b){case "DAY_TOKEN":var c=iCc(a);break;case "MONTH_TOKEN":c=jCc(a);break;case "YEAR_TOKEN":c=kCc(a);break;case "HOURS_TOKEN":c=lCc();break;case "MINUTES_TOKEN":c=mCc();break;case "SECONDS_TOKEN":c=nCc();break;case "MILLIS_TOKEN":c=oCc();break;case "AM_PM_TOKEN":c=pCc(a);break;case "ELAPSED_HOURS_TOKEN":c=qCc();break;case "ELAPSED_MINUTES_TOKEN":c=rCc();break;case "ELAPSED_SECONDS_TOKEN":c=sCc()}b=c;b.Wa(new Ls,!0);b.Wa(new Tq("Delete"),!0);c=new tCc(c,"");a.F.Wa(c,
!0);return c}p.sYa=function(a,b){b=b.target;if(b instanceof tY){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.qd(dq(this.F,b)+1),!b))return}a=cm(b.nA.getElement());var c=b.getParent(),d=dq(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=cm(b),Zl(b,c+a),uCc(this.H,c.length)):(d--,b=c.qd(d),c=cm(b.nA.getElement()),Zl(b.nA.getElement(),cm(b.nA.getElement())+a),uCc(b.nA,c.length))};
p.UNa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.qd(dq(this.F,b)+a))&&a.zy.getElement().focus()};p.oNa=function(a,b){var c="left"==a?-1:0;(b=this.F.qd(dq(this.F,b.target)+c))||"left"!=a?b&&(b=b.nA):b=this.H;c=cm(b.getElement()).length;uCc(b,"left"==a?c:0)};function tCc(a,b){R.call(this);this.zy=new NH("",a);this.Wa(this.zy,!0);this.nA=new tY(b);this.Wa(this.nA,!0)}w(tCc,R);p=tCc.prototype;
p.Sa=function(){tCc.$.Sa.call(this);np(this.getElement(),"display","inline-block");this.zy.Vf(0);this.C=new zq(this.zy.getElement());F(this,this.C);this.getHandler().R(this.zy,"action",this.b1b).R(this.C,"key",this.c1b)};p.b1b=function(){jt(this.zy);this.zy.Cf().hb()||this.dispatchEvent("Ee")};p.c1b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("Ee"));break;case 37:a.preventDefault();this.dispatchEvent("Fe");break;case 39:a.preventDefault(),this.dispatchEvent("Ge")}};
p.toString=function(){return this.zy.Cf().hb()+this.nA.toString()};p.gb=function(a){this.zy.gb(a)};function tY(a){R.call(this);this.C=a||""}w(tY,R);p=tY.prototype;p.Ga=function(){var a=Il("SPAN");El(a,{contentEditable:!0});Zl(a,this.C);var b=a.style;Nc&&!Wc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Qc?"-moz-pre-wrap":"pre-wrap";this.La=a};
p.Sa=function(){tY.$.Sa.call(this);var a=new zq(this.getElement());F(this,a);this.getHandler().R(a,"key",this.d1b).R(this.getElement(),"paste",this.e1b)};function uCc(a,b){if(0==cm(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=mw(c,b);a.getElement().focus();b.select()}}
p.d1b=function(a){var b=bm(this.getElement()),c=cw(),d=cm(this.getElement()).length,e=c?0==c.ji()&&0==c.Wn():Va(ib(b)),b=c?c.ji()==d&&c.Wn()==d:Va(ib(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("Be"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("Ee"));break;case 40:this.dispatchEvent("Ce");break;case 38:this.dispatchEvent("De");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("He"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("Ie"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=qaa(cm(this.getElement())).replace(/"/g,'"\\""');return 0==ib(a).length?"":'"'+a+'"'};p.e1b=function(){var a=u(function(){Zl(this.getElement(),cm(this.getElement()))},this);Gi(a)};
function iCc(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new oY(Ha(b,e),a,d));d=new Ms;for(e=0;e<c.length;e++)d.Wa(c[e],!0);return d}
function jCc(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new oY(Ha(b,e),a,d));d=new Ms;for(e=0;e<c.length;e++)d.Wa(c[e],!0);return d}
function kCc(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two-digit year ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new oY(Ha(b,e),a,d));d=new Ms;for(e=0;e<c.length;e++)d.Wa(c[e],!0);return d}
function lCc(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c}
function mCc(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c}
function nCc(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c}
function oCc(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c}
function pCc(a){function b(a){return"a.m./p.m. ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new oY(Ha(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new oY(Ha(b,e),a,d));d=new Ms;for(e=0;e<c.length;e++)d.Wa(c[e],!0);return d}
function qCc(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c}
function rCc(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c}
function sCc(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new oY(Ha(a,d),e,c));c=new Ms;for(d=0;d<b.length;d++)c.Wa(b[d],!0);return c};function vCc(a){nY.call(this,a);iq(this,"Custom date and time formats")}w(vCc,nY);p=vCc.prototype;p.KVa=Rf;p.r0=n(11175.5628472222);p.isEmpty=function(){return Va(Fc(this.K4(),2))};p.Hf=function(){return ritz_api.RitzModelApi.isValidFormatPattern(Fc(this.K4(),2))};p.Lja=function(){return new gCc("Custom date time format",11175.5628472222)};p.K4=function(){return wCc(this.input.Za())};
p.m$=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.r0(),c.Hl());c.D=d}b=xCc(this);Qb(b);for(c=0;c<b.length;c++)a.push(new WN(wCc(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.r0(),b[c])));return a};
function xCc(a){var b=tu,c=vb(b.DATEFORMATS,function(a){return yCc(a)},a),d=vb(b.TIMEFORMATS,function(a){return yCc(a)},a),e=c.concat(d),b=b.DATETIMEFORMATS;Qb(b);a=vb(b,function(a){return yCc(a)},a);for(b=0;b<a.length;b++){var f=a[b],f=f.replace(/\{1\}/,c[0]),f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function yCc(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Xa(a.join(""))}function wCc(a){var b=new ld;b.setType(7);C(b,3,1);C(b,2,a);return b};function zCc(a,b){this.D=a;this.C=b}zCc.prototype.getUrl=g("D");function ACc(){};function BCc(a){for(var b="",c=a.OUa,d=c.length,e=0;e<d;e++){var f=c[e],h=a.eTb[f.oi()];f.getName();var k=f.getLabel(),f=f.DHb,f=V('<div id="'+W(h)+'" tabindex="0" role="link" class="ess-button" aria-label="'+W(k)+'"><div class="ess-icon '+W(f)+'"></div></div>'),b=b+f}return V(b)};function CCc(a,b){R.call(this,b);this.C=a||[];this.F=[];this.D=null}w(CCc,R);p=CCc.prototype;p.Aia=!0;p.Yha=!1;p.RR=null;p.mGa=!1;p.eb=function(a,b){this.Aia=a;this.Yha=b;if(this.mGa){b=this.Ba();for(var c=0,d;d=this.C[c];c++){var e=b.getElement(this.RR.Jta+"-"+d.oi()),f=a;jp(e,"ess-button",f);jp(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();rs(e,f,d)}}};
p.Ga=function(){this.La=this.ob.createElement("SPAN");var a={};a.Jta=aq(this,"service");a.OUa=this.C;this.RR=a;for(var b={},c=0,d;d=this.C[c];c++)b[d.oi()]=this.RR.Jta+"-"+d.oi();a.eTb=b;this.RR=a;gr(this.getElement(),BCc,this.RR);this.mGa=!0};
p.WQb=function(a){if(this.Aia)if(this.D&&this.D.OY(9),this.Yha)this.dispatchEvent(new DCc(new ECc));else{var b=this.D||void 0;a=a.getUrl(this.F);b&&b.OY(10);b={$Cc:!0};b.target=b.target||a.target||"google_popup";b.width=b.width||690;b.height=b.height||500;(b=Po(a,b))&&b.focus()}};p.Sa=function(){this.eb(this.Aia,this.Yha);for(var a=this.Ba(),b=this.getHandler(),c=0,d;d=this.C[c];c++){var e=a.getElement(this.RR.Jta+"-"+d.oi());Pf(b,e,gd,u(this.WQb,this,d))}};
p.Ja=function(){CCc.$.Ja.call(this);delete this.F;delete this.C;this.D=null};function DCc(a,b){H.call(this,"Je",b);this.context=a}w(DCc,H);function ECc(){}w(ECc,ACc);function uY(a,b,c,d){this.D=b;this.C=c;this.DHb=d;this.F=FCc++}var FCc=0;uY.prototype.oi=g("F");uY.prototype.getName=g("D");uY.prototype.getLabel=g("C");function GCc(){uY.call(this,0,"Facebook","Share via Facebook","ess-facebook-icon")}w(GCc,uY);GCc.prototype.getUrl=function(a){var b=vb(a,function(a){return a.C});a=vb(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Ya(a.join(","))+"&t="+Ya(b.join(","))};function HCc(){uY.call(this,0,"Gmail","Share via Gmail","ess-gmail-icon")}w(HCc,uY);HCc.prototype.getUrl=function(a){a=vb(a,function(a){return a.C+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Ya(a.join("\n"))};function ICc(){uY.call(this,0,"Google+","Share via Google+","ess-gplus-icon")}w(ICc,uY);ICc.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Ya(a[0].getUrl())};function JCc(){uY.call(this,0,"Twitter","Share via Twitter","ess-twitter-icon")}w(JCc,uY);JCc.prototype.getUrl=function(a){for(var b=Ea(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){var f=a[e].C,h=c[e]?" - ":"",k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Ya(a)};function vY(a){R.call(this,a)}w(vY,R);function KCc(a){a.dispatchEvent(new H("Ke"))}vY.prototype.u0=function(){return{}};vY.prototype.$L=Tf;vY.prototype.Dta=sa;function wY(a){R.call(this,a)}w(wY,R);wY.prototype.F=Tf;wY.prototype.H=sa;wY.prototype.J=sa;function LCc(a){var b="",c="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+GBc(a.locale)+'&answer=183965">Learn more</a>'),b=b+('<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+c+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
W(a.Bab)+'" readonly="readonly" aria-label="'+yr("Link to published document.")+" "+W(a.eTa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
yr("HTML embed code of published document.")+" "+W(a.eTa)+'">'+vAa(a.mfb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+U(ss({id:"pub-dialog-publish-link-button",style:2,value:a.VQb}))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+U(Jt({jz:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"}))+'Published content and settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
U(ss({id:"pub-dialog-publish-button",value:a.TQb}))+'<div class="pub-dialog-checkbox-container">');a.hIb&&(c="Require viewers to sign in with their "+(U(a.domain)+" account"),b+=U(Er({id:"pub-dialog-dom-signin-req",checked:a.Gt,disabled:a.hL}))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.hL?'class="pub-dialog-disabled-text"':"")+">"+c+"</label><br>");a.ZR&&(b+=U(Er({id:"pub-dialog-auto-publish-checkbox"}))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return V(b+"</div></div></div></div>")};function xY(a,b,c,d,e,f,h,k,l,m){Gr.call(this);this.Ib=a||"";this.Ag=b;this.Id=c;this.Bd=d;this.dd=l||"/publishsettings";this.C=new MCc(e);this.Qb=new CCc([new ICc,new HCc,new GCc,new JCc]);this.Wa(this.Qb);this.Ca=new ts(null,this.Ba());this.Wa(this.Ca);this.V=new ts(null,this.Ba());this.Wa(this.V);this.fb=new Fr(void 0,this.Ba());this.Wa(this.fb);this.Ia=new Fr(void 0,this.Ba());this.Wa(this.Ia);this.ib=0;this.kc=new NCc;this.Wa(this.kc);this.Mb=this.Ub=null;this.J=f||new vY;this.Wa(this.J);this.F=
h||new vY;this.Wa(this.F);this.$a=k||new wY;this.Wa(this.$a);this.O=this.L=null;this.zb=new Ct(void 0,OCc,this.Ba(),2);F(this,this.zb);this.vf=this.Zd=null;this.Fg=m||new R;this.zc=this.pb=this.Xb=null;this.Dj=!0}w(xY,Gr);var OCc="Press "+((Tc?"\u2318+C":"Ctrl+C")+" to copy.");p=xY.prototype;p.show=function(){PCc(this,u(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){xY.$.setVisible.call(this,a);var b=jm(this.Ba());a?this.getHandler().R(b,"resize",this.vd):this.getHandler().Oc(b,"resize",this.vd)};
p.Ga=function(){xY.$.Ga.call(this);var a=this.Ba(),b=T(LCc,{hIb:!!this.C.domain,ZR:this.C.ZR(),Gt:this.C.Gt,domain:this.C.C,hL:this.C.hL,TQb:QCc(this),VQb:yY(this,RCc(this))?"Published":"Publish",Bab:this.C.Uk?SCc(this,this.J.u0()):"",mfb:this.C.Uk?TCc(this,this.F.u0()):"",locale:"en-GB",eTa:OCc});a.appendChild(this.Zb(),b);iq(this,"Publish to the web");tq(this,null);fp(this.Zb(),"pub-dialog-content")};
p.Sa=function(){var a=this.Ba(),b=a.getElement("pub-dialog-sharing-services-links");this.Qb.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Xb=a.getElement("pub-dialog-links-notice");this.Fg.render(this.Xb);b=a.getElement("pub-dialog-published-content");this.$a.render(b);xY.$.Sa.call(this);var b=this.getHandler(),c=a.getElement("pub-dialog-dom-signin-req");c&&(this.fb.mb(c),pr(this.fb,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.fb,"change",this.hWb));this.C.ZR()&&(this.Ia.mb(a.getElement("pub-dialog-auto-publish-checkbox")),pr(this.Ia,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Ia,"change",this.dWb));this.Ub=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.Mb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");At(this.zb,this.L);this.kc.mb(a.getElement("pub-dialog-links-tab-bar"));this.Zd=a.getElement("pub-dialog-sharing-services");
this.vf=a.getElement("pub-dialog-status-info");this.Ca.mb(a.getElement("pub-dialog-publish-link-button"));this.V.mb(a.getElement("pub-dialog-publish-button"));this.zc=new nJ("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Uk);F(this,this.zc);b.R(this.kc,"select",this.gCb).R(this.L,"focus",this.zUa).R(this.O,"focus",this.zUa).R(this.V,"action",this.XQb).R(this.getElement(),"keyup",this.R$a).R(this.J,"Ke",this.Bva).R(this.F,"Ke",this.Bva).R(this.Ca,"action",this.fAb).R(this.$a,"Le",
this.gAb).R(this.zc,"toggle",this.vd);UCc(this)};function UCc(a){if(a.wc()){var b=a.Ba(),c=a.C.Uk,d=a.C.hL;a.$a.H(a.C.Wm);a.fb.eb(!d);a.V.setContent(QCc(a));a.V.eb(a.C.Uk||!a.C.Wm||!a.C.Wm.isEmpty());a.C.ZR()&&a.Ia.tc(a.C.ax);a.Bva();b=b.Vi("pub-dialog-state-publishing");y(b,function(a){Q(a,c)});Zl(a.vf,c?"This document is published to the web.":"This document is not published to the web.");a.vd()}}p.R$a=function(a){this.kb()&&27==a.keyCode&&a.stopPropagation()};
function VCc(a,b){var c=window.location.href,d=wj(c),c=Cj(c),e=bb(c,"/"+a.Bd+"/")?"/"+a.Bd:"";a.C.Gt&&a.C.domain&&(e="/a/"+a.C.domain+e);var c=d[1],f=d[2],h=d[3],d=d[4];a=a.C.F||a.Ib;b=Tna.test(b)?b:Mj("/d/"+a,b);return vj(c,f,h,d,Mj(e,b))}
p.Bva=function(){var a=this.J.$L();if(a=yY(this,a)){var b=this.C.Uk?SCc(this,this.J.u0()):"";this.L.value=b;this.Qb.F=[new zCc(b,this.Ag)]}Q(this.L,a);Q(this.Zd,a&&!this.C.hL);a=this.F.$L();if(a=yY(this,a))this.O.value=this.C.Uk?TCc(this,this.F.u0()):"";Q(this.O,a);a=yY(this,RCc(this));Q(this.Xb,a);this.Ca.eb(!a);this.Ca.setContent(yY(this,RCc(this))?"Published":"Publish")};
p.gCb=function(a){a=a.target;this.Ba();Bt(this.zb);"pub-dialog-link-tab"==a.getId()?(this.ib=0,Q(this.Ub,!0),Q(this.Mb,!1),At(this.zb,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.ib=1,Q(this.Ub,!1),Q(this.Mb,!0),At(this.zb,this.O));UCc(this)};p.zUa=function(a){Gi(function(){a.target.select()},0)};p.hWb=function(){this.C.Uk?WCc(this,2,!1):this.C.Gt=!this.C.Gt};p.dWb=function(){this.C.Uk?WCc(this,0,!1):this.C.ax=!this.C.ax};function QCc(a){return a.C.Uk?"Stop publishing":"Start publishing"}
function PCc(a,b){Qj(a.Id.Qf(a.dd).Wf("id",a.Ib),u(function(a){this.C.Uk=!!zk(a,"published");this.C.Gt=!!zk(a,"requireSignin");this.C.hL=!!zk(a,"domainClosed");this.C.domain=xBc(a,"domain");this.C.C=xBc(a,"domainDisplay");var c=this.C;var e=Number(zk(a,"revision"));c.ax=!e;this.C.Wm=this.qJa(a.og());this.C.F=xBc(a,"publishedDocumentId");b()},a)).$e()}p.qJa=Tf;p.$Ia=Tf;function XCc(a){return{ax:a.C.ax,Uk:a.C.Uk,Gt:a.C.Gt,Wm:a.C.Wm}}
function WCc(a,b,c){c=t(c)?c:!0;var d=XCc(a);switch(b){case 0:d.ax=!d.ax;break;case 1:d.Uk=!d.Uk;break;case 2:d.Gt=!d.Gt;break;default:throw Error("Unknown toggle op: "+b);}d.Uk||(d.Wm=a.$Ia());YCc(a,d,c)}
function YCc(a,b,c){ZCc(a,!1);Pj(Qj(Nj(Rj(a.Id.Qf(a.dd).Wf("id",a.Ib),$Cc(a,b)),2),u(function(){this.C.ax=b.ax;this.C.Uk=b.Uk;this.C.Gt=b.Gt;this.C.Wm=b.Wm;this.C.Uk&&this.C.Wm&&(yY(this,this.J.$L())||this.J.Dta(this.C.Wm),yY(this,this.F.$L())||this.F.Dta(this.C.Wm));ZCc(this,!0);UCc(this);if(c&&this.C.Uk)switch(this.ib){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.ib);}},a)),u(function(){Shc("An error occurred whilst saving publishing settings.",
void 0,this.wc()?this:void 0);ZCc(this,!0);UCc(this)},a)).$e()}function $Cc(a,b){var c={id:a.Ib,requireSignin:b.Gt,published:b.Uk};a.C.ZR()&&!b.ax&&(c.revision=a.C.D);b.Wm&&(a=aDc(b.Wm),uc(c,a));return c}function ZCc(a,b){for(var c=[a.Ia,a.V,a.Ca,a.fb],d=0;d<c.length;d++){var e=c[d];!b&&e.bq()&&(a.pb=e);e.eb(b)}b&&a.pb&&(a.kb()&&a.pb.kb()&&(c=a.pb.getElement())&&c.focus(),a.pb=null);a.$a.J(b)}
p.XQb=function(a,b){if(b||window.confirm(this.C.Uk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.V.setContent("Saving..."),WCc(this,1)};function RCc(a){switch(a.ib){case 0:return a.J.$L();case 1:return a.F.$L();default:throw Error("Cannot handle selected link type "+a.ib);}}
p.fAb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=RCc(this),b=XCc(this);b.Uk=!0;a&&(b.Wm&&this.C.Uk?b.Wm=bDc(b.Wm,a):b.Wm=a);this.Ca.setContent("Publishing...");YCc(this,b,!0)}};p.gAb=function(){var a=this.$a.F();if(this.C.Uk)if(a&&a.isEmpty())WCc(this,1);else{var b=XCc(this);b.Wm=a;YCc(this,b)}else this.C.Wm=a,UCc(this)};function yY(a,b){var c;(c=a.C.Uk)&&!(c=!b||!a.C.Wm)&&(a=a.C.Wm,c=a.F||!b.F&&yb(b.D.jd(),a.Lba,a)&&yb(b.C,a.zba,a));return c}
function MCc(a){this.D=a;this.hL=this.Gt=this.Uk=!1;this.ax=!0;this.F=this.C=this.domain=""}MCc.prototype.ZR=function(){return!!this.D};function NCc(){DT.call(this)}w(NCc,DT);NCc.prototype.ek=function(a){return a.keyCode&&27==a.keyCode?!1:NCc.$.ek.call(this,a)};function cDc(a,b,c,d){this.F=a;this.Ki=b;this.C=c;this.D=d}function dDc(a,b){return new cDc(!1,null,new eDc(a,b||"interactive"),null)}function eDc(a,b){this.id=a;this.format=b};function zY(a,b,c){this.F=a;this.D=new og(b);this.C=c}p=zY.prototype;p.Lba=function(a){return this.F||this.D.contains(a)};function fDc(a,b){return xb(a.C,function(a){return a.id==b.id})}p.zba=function(a){return this.F||this.D.contains(a.Ki)||fDc(this,a)};function gDc(a,b){a.C=ub(a.C,function(a){return a.Ki!=b})}function hDc(a,b){fDc(a,b)&&(a.C=ub(a.C,function(a){return a.id!=b.id}))}
function bDc(a,b){var c=a.F||b.F;if(c)return new zY(c,[],[]);var d=a.clone();y(b.D.jd(),function(a){d.D.contains(a)||(d.D.add(a),gDc(d,a))});y(b.C,function(a){d.zba(a)||d.C.push(a)});return d}function aDc(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.jd().join(","),charts:vb(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&Eb(this.C)};p.clone=function(){return new zY(this.F,this.D.jd(),Nb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&Vb(this.C,a.C,function(a,c){return a.id==c.id&&a.Ki==c.Ki})};function iDc(a,b){this.id=a;this.Ki=b};function jDc(a,b,c,d){R.call(this,void 0);this.C=c||new cDc(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new NH("",kDc(a,b));dO(this.D,!0);this.Wa(this.D,!0);a=new Ms;a.Wa(new Tq("Interactive","interactive"),!0);a.Wa(new Tq("Image","image"),!0);this.H=new NH("",a);this.Wa(this.H,!0);a=new Ms;a.Wa(new Tq("Web page","html"),!0);a.Wa(new Tq("Comma-separated values (.csv)","csv"),!0);a.Wa(new Tq("Tab-separated values (.tsv)","tsv"),!0);a.Wa(new Tq("PDF document (.pdf)","pdf"),!0);a.Wa(new Tq("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Wa(new Tq("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new NH("",a);this.Wa(this.F,!0);lDc(this)}w(jDc,vY);var mDc=["xlsx","ods"],nDc=["csv","tsv"];
function kDc(a,b){var c=new Ms;c.Wa(new Tq("Entire Document",new oDc("entireDocument",null)),!0);c.Wa(new Ls,!0);var d=MZa(b);y(a.D,function(a){c.Wa(new Tq(a.C,new oDc("sheet",a.Jb())),!0);if(a=d[a.Jb()])for(var b=0;b<a.length;b++){var e=a[b];6==e.getType()&&e.isSaved()&&(e=new Tq(wBc(e),new oDc("chart",EB(e))),c.Wa(e,!0),fp(e.Zb(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=jDc.prototype;
p.Sa=function(){jDc.$.Sa.call(this);fp(this.getElement(),"pub-dialog-link-options-container");fp(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");fp(this.D.Zb(),"pub-dialog-link-options-document-part-menu-button-content");fp(this.D.Hc().getElement(),"pub-dialog-link-options-document-part-menu");cp(this.D.La,"Sheet or chart selection");cp(this.H.La,"Chart format");cp(this.F.La,"Sheet format");this.getHandler().R(this.D,"change",this.zqb).R(this.H,"change",this.rnb).R(this.F,
"change",this.MCb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};p.zqb=function(){var a=this.D.Cf().hb();switch(a.type){case "entireDocument":this.C=new cDc(!0,null,null,this.C.D||"html");break;case "sheet":var a=a.id,b=this.C.D;b&&!pDc(this,a,b)&&(b=null);this.C=new cDc(!1,a,null,b||"html");break;case "chart":this.C=dDc(a.id,this.C.C?this.C.C.format:null)}lDc(this);KCc(this)};
p.rnb=function(){var a=this.H.Cf().hb();this.C.C&&(this.C.C.format=a,KCc(this))};p.MCb=function(){var a=this.F.Cf().hb();this.C.D=a;KCc(this)};
function lDc(a){var b=Nb(a.D.Xj.C),b=zb(b,function(a){a=a.hb();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.Ki&&a.id==this.C.Ki;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);kt(a.D,b);b=!!a.C.C;Q(a.H.getElement(),b);null!=a.C.C&&a.H.gb(a.C.C.format);Q(a.F.getElement(),a.J&&xra&&!b);b||(qDc(a),a.F.gb(a.C.D))}
function qDc(a){for(var b=a.F.Hc(),c=0;c<b.Lk();c++){var d=b.Bf(c),e=d.Za();d.eb(null==a.C.Ki||pDc(a,a.C.Ki,e))}}function pDc(a,b,c){if(Db(mDc,c))return!1;a=bv(a.O,b);return null!=a&&1==a.getSheetType()&&Db(nDc,c)?!1:!0}p.u0=g("C");p.$L=function(){if(this.C.F)return new zY(!0,[],[]);if(null!=this.C.Ki)return new zY(!1,[this.C.Ki],[]);var a=this.L.C(this.C.C.id),a=new iDc(this.C.C.id,a.Jb());return new zY(!1,[],[a])};
p.Dta=function(a){if(!a.F){var b=a.D.jd();0<b.length?this.C=new cDc(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=dDc(a[0].id)));lDc(this)}};function oDc(a,b){this.type=a;this.id=b};function AY(a,b){Qs.call(this,void 0,void 0,new MH,void 0);this.Xa=a;this.Pa=b;this.H=new zY(!0,[],[]);this.V=!1;this.J=new lJ("Entire Document");this.re(this.J);this.re(new Ls);rDc(this);dO(this,!0);sDc(this)}w(AY,Qs);function rDc(a){var b=MZa(a.Pa);y(a.Xa.D,function(c){var d=new lJ(c.C,c);a.re(d);(c=b[c.Jb()])&&y(c,function(b){6==b.getType()&&b.isSaved()&&(b=new lJ(wBc(b),b),a.re(b),fp(b.Zb(),"pub-dialog-published-content-chart-menu-item"))})})}
AY.prototype.Sa=function(){AY.$.Sa.call(this);fp(this.getElement(),"pub-dialog-published-content-menu-button");fp(this.Zb(),"pub-dialog-published-content-menu-button-content");fp(this.Hc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
AY.prototype.nt=function(a){if(a.target==this.J){a=this.J.isChecked();var b=this.H;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.hb(),b instanceof Iu?(b=b.Jb(),a?(a=this.H,a.D.contains(b)||(a.D.add(b),gDc(a,b))):(a=this.H,a.D.contains(b)&&(a.D.remove(b),gDc(a,b)))):(b=new iDc(EB(b),b.Jb()),a?(a=this.H,a.zba(b)||a.C.push(b)):hDc(this.H,b));this.V=!0;sDc(this)};AY.prototype.xe=function(a,b){AY.$.xe.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new H("Le")))};
function sDc(a){var b=a.H.F;a.J.tc(b);y(nhc(a.Hc()),function(c){var d=c.hb();d&&(d instanceof Iu?(c.tc(a.H.Lba(d.Jb())),c.eb(!b)):(d=new iDc(EB(d),d.Jb()),c.tc(a.H.zba(d)),c.eb(!a.H.Lba(d.Ki))))});tDc(a)}function tDc(a){if(a.H.F)var b="Entire Document";else{b=ub(a.Xa.D,u(function(a){return this.H.Lba(a.Jb())},a));b=vb(b,function(a){return a.C});for(var c=[],d=a.H.C,e=0;e<d.length;e++){var f=a.Pa.C(d[e].id);f&&c.push(wBc(f))}b=Mb(b,c);b=0<b.length?b.join(", "):"None"}a.setContent(b)};function BY(a,b){R.call(this,void 0);this.C=new AY(a,b);this.Wa(this.C,!0);this.D=!1}w(BY,wY);BY.prototype.Sa=function(){BY.$.Sa.call(this);fp(this.getElement(),"pub-dialog-published-content-container")};BY.prototype.F=function(){return this.C.H};BY.prototype.H=function(a){var b=this.C;b.H=a.clone();sDc(b)};BY.prototype.J=function(a){!a&&this.C.bq()&&(this.D=!0);this.C.eb(a);a&&this.D&&(this.wc()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function uDc(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+GBc(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return V(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function vDc(a,b,c,d,e,f,h){var k=null!=h?dDc(h):null;h=new jDc(c,d,k,!0);k=new jDc(c,d,k,!1);xY.call(this,a,b,e,Vqa,f,h,k,new BY(c,d),"/publishingsettings",new wDc);this.Xh=c;this.Kc=d}w(vDc,xY);
vDc.prototype.qJa=function(a){if(a.entireDocument)return new zY(!0,[],[]);var b=a.charts||"";a=vb((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=ub(a,function(a){return null!=bv(this.Xh,a)},this);b=vb(b.split(","),function(a){return parseInt(a,10)});b=ub(b,u(function(a){return!!this.Kc.C(a)},this));b=vb(b,function(a){var b=this.Kc.C(a);return new iDc(a,b.Jb())},this);return new zY(!1,a,b)};vDc.prototype.$Ia=function(){return new zY(!0,[],[])};
function SCc(a,b){if(b.F||null!=b.Ki){var c="html"==b.D;a=VCc(a,c?"/pubhtml":"/pub");null!=b.Ki&&(a=Gj(a,"gid",b.Ki,"single","true"));c||(a=Gj(a,"output",b.D))}else a=Gj(VCc(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function TCc(a,b){var c=SCc(a,b);if(b.F||null!=b.Ki)c=Gj(c,"widget","true","headers","false");a=b.C?(a=a.Kc.C(b.C.id))?a.Mc():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+$a(c)+'"></iframe>'}function wDc(){}w(wDc,R);wDc.prototype.Ga=function(){this.La=T(uDc,{locale:"en-GB"})};function xDc(a,b,c){return Nza(a||"There was a problem",pl(b),void 0,void 0,void 0,void 0,c)};function yDc(a){return V("<div><div>"+U(a.H7a)+"</div>"+U(Er({id:"waffle-confirm-suppress-checkbox",Ce:"waffle-confirm-suppress-checkbox"}))+'<span id="waffle-confirm-suppress-label">'+U(a.$ua)+"</span></div>")};function zDc(a,b,c,d,e,f,h){if(Ba(c)){var k=new qq;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=bza;return ADc(d||"Heads up!",a,b,k,e,f,h)}function ADc(a,b,c,d,e,f,h){b=pl(b);if(f){b=fr(yDc({H7a:b,$ua:f}));var k=new Fr;var l=c;c=function(){l(k.isChecked())}}a=Oza(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Wa(k),k.mb(gm(a.Ba(),"waffle-confirm-suppress-checkbox")),c=gm(a.Ba(),"waffle-confirm-suppress-label"),pr(k,c),k.tc(!1));return a};function CY(a,b){iy.call(this,36,null);this.D=a;this.Nd=b}w(CY,iy);CY.prototype.exec=Tf;CY.prototype.Le=n(38);CY.prototype.Ge=function(){var a=new Tw;C(a,2,this.D);C(a,1,this.Nd);return a};CY.prototype.Jg=function(){return B(this.D,1)?"Data validation applied.":"Data validation cleared."};function DY(){var a=new NH(null);dO(a,!0);return a};function BDc(a,b,c){I.call(this);this.D=a;this.ah=b;this.Ib=c;this.V=this.J=this.Oa=this.Ia=this.Z=this.H=null;this.Xb=new JO;this.dd=new JO;this.Ca=this.O=null;this.Kc=new JO;this.Zd=new JO;this.qa=this.L=null;this.kc=new JO;this.Bd=new JO;this.$a=this.Qb=null;this.C=new vV("");this.fb=this.F=this.Mb=this.zb=this.ib=null;this.We=this.Ub=!1;this.zc=this.Id=this.pb=this.Xa=null;this.cb=new J(this);F(this,this.cb);this.De=new rh;this.Qe=this.Fg=this.vf=this.pe=this.Ag=this.Pa=null;this.by();a=this.cb;
a.R(this.H,"action",this.Dub);a.R(this.Z,"action",this.Yoa);a.R(this.Ia,"action",this.Yoa);a.R(this.Oa,"action",this.Yoa);a.R(this.F,"focus",Ha(this.dVa,!0));a.R(this.F,"blur",Ha(this.dVa,!1));a.R(this.F,"change",this.Noa);a.R(this.F,"keyup",this.Noa);b=[this.O,this.Ca,this.J,this.V,this.L,this.qa];for(c=0;c<b.length;c++)this.cb.R(b[c],"change",u(this.fYb,this,b[c])),this.cb.R(b[c],"keyup",u(this.gYb,this,b[c]));a.R(this.pb,"change",u(this.QNa,this));Pf(a,this.fb,gd,this.nBb)}w(BDc,I);
var CDc="placeholder"in document.createElement("input"),DDc=/\s*,\s*/;function EDc(a){var b=a.Qe;b||(b=[{dj:"List from a range",type:4},{dj:"List of items",type:3},{dj:"Number",type:0},{dj:"Text",type:1},{dj:"Date",type:2},{dj:"Custom formula is",type:5}],sra&&b.push({dj:"Tick box",type:6}),a.Qe=b);return b}
function FDc(a){var b=a.Fg;b||(b=[{dj:"contains",code:9,inputs:0,example:"Approved"},{dj:"does not contain",code:10,inputs:0,example:"Approved"},{dj:"equals",code:13,inputs:0,example:"Approved"},{dj:"is a valid email",code:14,inputs:-1,example:null},{dj:"is a valid URL",code:15,inputs:-1,example:null}],a.Fg=b);return b}
function GDc(a){var b=a.pe;b||(b=[{dj:"is a valid date",code:30,inputs:-1,example:null},{dj:"equal to",code:16,inputs:2,example:"15/11/2014"},{dj:"before",code:17,inputs:2,example:"15/11/2014"},{dj:"on or before",code:19,inputs:2,example:"15/11/2014"},{dj:"after",code:18,inputs:2,example:"15/11/2014"},{dj:"on or after",code:20,inputs:2,example:"15/11/2014"},{dj:"between",code:21,inputs:3,example:"15/11/2014",$R:"15/11/2015"},{dj:"not between",code:22,inputs:3,example:"15/11/2014",$R:"15/11/2015"}],
a.pe=b);return b}function HDc(a){var b=a.vf;b||(b=[{dj:"range",code:23,inputs:6,example:null},{dj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.vf=b);return b}
function IDc(a){var b=a.Ag;b||(b=[{dj:"between",code:7,inputs:8,example:"10",$R:"100"},{dj:"not between",code:8,inputs:8,example:"10",$R:"100"},{dj:"less than",code:3,inputs:7,example:"10"},{dj:"less than or equal to",code:4,inputs:7,example:"10"},{dj:"greater than",code:1,inputs:7,example:"10"},{dj:"greater than or equal to",code:2,inputs:7,example:"10"},{dj:"equal to",code:5,inputs:7,example:"10"},{dj:"not equal to",code:6,inputs:7,example:"10"}],a.Ag=b);return b}
function JDc(){return{dj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function KDc(){return{dj:"",code:31,inputs:-1,example:""}}p=BDc.prototype;
p.by=function(){var a=this.D,b,c,d,e,f,h,k,l,m,q,r,v=a.Ba(),x;var z=v.Ga("TR","waffle-dv-trrules",v.Ga("TD","waffle-dv-label",v.Ga("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),v.Ga("TD",{LBc:"7"},l=v.Ga("DIV","goog-inline-block"),x=v.Ga("DIV","goog-inline-block"),h=v.Ga("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=v.Ga("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=v.Ga("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),b=
v.Ga("SPAN","waffle-dv-separator","and"),k=v.Ga("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=v.Ga("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=v.Ga("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.kc.mb(h);this.Bd.mb(k);this.Kc.mb(c);this.Zd.mb(d);this.Xb.mb(e);this.dd.mb(f);var D=DY();$p(D,l);var L=DY();$p(L,l);var O=DY();$p(O,l);var S=DY();$p(S,l);var aa=LDc(a,x);(m=D.getElement())&&$o(m,"labelledby","waffle-dv-criteria");
var ia;var ja=v.Ga("TR","waffle-dv-trrules waffle-dv-trrules-showitems",v.Ga("TD"),v.Ga("TD",{colspan:"7"},ia=v.Ga("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show drop-down list in cell")));var oa=new Fr;pr(oa,ia);$p(oa,ia);var xa=v.Ga("TR","waffle-dv-trrules",v.Ga("TD","waffle-dv-label",v.Ga("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),v.Ga("TD",{colspan:"7"},v.Ga("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},v.Ga("INPUT",
{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",role:"radio"}),v.Ga("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),v.Ga("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),v.Ga("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new xV(!0);yV(m,"onInvalidData",xa);var ya=v.Ga("TR","waffle-dv-trrules waffle-dv-trrules-appearance",v.Ga("TD",null,v.Ga("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),
v.Ga("TD",{colspan:"7"},q=v.Ga("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show validation help text:")));var Na=new Fr;pr(Na,q);$p(Na,q);q=Na.La;var fb=Sxa(q,"labelledby");$o(q,"labelledby","waffle-dv-appearance "+fb);q=v.Ga("TR","waffle-dv-trrules",v.Ga("TD"),v.Ga("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},r=v.Ga("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),fb=v.Ga("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},
"Reset")));am(fb,!0);a=a.O.childNodes[0];v.appendChild(a,z);v.appendChild(a,ja);v.appendChild(a,xa);v.appendChild(a,ya);v.appendChild(a,q);this.C.render(l);v=this.C;v.qra=29;v.resize();v=this.C;v.CQa=200;v.resize();this.C.getElement().style.width="324px";CDc?this.C.getElement().placeholder="Enter items separated by a comma...":(v=this.C.getElement(),rs(v,"Enter items separated by a comma...","Enter items separated by a comma..."));if(v=this.C.getElement())cp(v,"Enter items separated by a comma..."),
gp(v,["waffle-dv-list-options-textarea","jfk-textinput"]);rra&&(a=new WG("Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday;Monday, Tuesday, Wednesday, Thursday, Friday;January, February, March, April, May, June, July, August, September, October, November, December;Alabama, Alaska, Arizona, Arkansas, California, Colorado, Connecticut, Delaware, District of Columbia, Florida, Georgia, Hawaii, Idaho, Illinois, Indiana, Iowa, Kansas, Kentucky, Louisiana, Maine, Maryland, Massachusetts, Michigan, Minnesota, Mississippi, Missouri, Montana, Nebraska, Nevada, New Hampshire, New Jersey, New Mexico, New York, North Carolina, North Dakota, Ohio, Oklahoma, Oregon, Pennsylvania, Rhode Island, South Carolina, South Dakota, Tennessee, Texas, Utah, Vermont, Virginia, Washington, West Virginia, Wisconsin, Wyoming;AK, AL, AR, AZ, CA, CO, CT, DC, DE, FL, GA, HI, IA, ID, IL, IN, KS, KY, LA, MA, MD, ME, MI, MN, MO, MS, MT, NC, ND, NE, NH, NJ, NM, NV, NY, OH, OK, OR, PA, RI, SC, SD, TN, TX, UT, VA, VT, WA, WI, WV, WY;United States of America, USA, Afghanistan, Albania, Algeria, Andorra, Angola, Antigua & Deps, Argentina, Armenia, Australia, Austria, Azerbaijan, Bahamas, Bahrain, Bangladesh, Barbados, Belarus, Belgium, Belize, Benin, Bhutan, Bolivia, Bosnia Herzegovina, Botswana, Brazil, Brunei, Bulgaria, Burkina, Burma, Burundi, Cambodia, Cameroon, Canada, Cape Verde, Central African Republic, Chad, Chile, China, People's Republic of China, Republic of China, Colombia, Comoros, Democratic Republic of the Congo, Republic of the Congo, Costa Rica, Croatia, Cuba, Cyprus, Czech Republic, Danzig, Denmark, Djibouti, Dominica, Dominican Republic, East Timor, Ecuador, Egypt, El Salvador, Equatorial Guinea, Eritrea, Estonia, Ethiopia, Fiji, Finland, France, Gabon, The Gambia, Georgia, Germany, Ghana, Greece, Grenada, Guatemala, Guinea, Guinea-Bissau, Guyana, Haiti, Holy Roman Empire, Honduras, Hungary, Iceland, India, Indonesia, Iran, Iraq, Republic of Ireland, Israel, Italy, Ivory Coast, Jamaica, Japan, Jonathanland, Jordan, Kazakhstan, Kenya, Kiribati, North Korea, South Korea, Kosovo, Kuwait, Kyrgyzstan, Laos, Latvia, Lebanon, Lesotho, Liberia, Libya, Liechtenstein, Lithuania, Luxembourg, Macedonia, Madagascar, Malawi, Malaysia, Maldives, Mali, Malta, Marshall Islands, Mauritania, Mauritius, Mexico, Micronesia, Moldova, Monaco, Mongolia, Montenegro, Morocco, Mount Athos, Mozambique, Namibia, Nauru, Nepal, Newfoundland, Netherlands, New Zealand, Nicaragua, Niger, Nigeria, Norway, Oman, Ottoman Empire, Pakistan, Palau, Palestine, Panama, Papua New Guinea, Paraguay, Peru, Philippines, Poland, Portugal, Prussia, Qatar, Romania, Rome, Russian Federation, Rwanda, St Kitts & Nevis, St Lucia, Saint Vincent, Grenadines, Samoa, San Marino, Sao Tome & Principe, Saudi Arabia, Senegal, Serbia, Seychelles, Sierra Leone, Singapore, Slovakia, Slovenia, Solomon Islands, Somalia, South Africa, Spain, Sri Lanka, Sudan, Suriname, Swaziland, Sweden, Switzerland, Syria, Tajikistan, Tanzania, Thailand, Togo, Tonga, Trinidad & Tobago, Tunisia, Turkey, Turkmenistan, Tuvalu, Uganda, Ukraine, United Arab Emirates, United Kingdom, Uruguay, Uzbekistan, Vanuatu, Vatican City, Venezuela, Vietnam, Yemen, Zambia, Zimbabwe;Pass, Fail;Yes, No;Approved, Rejected;Approved, Rejected, Pending;Complete, In Progress, Not Started;On Track, At Risk, Delayed;True, False;Q1, Q2, Q3, Q4;Small, Medium, Large;XS, S, M, L, XL;A+, A, A-, B+, B, B-, C+, C, C-, D, F".split(";"),
!0),xa=new YG,z=new $G(null,null,!1),a=new UG(a,xa,z),z.C=a,z.L0(v),a.we().Aua=!0);this.F=r;D.setVisible(!0);r=EDc(this);MDc(this,r,D);r=IDc(this);MDc(this,r,S);r=FDc(this);MDc(this,r,L);r=GDc(this);MDc(this,r,O);NDc(this,D,S,L,O,h,k,c,d,e,f,b,l,aa,ja,q,oa,ia,fb,Na,x,m)};
function NDc(a,b,c,d,e,f,h,k,l,m,q,r,v,x,z,D,L,O,S,aa,ia,ja){a.H=b;a.H.setVisible(!0);a.Ia=c;a.Z=e;a.Oa=d;a.Qb=r;a.L=f;a.qa=h;a.O=k;a.Ca=l;a.J=m;a.V=q;a.$a=v;a.Pa=x;a.ib=ia;aa.tc(!1);a.pb=aa;a.zc=ja;ODc(a,!1);a.zb=z;L.tc(!0);a.Xa=L;a.Id=O;a.Mb=D;Q(a.Mb,!0);PDc(a);QDc(a);a.fb=S;Q(a.fb,!1)}function RDc(a,b){Q(a.zb,23==b||24==b||31==b);a.Id.innerText=31==b?"Display in-cell tick box":"Show drop-down list in cell"}
function MDc(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.Ba(),e=new Tq(b[d].dj,null,e);c.re(e);Zo(e.getElement(),"menuitem")}c.Vf(0)}p.Yoa=function(){QDc(this);this.F.value=EY(this);this.dispatchEvent("change")};p.Dub=function(){PDc(this);QDc(this);this.F.value=EY(this);this.dispatchEvent("change")};p.dVa=da("We");p.Noa=function(a){this.Ub||a&&!Vwa(a)||this.F.value===SDc(this)||(this.Ub=!0,Q(this.fb,!0))};p.nBb=function(){this.Ub=!1;this.F.value=EY(this);Q(this.fb,!1)};
p.QNa=function(){Q(this.Mb,this.pb.L)};p.fYb=function(a){this.F.value=EY(this);TDc(this,a)?(this.D.Gn=0,FY(a),this.dispatchEvent("change")):(this.D.Gn=1,GY(a),this.dispatchEvent("error"))};p.gYb=function(){this.dispatchEvent("keyup")};function TDc(a,b){if(0!=HY(a))return!0;var c=b.value;if(null!=c&&Ip(b)){if(!UDc(a.D))return!0;a=IY(a,c,VDc(a).code);return null!=a&&(yc(a,3)||yc(a,5)&&B(a,5).fd()&&3==B(B(a,5).Za(),1))}return!0}function GY(a){a.select();fp(a,"waffle-input-error")}
function FY(a){a&&hp(a,"waffle-input-error")}function HY(a){return EDc(a)[a.H.Lh()].type}function PDc(a){var b=HY(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.Z.setVisible(c);a.Ia.setVisible(d);a.Oa.setVisible(e);Q(a.$a,f);Q(a.ib,h);Q(a.L,!1);Q(a.qa,!1);Q(a.O,!1);Q(a.Ca,!1);Q(a.J,!1);Q(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function VDc(a){var b;null!=WDc(a)?b=WDc(a):a.Z.kb()?b=GDc(a)[a.Z.Lh()]:a.Ia.kb()?b=IDc(a)[a.Ia.Lh()]:5==HY(a)?b=JDc():6==HY(a)?b=KDc():b=FDc(a)[a.Oa.Lh()];return b}function WDc(a){var b=HDc(a);return 4==HY(a)?b[0]:3==HY(a)?b[1]:null}
function QDc(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,q=VDc(a);-1!=q.inputs&&(0==q.inputs?d=!0:1==q.inputs?k=e=d=!0:2==q.inputs?f=!0:3==q.inputs?k=h=f=!0:7==q.inputs?b=!0:8==q.inputs?k=c=b=!0:5==q.inputs?l=!0:6==q.inputs&&(m=!0));var r=VDc(a);if(3==HY(a))CDc?a.C.getElement().placeholder="Enter items separated by a comma...":(r=a.C.getElement(),rs(r,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(r.example)if(0==r.inputs||1==r.inputs)ES(a.Kc,"e.g. "+
r.example),ES(a.Zd,"e.g. "+r.$R||"");else if(2==r.inputs||3==r.inputs)ES(a.Xb,"e.g. "+r.example),ES(a.dd,"e.g. "+r.$R||"");else if(7==r.inputs||8==r.inputs)ES(a.kc,"e.g. "+r.example),ES(a.Bd,"e.g. "+r.$R||"");FY(a.C.getElement());FY(a.J);FY(a.V);FY(a.L);FY(a.qa);FY(a.O);FY(a.Ca);FY(a.Pa.hs());a.D.Gn=0;a.dispatchEvent("change");Q(a.L,b);Q(a.qa,c);Q(a.O,d);Q(a.Ca,e);Q(a.J,f);Q(a.V,h);Q(a.$a,l);l&&a.C.resize();Q(a.ib,m);RDc(a,q.code);Q(a.Qb,k)}
function IY(a,b,c){var d=UDc(a.D);if(""==b||null==d.Xc)return null;var e=d.rect,f=e.qc(),e=e.hc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.Xc+"",f,e,b,c,!0))?a.De.cd(Vd.Ra(),b):null}function XDc(a){var b=Xa(a.Pa.Za());!a.Ib.C.D[Xa(ib(b).toLowerCase())]&&ZC(a.Ib,b)&&(b=x_a(a.Ib,b,!0));return b}function EY(a){return a.Ub||a.We?a.F.value:SDc(a)}
function SDc(a){var b="";var c=HY(a);var d=4==c;c=3==c||4==c;a.Z.kb()?(c=GDc(a)[a.Z.Lh()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date "):a.Oa.kb()?(c=FDc(a)[a.Oa.Lh()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid URL":b+"Enter text that "):c?(c=WDc(a),b+="Click and enter a value from "):5==HY(a)?(c=JDc(),b="Enter a value that satisfies the formula:"):6==HY(a)?(c=KDc(),b="Enter TRUE or FALSE"):(c=IDc(a)[a.Ia.Lh()],b+="Enter a number ");-1!=c.inputs&&(b+=c.dj);var e=XDc(a);
23==c.code&&""!=e&&d&&(d=x_a(a.Ib,e,!0))&&(b+=" "+d);Va(ib(a.O.value))||0!=c.inputs&&1!=c.inputs?Va(ib(a.J.value))||2!=c.inputs&&3!=c.inputs?Va(ib(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.J.value:b+=" "+a.O.value;Va(ib(a.Ca.value))||1!=c.inputs?Va(ib(a.V.value))||3!=c.inputs?Va(ib(a.qa.value))||8!=c.inputs||(b+=" and "+a.qa.value):b+=" and "+a.V.value:b+=" and "+a.Ca.value;return b}function ODc(a,b){zV(a.zc,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}
function JY(a,b){switch(b){case 0:a.H.Vf(2);break;case 1:a.H.Vf(3);break;case 2:a.H.Vf(4);break;case 3:a.H.Vf(1);break;case 4:a.H.Vf(0);break;case 5:a.H.Vf(5);break;case 6:a.H.Vf(6)}}p.Ja=function(){this.qa=this.L=this.Ca=this.O=this.V=this.J=null;G(this.C);this.zb=this.Xa=this.fb=this.F=this.Qb=this.C=null;G(this.Pa);this.Pa=null;G(this.Xa);this.Xa=null;G(this.Oa);this.Oa=null;G(this.Ia);this.Ia=null;G(this.Z);this.Z=null;G(this.H);this.H=null;BDc.$.Ja.call(this)};function YDc(a,b,c,d,e){hq.call(this);this.Ia=a;this.ib=b;this.$a=c;this.fb=d;this.V=e;this.F=this.O=null;this.cb=new J(this);F(this,this.cb);this.Ca=this.J=this.C=null;this.L=new qq;this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);tq(this,this.L);pq(this,!1);this.render();a=this.Zb();b=xl(a);iq(this,"Data validation");this.J||(c=b.Ga("DIV",{"class":ZDc.yZa}),d=b.Ga("DIV",{"class":ZDc.xZa},c),b.appendChild(a,d),this.J=new Jr(d),this.J.setType("warning"),
this.J.setContent(""),this.J.render(c),gBa(this.J,!0),this.J.setVisible(!1));this.O=b.Ga("TABLE",{cellSpacing:"0","class":ZDc.$J},b.Ga("TBODY"));b.appendChild(a,this.O);a=this.Zb();a=xl(a);b=a.Ga("TR",ZDc.c4a);b.appendChild(a.Ga("TD","waffle-dv-label",a.Ga("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));c=a.Ga("TD",{colspan:"7"});this.C=LDc(this,c);$Dc(this);b.appendChild(c);a.appendChild(this.O.childNodes[0],b);(a=this.C.hs())&&$o(a,"labelledby","waffle-dv-cell-range");this.F=new BDc(this,
this.Ia,this.V);ar(this,"save");this.cb.R(this,"dialogselect",this.eYb).R(this.F,"error",this.yub).R(this.F,"change",this.dYb)}w(YDc,hq);var ZDc={$J:"waffle-dv-table",c4a:"waffle-dv-trrules",xZa:"waffle-input-error-butter-container",yZa:"waffle-input-error-butter-wrap",h1a:"waffle-input-error"};p=YDc.prototype;p.Gn=0;function $Dc(a){if(a.C){var b=a.Ia.getActiveGrid();b&&(b=yv(tB(a.$a).Rc(),b.C),a.C.gb(b))}}p.yub=function(){aEc(this)};p.dYb=function(){aEc(this);wq(this.L,"save",!0)};
p.eYb=function(a){if("save"==a.key){var b=this.F;var c=HY(b);if(0==c){var c=b.L,d=b.qa,e=TDc(b,c),f=TDc(b,d);e&&f?b.D.Gn=0:(e||GY(c),f||GY(d),b.D.Gn=1)}else 1==c?(c=b.O,d=b.Ca,e=!Ip(c)||!Va(ib(c.value)),f=!Ip(d)||!Va(ib(d.value)),e&&f?b.D.Gn=0:(e||GY(c),f||GY(d),b.D.Gn=6)):2==c?(c=b.J,d=b.V,e=!Ip(c)||!Va(ib(c.value)),f=!Ip(d)||!Va(ib(d.value)),e&&f?b.D.Gn=0:(e||GY(c),f||GY(d),b.D.Gn=7)):3==c||4==c?(c=0,4==HY(b)?(d=XDc(b),ZC(b.Ib,d)?(d=XDc(b),d=$C(b.Ib,d),e=UDc(b.D),null!=d&&null!=e&&d.Xc==e.Xc&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==HY(b)&&b.C.getElement()&&Va(ib(b.C.Za()))&&(c=5),d=c,c=0==d,b.D.Gn=d,d=b.ib&&Ip(b.ib),b.$a&&Ip(b.$a)?(jp(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.Ba().vx(b.Pa.getElement()),jp(d,"waffle-input-error",!c),b.Pa.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error")):b.D.Gn=0;b=this.C.Za();b=ZC(this.V,b);2==this.Gn&&b?this.Gn=0:0!=this.Gn||b||(this.Gn=2);aEc(this);if(0!=this.Gn)b=!1;else{b=this.F;c=b.zc.isChecked("rejectInvalidData_radio");d=
EY(b);b.pb.isChecked()||(d="");b:{var e=new Yd,h=VDc(b),f=h.code,k=[];switch(h.inputs){case 0:k.push(IY(b,b.O.value,f));break;case 1:k.push(IY(b,b.O.value,f));k.push(IY(b,b.Ca.value,f));break;case 2:k.push(IY(b,b.J.value,f));break;case 3:k.push(IY(b,b.J.value,f));k.push(IY(b,b.V.value,f));break;case 7:k.push(IY(b,b.L.value,f));break;case 8:k.push(IY(b,b.L.value,f));k.push(IY(b,b.qa.value,f));break;case 5:for(var h=b.C.Za().split(","),l=0;l<h.length;l++)k.push(FBc(h[l]));break;case 6:h=dIa("="+b.Pa.Za()),
k.push(IY(b,h,f))}for(h=0;h<k.length;h++)if(!k[h]){e=null;break b}f=aT(f,k);C(e,1,f)}(f=e)?(e=new Zd,C(e,1,f),C(e,2,d),C(e,3,c),b=Ip(b.zb)&&b.Xa.isChecked(),C(e,4,b),b=(b=bEc(this))?this.fb.C(new CY(e,b)):!1):b=!1}if(!b){a.preventDefault();return}}else{if(b="clear"==a.key)b=bEc(this),b=!(b&&this.fb.C(new CY(new Zd,b)));if(b){a.preventDefault();return}}this.C&&this.C.eb(!1)};
function aEc(a){var b=cEc(a.Gn);b&&a.J.setContent(b);a.J.setVisible(0!=a.Gn);var b=2==a.Gn||4==a.Gn,c=a.Ba().vx(a.C.getElement());jp(c,ZDc.h1a,b);b&&a.C.hs().select()}
function cEc(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date"}return null}function bEc(a){var b=a.C.Za(),b=(b=$C(a.V,b))?b.rect:null,c=a.C.Za();a=(a=$C(a.V,c))?a.Xc:null;return b&&null!=a?vh(b,a):null}
function UDc(a){var b=a.C.Za();return $C(a.V,b)}function LDc(a,b){var c=a.Ia.C.C,c=new HU(a.$a,u(a.cYb,a),!1,"e.g. Sheet1!A2:D5",!0,c,a.Ba());a.getHandler().R(c,"change",function(){var a=this.F;a&&(a.F.value=EY(a))});c.render(b);return c}p.setVisible=function(a){YDc.$.setVisible.call(this,a);a&&this.Ca&&(this.Ca.focus(),this.Ca=null)};p.cYb=function(a,b,c,d){this.Ca=a.hs();this.ib.Yea(this,a,b,c,!1,!0,d)};
p.show=function(){var a="",b=!1,c=fv(this.Ia),d=Iv(c),c=xA(Jv(c,d)),e=null,d=!1;c&&(c=c.C,e=B(c,1),a=B(c,2),b=B(c,3),d=B(c,4));var c=this.F,f=e,h=d;c.H.Vf(0);c.Z.Vf(0);c.Ia.Vf(0);c.Oa.Vf(0);c.F.value="";c.L.value="";c.qa.value="";c.J.value="";c.V.value="";c.O.value="";c.Ca.value="";c.C.gb("");c.Pa.gb("");ODc(c,!1);var k=c.Ub=!1,l=!1,m=!1,q=!1,r=!1,v=!1,x=!1,z=e=d=!1,D=!1,L=!1,O=!1,S=!1,aa=!1,ia=!1,ja=!1,oa=f&&B(f,1),f=oa&&B(oa,1);if((oa=oa&&Ec(oa,2))&&f){for(var xa=HDc(c),ya=GDc(c),Na=IDc(c),fb=FDc(c),
Ta=JDc(),Ja=KDc(),sb=0,fc=0;fc<xa.length;fc++)if(f==xa[fc].code){sb=xa[fc].inputs;23==xa[fc].code?(aa=!0,JY(c,4)):(D=!0,JY(c,3));c.Xa.tc(!!h);break}for(xa=0;xa<ya.length;xa++)if(f==ya[xa].code){sb=ya[xa].inputs;c.Z.Vf(xa);JY(c,2);L=d=!0;break}for(ya=0;ya<Na.length;ya++)if(f==Na[ya].code){sb=Na[ya].inputs;c.Ia.Vf(ya);JY(c,0);O=e=!0;break}for(Na=0;Na<fb.length;Na++)if(f==fb[Na].code){sb=fb[Na].inputs;c.Oa.Vf(Na);JY(c,1);S=z=!0;break}f==Ta.code&&(sb=Ta.inputs,JY(c,5),ia=!0);f==Ja.code&&(sb=Ja.inputs,
JY(c,6),c.Xa.tc(!!h),ja=!0);if(L||S||O||D||aa||ia||ja){if(O=UDc(c.D),h=O.rect.qc(),L=O.rect.hc(),O=O.Xc+"",-1!=sb)if(0==sb)r=yz(oa[0],O,h,L),c.Kc.gb(r),r=!0;else if(1==sb)v=yz(oa[0],O,h,L),r=yz(oa[1],O,h,L),c.Kc.gb(v),c.Zd.gb(r),v=r=x=!0;else if(2==sb)k=yz(oa[0],O,h,L),c.Xb.gb(k),k=!0;else if(3==sb)l=yz(oa[0],O,h,L),k=yz(oa[1],O,h,L),c.Xb.gb(l),c.dd.gb(k),l=k=x=!0;else if(7==sb)m=yz(oa[0],O,h,L),c.kc.gb(m),m=!0;else if(8==sb)q=yz(oa[0],O,h,L),m=yz(oa[1],O,h,L),c.kc.gb(q),c.Bd.gb(m),q=m=x=!0;else if(5==
sb){D=!0;sb=[];for(S=0;S<oa.length;S++)sb.push(yz(oa[S],O,h,L));c.C.gb(sb.join(","));c.C.resize()}else 6==sb&&(aa=!0,sb=yz(oa[0],O,h,L),null!=sb&&(sb=sb.substring(1),oa=!!uv(sb),sb=(h=wv(sb,c.ah,!1,!0))?yv(h.rect,h.Uh):sb,oa||(sb=vv(sb)),c.Pa.gb(sb)))}else c.H.Vf(0),aa=!0;Q(c.Qb,x);c.Z.setVisible(d);c.Ia.setVisible(e);c.Oa.setVisible(z);Q(c.J,k);Q(c.V,l);Q(c.O,r);Q(c.Ca,v);Q(c.L,m);Q(c.qa,q);Q(c.zb,!0);Q(c.$a,D);c.C.resize();Q(c.ib,aa);null!=f&&RDc(c,f)}else{if(ora){d=fv(c.ah);e=d.Rc();z=new og;for(D=
e.qc();D<e.Lc();D++)for(aa=e.hc();aa<e.Sc();aa++)f=d.If(D,aa),""!=vA(f)&&pg(z,vA(f).split(DDc));z.isEmpty()?d=!1:(c.C.gb(z.jd().join(",")),JY(c,3),PDc(c),d=!0)}else d=!1;d||NDc(c,c.H,c.Ia,c.Oa,c.Z,c.L,c.qa,c.O,c.Ca,c.J,c.V,c.Qb,c.$a,c.Pa,c.zb,c.Mb,c.Xa,c.Id,c.fb,c.pb,c.ib,c.zc)}c.QNa();a=a||"";d=a.lastIndexOf("</strong>");-1!=d&&(a=ab(Xa(a.substring(d+9))));c.pb.tc(!!a);a&&(EY(c)!=a&&c.Noa(),c.F.value=a,Q(c.Mb,!0));ODc(c,b);this.setVisible(!0);this.C&&this.C.eb(!0);$Dc(this);c=this.F;c.F.value=EY(c);
c.C.resize()};p.Ja=function(){G(this.F);this.F=null;G(this.C);this.L=this.O=this.C=null;YDc.$.Ja.call(this)};function dEc(a,b,c,d,e){hq.call(this);this.Kc=d.O;this.ib=c;this.zb=d.C;this.$a=d;this.Db=e;this.pb=null;this.Ub=d.V;iq(this,"Find and replace");pq(this,!1);c=this.Zb();d=xl(c);this.F=d.Ga("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F.value=a;this.Ia=d.Ga("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C=new NH(null);this.dd=b;this.O=new HU(this.ib,u(this.BYb,this),!1,"",!0);this.V=null;this.Ca=new Fr;this.fb=new Fr;this.L=new Fr;this.J=new Fr;this.kc=this.Mb=this.Qb=
this.Xb=!1;this.Ib=d.Ga("SPAN");eic(this.Ib);this.zc=new br(this.F);F(this,this.zc);a=eEc;d.Ga("LABEL",{"for":a.kya},"Search");b=d.Ga("LABEL",{"for":a.hza},"Match case");e=d.Ga("LABEL",{"for":a.iza},"Match entire cell contents");var f=d.Ga("LABEL",{},"Also search within formulae"),h=d.Ga("LABEL",{"for":a.YAa},"Search using regular expressions "),k=(new om(Wqa)).toString(),l=d.Ga("SPAN",null,d.Ga("A",{target:"_blank",href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});var k=aq(this,"findLabel"),m=aq(this,"replaceLabel"),q=aq(this,"findScopeLabel"),r=d.Ga("DIV","goog-inline-block"),v=d.Ga("DIV",a.e3a),l=d.Ga("TABLE",null,d.Ga("TBODY",null,d.Ga("TR",null,d.Ga("TD",a.LABEL,d.Ga("LABEL",{id:k},"Find")),d.Ga("TD",null,this.F)),d.Ga("TR",null,d.Ga("TD",a.LABEL,d.Ga("LABEL",{id:m},"Replace with")),d.Ga("TD",null,this.Ia)),d.Ga("TR",null,d.Ga("TD",null,d.Ga("LABEL",{id:q},"Search")),d.Ga("TD",null,r,v)),d.Ga("TR",null,d.Ga("TD",null,""),d.Ga("TD",
null,b,d.Ga("BR"),e,d.Ga("BR"),h,l,d.Ga("BR"),f)),d.Ga("TR",null,d.Ga("TD",{colspan:"2"},this.Ib))));this.C.render(r);fp(this.C.getElement(),a.kya);this.O.render(v);$p(this.Ca,b);pr(this.Ca,b);this.Ca.getElement().id=a.hza;$p(this.fb,e);pr(this.fb,e);this.fb.getElement().id=a.iza;$p(this.L,h);pr(this.L,h);this.L.getElement().id=a.YAa;pr(this.J,f);$p(this.J,f);$o(this.F,"labelledby",k);$o(this.Ia,"labelledby",m);$o(this.C.La,"labelledby",q);d.appendChild(c,l);c=new qq;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);tq(this,c);ar(this,"");this.getHandler().R(this,"dialogselect",this.CYb).R(this.zc,"input",this.nPa).R(this.L,"change",this.cCb).R(this.C,"change",this.Esb).R(this.O,"change",this.DYb).R(this.J,"change",this.dCb);c=new cr;c.mb(this.F);F(this,c);c=new cr;c.mb(this.Ia);F(this,c);fEc(this);c=new mp(this.getElement());F(this,c);this.getHandler().R(c,"focusin",this.WXa).R(this.getElement(),"mousedown",this.WXa)}w(dEc,hq);
var eEc={axa:"waffle-find-replace-dialog-border",kya:"waffle-find-replace-find-scope-select",LABEL:"waffle-find-replace-dialog-label",hza:"find-replace-case",iza:"find-replace-cell",YAa:"find-replace-regex",e3a:"waffle-find-replace-selection-input goog-inline-block"};
function fEc(a){var b=tB(a.ib),c=null,d=null;b&&(c=beb(b),d=bv(a.zb,c.Xc).C);a.J.tc(a.Ub);var e=new Tq("All sheets",OKa.bZa),f=new Tq("This sheet",OKa.l3a),h=new Tq("Specific range",OKa.IJ);a.C.re(e);a.C.re(f);a.C.re(h);f=c?xB(a.zb,c.Xc):null;f=(f=c&&f?vw(f,c.rect.qc(),c.rect.hc()):null)?f.Hh():1;c&&c.rect.Hh()>f?kt(a.C,h):kt(a.C,e);b&&a.O.gb(yv(c.rect,d))}function gEc(a){var b=a.C.Cf().hb(),c=Xu(a.ib.D);return 0==b?wv(a.O.Za(),a.zb,!1,!0):1!=b||null===c?null:new oh(c,"",new ah(0,0,1,1))}p=dEc.prototype;
p.WXa=function(a){a.target==this.getElement()?this.focus():this.Db.Rb(2)};p.DYb=function(){hEc(this)};p.dCb=function(){var a=this.J.isChecked();xSb(this.$a,a)};p.Esb=function(){hEc(this)};p.cCb=function(){this.L.isChecked()&&this.Ca.tc(!0)};
p.CYb=function(a){var b=iEc;if("findNext"==a.key)a.preventDefault(),this.Xb&&(KY(this,null),jEc(this,b.jya));else if("replace"==a.key)a.preventDefault(),this.Qb&&(KY(this,null),jEc(this,b.lAa));else if("replaceAll"==a.key&&(a.preventDefault(),this.kc)){a=u(function(){KY(this,null);jEc(this,b.kAa)},this);var c=this.C.Cf().hb();1<this.zb.D.length&&2==c&&!this.Mb?(sic("Replace on all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.Mb=!0):a()}};
p.nPa=function(){var a=0==this.F.value.length;uq(this.D,"findNext").disabled=a;this.Xb=!a;kEc(this,!a);this.Qb&&a&&lEc(this,!1)};p.BYb=function(a,b,c){this.pb=a.hs();this.dd.Yea(this,a,b,c,!1,!0)};function hEc(a){var b=0==a.C.Cf().hb();a.O.setVisible(b);G(a.V);a.V=null;var c=gEc(a),d=tB(a.ib);b&&d&&c&&(a.V=dI(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.V.setVisible(!0),F(a,a.V))}
function jEc(a,b){if(0==a.C.Cf().hb()&&null==gEc(a))jp(a.O.D,"waffle-range-selection-error",!0),KY(a,"Invalid range");else{var c=a.C.Cf().hb();a.dispatchEvent(new mEc(b,a.F.value,a.Ia.value,c,a.Ca.isChecked(),a.fb.isChecked(),a.L.isChecked(),a.J.isChecked(),gEc(a)))}}p.setVisible=function(a){var b=this.$a.Fd();kEc(this,!b);lEc(this,!b);this.Ia.disabled=b;dEc.$.setVisible.call(this,a);a&&this.pb&&(this.pb.focus(),this.pb=null)};p.xTb=function(a){this.F.value=a};p.wUa=function(){this.F.select()};
p.focus=function(){this.wc()&&this.kb()&&(this.F.focus(),this.Db.Rb(2),pu(this.F,this.F.value.length),this.nPa())};function lEc(a,b,c){b=b&&!a.$a.Fd()&&0==!a.F.value.length;a.Qb=b;a=uq(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}function kEc(a,b){var c=!!zb(r_a(a.Kc),function(a){return!a.Sj()});b=b&&!a.$a.Fd()&&!c&&0==!a.F.value.length;a.kc=b;a=uq(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}
function KY(a,b){var c=xl(a.Zb());a=a.Ib;b?(0<Sl(a).length&&c.appendChild(a,c.Ga("BR")),c.appendChild(a,c.Ga("B",null,km(c,b)))):c.Gd(a)}p.Ja=function(){dEc.$.Ja.call(this);this.Mb=!1;xSb(this.$a,this.Ub)};function mEc(a,b,c,d,e,f,h,k,l){H.call(this,a);this.F=b;this.J=c;this.C=d;this.L=e;this.V=f;this.Z=h;this.qa=k;this.Pa=l||null}w(mEc,H);var iEc={jya:"findnext",xbc:"findall",lAa:"replace",kAa:"replaceall",DONE:"done",m5b:"canceled"};function nEc(a,b,c,d,e){E.call(this);var f=iEc;this.H=null;this.C=a;this.D=b;this.F=c;this.L=d;this.J=e;this.cb=new J(this);F(this,this.cb);this.cb.R(a,f.kAa,this.gBb).R(a,f.lAa,this.hBb).R(a,f.jya,this.VXa).R(a,f.DONE,this.Fqb)}w(nEc,E);var LY={fP:"cg",gP:"cr",eP:"cc",iya:"loop"};p=nEc.prototype;p.rVb=function(){this.C.setVisible(!0);oEc(this,null)};p.VXa=function(a){if(ev(this.D.D)){var b=tB(this.D).hb(),c=this.H;c||(c=Iv(b),c=vc(LY.fP,b.vc(),LY.gP,oB(b,c.y),LY.eP,pB(b,c.x)));pEc(this,a,b,c)}};
function pEc(a,b,c,d){var e=new rh,f=qEc(b);rEc(f,c,d);c=e.serialize(f);a=u(function(a){var c=e.cd((new Iw).Ra(),a);a=B(f,1);var d=b.type;ev(this.D.D)&&(c?yc(c,1)?(d=B(c,1),c=vc(LY.fP,parseInt(d.Jb(),10),LY.gP,d.Dz(),LY.eP,d.getColumnIndex(),LY.iya,B(c,2)),sEc(this,a,c)):(sEc(this,a,{}),"replace"==d&&this.C.focus()):tEc(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function rEc(a,b,c){if(c){var d=""+c[LY.fP],e=new ae;C(e,1,d);C(e,2,lB(b,c[LY.gP],"r"));C(e,3,lB(b,c[LY.eP],"c"));C(a,10,e)}}
function qEc(a){var b=new Gw;C(b,1,a.F);C(b,3,a.J);C(b,5,a.C);if(0==a.C||1==a.C){var c=a.Pa,d=new Ld;C(d,1,""+c.Xc);var e=c.rect.qc();C(d,2,e);Md(d,c.rect.Lc());Nd(d,c.rect.hc());Od(d,c.rect.Sc());b.setSelection(d)}C(b,6,a.L||!1);C(b,7,a.V||!1);C(b,8,a.Z||!1);b.setType(a.qa?1:0);C(b,11,0);return b}function sEc(a,b,c){c?c&&null!=c.cg?(b=c[LY.fP],c[LY.iya]&&KY(a.C,"No more results found, looping around"),a.F.IA(b,u(a.AYb,a,c))):(oEc(a,null),KY(a.C,"There are no entries matching "+b)):tEc(a)}
p.AYb=function(a){var b=tB(this.D).hb(),c=a[LY.gP],d=a[LY.eP];a[LY.gP]=oB(b,c);a[LY.eP]=pB(b,d);oEc(this,a);a=new Mg(d,c);b=new oh(b.vc(),"",ch(a));GS(this.F,b,u(this.d5a,this,a))};p.d5a=function(a){if(!this.isDisposed()){this.C.focus();var b=tB(this.D).hb();Lv(b.If(a.y,a.x))&&!this.C.J.isChecked()&&lEc(this.C,!1,"Can't replace formula");var c=HA(b,a.y),d=IA(b,a.x);!c||!d||c.kb()&&d.kb()||(c=this.C,d=xv(a),a=vA(Jv(b,a)),KY(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};
function tEc(a){KY(a.C,null);KY(a.C,"Error while searching spreadsheet. Please try again.")}p.hBb=function(a){if(!this.J.Fd()){var b=this.H;if(b){var c=hz(this.F,b[LY.fP]);if(c){var c=c.Pc(),d=lB(c,b[LY.gP],"r"),e=lB(c,b[LY.eP],"c"),f=c.If(d,e);if(!Lv(f)||this.C.J.isChecked()){var f=vA(f),h=new rh,k=qEc(a);C(k,5,0);rEc(k,c,b);var l=new Ld;C(l,1,""+b[LY.fP]);C(l,2,d);Md(l,d+1);Nd(l,e);Od(l,e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);uEc(this,c,k,f,b,!1);this.VXa(a)}}}}};
p.gBb=function(a){if(!this.J.Fd()&&ev(this.D.D)){var b=this.F.getActiveGrid().Pc(),c=qEc(a);uEc(this,b,c,a.F,a.J,!0)}};
function uEc(a,b,c,d,e,f){b=new wV(b,c);jy(b,u(function(a,b){a?(a=B(b,5),b=B(b,4),b=0==a?"No matches found":f?(new Nn(1==b?"{NUM_CHANGED,plural, =0{unused plural form}=1{Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other{Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS,plural, =0{unused plural form}=1{unused plural form}other{Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),KY(this.C,null),KY(this.C,b)):tEc(this)},a));KY(a.C,null);KY(a.C,"Working...");a.L.C(b)||tEc(a)}p.Fqb=function(){oEc(this,null)};function oEc(a,b){a.H=b;(a=a.C)&&lEc(a,null!=b)};function vEc(){var a='<div id="print-warning">'+U("Sheets with full page charts and gadgets won't be printed. You can print all other sheets in your spreadsheet.")+'</div><hr class="print-divider"/><table width="100%" role="presentation"><tr><div class="waffle-dialog-header">'+U("Options")+'</div><td width="50%" valign="center" class="print-options-container">';var b=""+('<div role="radiogroup" aria-label="'+W(ur("Print options: What to print"))+'"><input type="radio" name="whatPartsGroup" id="print-active-sheet"/><label for="print-active-sheet">'+
U("Current sheet")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-all-sheets"/><label for="print-all-sheets">'+U("All sheets")+'</label><br/><input type="radio" name="whatPartsGroup" id="print-selection"/><label for="print-selection">'+U("Selection")+"</label></div>");b=V(b);a=a+b+'</td><td width="50%" valign="center" class="print-options-container">';b=""+('<div role="group" aria-label="'+W(ur("Additional print options"))+'"><span id="print-repeat-row-headers" class="jfk-checkbox"></span><label for="print-repeat-row-headers">'+
U("Repeat row headers on each page")+'</label><br/><span id="print-omit-gridlines" class="jfk-checkbox"></span><label for="print-omit-gridlines">'+U("No gridlines")+'</label><br/><span id="print-include-title" class="jfk-checkbox"></span><label for="print-include-title">'+U("Include document title")+'</label><br/><span id="print-include-sheet-names" class="jfk-checkbox"></span><label for="print-include-sheet-names">'+U("Include sheet names")+'</label><br/><span id="print-include-page-numbers" class="jfk-checkbox"></span><label for="print-include-page-numbers">'+
U("Include page numbers")+"</label></div>");b=V(b);a=a+b+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header" id="dialog-paper-size-header">Paper size</div><table width="100%" role="presentation"><tr><td width="50%" valign="center" class="print-options-container">'+V('<div id="print-paper-size" class="jfk-select goog-flat-menu-button" aria-labelledby="dialog-paper-size-header"></div>')+'</td></tr></table><hr class="print-divider"/><div class="waffle-dialog-header">Layout</div>';
b='<table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr>'+('<td role="radiogroup" aria-label="'+W(ur("Layout"))+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size" id="print-fit" /><br/><label for="print-fit">'+U("Fit to width")+'<br/><div class="print-fit-icon">&nbsp;</div><div class="print-layout-caption" id="print-fit-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-size" id="print-actual-size" /><br/><label for="print-actual-size">'+
U("Actual size")+'<br/><div class="print-actual-size-icon">&nbsp;</div><div class="print-layout-caption" id="print-actual-size-caption"></div></label></td><td class="print-layout-divider-2"></td></tr></table></td>');b+='<td role="radiogroup" aria-label="'+W(ur("Orientation"))+'"><table width="100%" cellpadding=0 cellspacing=0 role="presentation"><tr><td class="print-layout-divider-3"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-portrait" /><br/><label for="print-portrait">'+
U("Portrait")+'<br/><div class="print-portrait-icon">&nbsp;</div><div class="print-layout-caption" id="print-portrait-caption"></div></label></td><td class="print-layout-divider"></td><td valign="top" align="center" class="print-layout-container" role="presentation"><input type="radio" name="print-layout-orientation" id="print-landscape" /><br/><label for="print-landscape">'+U("Landscape")+'<br/><div class="print-landscape-icon">&nbsp;</div><div class="print-layout-caption" id="print-landscape-caption"></div></label></td></tr></table></td></tr></table>';
b=V(b);return V(""+(a+b))};function wEc(a,b,c,d,e,f){hq.call(this,void 0,void 0,f);this.V=a;this.Ca=b;this.pb=d;this.ib=new cR;this.$a=e;this.fb=c;this.Ia=!1;this.C={};this.F=new xV(!0,this.Ba());this.J=new xV(!0,this.Ba());this.L=new xV(!0,this.Ba());this.O=null;a=new qq;vq(a,{key:"ok",caption:"Print"},!0);vq(a,yq,!1,!0);tq(this,a)}w(wEc,hq);var xEc={$2a:"print-repeat-row-headers",jqc:"print-omit-gridlines",ygc:"print-include-title",xgc:"print-include-sheet-names",wgc:"print-include-page-numbers"};p=wEc.prototype;
p.bW=function(){if(!this.isDisposed()){var a=this.V,b=this.F;b.isChecked("print-active-sheet")?a.C=0:b.isChecked("print-all-sheets")?a.C=1:a.C=2;this.L.isChecked("print-fit")?a.F=0:a.F=1;b=!!this.J.isChecked("print-landscape");a.O=b;b=this.C["print-repeat-row-headers"].isChecked();a.qa=b;b=this.C["print-omit-gridlines"].isChecked();a.V=b;b=this.C["print-include-title"].isChecked();a.L=b;b=this.C["print-include-sheet-names"].isChecked();a.J=b;b=this.C["print-include-page-numbers"].isChecked()?"CENTER":
"UNDEFINED";a.Z=b;b=this.O.Cf().hb();a.D=b;yEc(this);this.FHa()}};
function zEc(a){var b=a.V,c=a.F;0==b.C?zV(c,"print-active-sheet"):1==b.C?zV(c,"print-all-sheets"):zV(c,"print-selection");zV(a.L,0==b.F?"print-fit":"print-actual-size");zV(a.J,b.O?"print-landscape":"print-portrait");a.C["print-repeat-row-headers"].tc(!!b.qa);a.C["print-omit-gridlines"].tc(!!b.V);a.C["print-include-title"].tc(!!b.L);a.C["print-include-sheet-names"].tc(!!b.J);a.C["print-include-page-numbers"].tc("UNDEFINED"!=b.Z);var d=a.O;d.Hc().Jf(function(a){a.hb()==b.D&&kt(d,a)});yEc(a);Nc&&(a.Zb().style.display=
"",zba(a.getElement().offsetHeight),a.Zb().style.display="block",zba(a.getElement().offsetHeight))}
p.Orb=function(a){if("ok"==a.key){this.bW();var b=this.V;a=this.Ia&&ehc();var c=b.qa,d=!b.O,e=0==b.F,f=0==b.C,h=2==b.C,k=b.V,l=b.L,m=b.J,q=b.Z,r=new xm;r.set("size",b.D);r.set("fzr",c);r.set("portrait",d);r.set("scale",e?"2":"1");(f||h)&&r.set("gid",Xu(this.Ca));h&&(b=fv(this.Ca).Rc(),c=b.qc(),d=b.hc(),e=b.Lc(),f=b.Sc(),r.set("r1",c),r.set("c1",d),r.set("r2",e),r.set("c2",f),r.set("ir",b.ke()),r.set("ic",b.le));r.set("gridlines",!k);r.set("printtitle",l);r.set("sheetnames",m);r.set("pagenum",q);k=
new Be;l=bIa(this.Ca);for(m=0;m<l.length;m++)b=l[m],c=b.Pc().H,gv(c)&&(jv(c),q=new Ae,d=""+b.Jb(),C(q,1,d),d=chc(c),C(q,3,d),b=vh(hv(c),b.Jb()),C(q,4,b),Ac(k,1,q));Ec(k,1).length&&(l=new rh,l.rv=!0,r.set("gridFiltersProto",Uh(l.serialize(k))));null!=a&&r.set("attachment",!a);k=r.Ie();l=[];for(m=0;m<k.length;m++)l.push(k[m]+"="+r.get(k[m]));k=l.join(",");l={format:"pdf"};m=r.Ie();for(q=0;q<m.length;q++)l[m[q]]=r.get(m[q]);r=this.pb.Qf("/export");a=u(this.ib.J,this.ib,ck(Dk(r)),l,a);this.Ia&&this.fb?
(this.$a(!1),r=this.fb,lhc(r.D,r.H,khc(r),k?"id="+r.C+","+k:r.C,a)):(this.$a(!0),a())}};function yEc(a){AEc(a,a.L,"print-fit");AEc(a,a.L,"print-actual-size");AEc(a,a.J,"print-landscape");AEc(a,a.J,"print-portrait")}function AEc(a,b,c){jp(a.Ba().Ss(b.getElement(c)),"print-radio-checked",b.isChecked(c))}p.FHa=sa;
p.Sa=function(){wEc.$.Sa.call(this);ar(this,"ok");var a=this.Zb();gr(a,vEc);fp(this.getElement(),"print-dialog");var b=this.Ba();G(this.F);this.F=new xV(!0,this.Ba());yV(this.F,"whatPartsGroup",a);G(this.J);this.J=new xV(!0,this.Ba());yV(this.J,"print-layout-orientation",a);G(this.L);this.L=new xV(!0,this.Ba());yV(this.L,"print-layout-size",a);for(var c in xEc){var d=xEc[c];G(this.C[d]);a=this.C[d]=new Fr;d=b.getElement(d);a.mb(d);pr(a,d.nextSibling)}G(this.O);c=this.O=DY();c.mb(b.getElement("print-paper-size"));
MY(this,"0",'Letter (8.5" x 11")',"Letter (8.5 inches x 11 inches)");MY(this,"33",'Tabloid (11" x 17")',"Tabloid (11 inches x 17 inches)");MY(this,"2",'Legal (8.5" x 14")',"Legal (8.5 inches x 14 inches)");MY(this,"32",'Statement (5.5" x 8.5")',"Statement (5.5 inches x 8.5 inches)");MY(this,"30",'Executive (7.25" x 10.5")',"Executive (7.25 inches x 10.5 inches)");MY(this,"31",'Folio (8.5" x 13")',"Folio (8.5 inches x 13 inches)");MY(this,"6","A3 (297 mm x 420 mm)");MY(this,"7","A4 (210 mm x 297 mm)");
MY(this,"8","A5 (148mm x 210mm)");MY(this,"18","B4 (250mm x 353mm)");MY(this,"19","B5 (176mm x 250mm)");this.getHandler().R(c,"action",this.bW).R(this.F,"action",this.mGb).R(this.J,"action",this.Ryb).R(this.L,"action",this.bW).R(this,"afterhide",this.bW).R(this,"dialogselect",this.Orb)};function MY(a,b,c,d){a.O&&(b=new Tq(c,b),a.O.re(b),a=b.Zb(),d&&a&&cp(a,d))}p.Ryb=function(){this.bW()};
p.mGb=function(){var a=this.C["print-repeat-row-headers"],b=this.V;this.F.isChecked("print-selection")&&a.isChecked()?(a.tc(!1),b.H=!0):this.V.H&&(a.tc(!0),b.H=!1);this.bW()};p.show=function(a){this.Ia=a;iq(this,a?"Print settings":"Export to PDF");this.D.set("ok",a?"Print":"Export",!0);this.setVisible(!0);a=this.Ba();var b=this.Ca;Q(a.getElement("print-warning"),!1);UVa(b)?(uBc(this.F),this.F.eb("print-selection",!1),2==this.V.C&&(this.V.C=0)):uBc(this.F);zEc(this);this.FHa()};
p.Ja=function(){for(var a in this.C)G(this.C[a]);G(this.O);G(this.L);G(this.J);G(this.F);wEc.$.Ja.call(this)};function BEc(a){a=""+(CEc({id:"waffle-resize-selection-custom",TPa:a.LEa,bl:vr("<br />"+U(MBc({id:"waffle-resize-input",Ce:"waffle-resize-inset-input"})))})+CEc({id:"waffle-resize-selection-auto",TPa:ur("Fit to data"),bl:vr("")}));return V(a)}function CEc(a){return V('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+W(a.id)+'"><label for="'+W(a.id)+'" class="waffle-resize-label">'+U(a.TPa)+"</label>"+U(a.bl)+"</div>")}
function DEc(a){return V('<label for="waffle-resize-input" >'+U(a.LEa)+'</label><br /><br /><input id="waffle-resize-input" />')};function EEc(a,b,c,d,e){hq.call(this);this.Fe=a;this.O=b;var f=this.Fe.Rc().Ed();this.C=f;this.F=ub(this.Fe.dk(),function(a){return a.Ed()==f});this.J=new JO;this.L=new xV(!0);this.V=c;this.Ca=d;this.Kb=e}w(EEc,hq);var FEc={W4:"waffle-resize-selection-auto",CUSTOM:"waffle-resize-selection-custom",f1a:"waffle-resize-input",j2a:"waffle-resize-selection"};p=EEc.prototype;
p.Ga=function(){EEc.$.Ga.call(this);var a=this.F[0];if("r"==this.C){var b=a.qc();var a=a.Lc()-1,c=String(ov(b+1)),d=String(ov(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.hc(),a=a.Sc()-1,c=qv(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+qv(a)));iq(this,b);b="r"==this.C?DEc:BEc;this.Zb().appendChild(T(b,{LEa:"r"==this.C?"Enter new row height in pixels. (Default: "+(Ru+")"):"Enter new column width in pixels. (Default: "+
(QUa+")")}));ar(this,"ok")};p.Sa=function(){EEc.$.Sa.call(this);var a=this.Ba();this.J.mb(a.getElement(FEc.f1a));var a=this.Fe.Rc(),b=a.Ed(),a=PUa(WA(this.Fe,b,a.Tf(b)));this.J.gb(String(a));"c"==this.C&&(yV(this.L,FEc.j2a),zV(this.L,FEc.CUSTOM));this.getHandler().R(this,"dialogselect",this.TZb).R(this.J.getElement(),"focus",this.JFb)};p.JFb=function(){"c"==this.C&&zV(this.L,FEc.CUSTOM)};p.focus=function(){this.wc()&&this.J.Sl()};
p.TZb=function(a){if("ok"==a.key)if("r"==this.C||Xmc(this.L)==FEc.CUSTOM)a=parseInt(this.J.Za(),10),isNaN(a)?An("Entered value is not a number."):2>a||2E3<a?An("Size must be between 2 and 2000 pixels."):(this.Kb.C("r"==this.C?35310:35308),this.O.C(new TJ(this.Fe,this.F[0],a,this.F.slice(1))));else{var b=tB(this.V).Z;a=b.C;b=Bg(K(),"fecllr")?b.H:null;this.Kb.C(35307);Bqb(this.F,a,b,this.Ca,this.O)}};function GEc(a){Yh(this,a,0,-1,null)}w(GEc,Xh);GEc.prototype.getType=function(){return M(this,3)};GEc.prototype.setType=function(a){N(this,3,a)};function HEc(a){R.call(this,a);this.Z=bn("email");this.C=this.D=null}w(HEc,R);p=HEc.prototype;
p.Ga=function(){var a=this.Ba(),b=this.Ba();this.C=new lU;F(this,this.C);this.D=new lU;F(this,this.D);var c=b.Ga("DIV","waffle-dialog-notifications-input");Zo(c,"presentation");this.F=new jU;kU(this.F,b.Ga("LABEL",null,"Any changes are made"));this.F.render(c);this.C.vH(this.F);var d=b.Ga("DIV","waffle-dialog-notifications-input");Zo(d,"presentation");this.J=new jU;kU(this.J,b.Ga("LABEL",null,"A user submits a form"));this.J.render(d);this.C.vH(this.J);var e=b.Ga("DIV","waffle-dialog-notifications-input");
Zo(e,"presentation");this.H=new jU;kU(this.H,b.Ga("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.vH(this.H);var f=b.Ga("DIV","waffle-dialog-notifications-input");Zo(f,"presentation");this.L=new jU;kU(this.L,b.Ga("LABEL",null,"Email - straight away"));this.L.render(f);this.D.vH(this.L);b=b.Ga("DIV",null,b.Ga("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.Z+" when...")),b.Ga("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.Z+" when...")},c,d),b.Ga("DIV",
{style:"padding: 5px"}),b.Ga("DIV","waffle-dialog-notifications-label","Notify me with..."),b.Ga("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.Ba();d=c.Ga("DIV");this.O=hO("Save",c);this.Wa(this.O,!1);this.O.render(d);this.V=new ts("Cancel",c);this.Wa(this.V,!1);this.V.render(d);this.La=a.Ga("DIV","waffle-dialog-notifications",a.Ga("DIV",null,b),a.Ga("DIV",null,d))};
p.Sa=function(){HEc.$.Sa.call(this);this.getHandler().R(this.O,"action",this.ESb,!0).R(this.V,"action",u(this.dispatchEvent,this,new H("cancelRuleEdit"))).R(this.C,"change",this.Zva).R(this.D,"change",this.Zva)};p.Ee=function(a){HEc.$.Ee.call(this,a);a?1==a.getType()?mU(this.C,this.F):2==a.getType()&&mU(this.C,this.J):mU(this.C,null);a?2==M(a,2)?mU(this.D,this.H):1==M(a,2)&&mU(this.D,this.L):mU(this.D,null);this.Zva()};p.focus=function(){var a=nU(this.C),b=this.C.D.Bf(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};p.ESb=function(){this.dispatchEvent(new H("saveRule",IEc(this)))};function IEc(a){var b=new GEc,c=a.hb();c&&(c=M(c,1),N(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?N(b,2,1):a.H.isChecked()&&N(b,2,2);return b}p.Zva=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.eb(a)};function NY(a,b){R.call(this,b);this.Ee(a)}w(NY,R);
NY.prototype.Ga=function(){var a=this.hb(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==M(a,2)?c+="send digest email":1==M(a,2)&&(c+="send email");var c="If "+(b+(" then "+c)),d=this.Ba(),a=d.Ga("TD",null),b=d.Ga("TD",{width:"50px"}),c=d.Ga("TR",{valign:"center"},d.Ga("TD",null,d.Ga("SPAN","waffle-notification-rule",c)),d.Ga("TD",{align:"right"},d.Ga("TABLE",null,d.Ga("TBODY",null,d.Ga("TR",null,a,b))))),d=Dq(js,"waffle-notifications-add");this.D=new ls("Edit",
d,this.Ba());this.D.wg("goog-link-button");this.D.wg("menuMainLink");this.Wa(this.D,!1);this.D.render(a);this.C=new ls("Delete",d,this.Ba());this.C.wg("goog-link-button");this.C.wg("menuMainLink");this.Wa(this.C,!1);this.C.render(b);this.La=c};NY.prototype.Sa=function(){NY.$.Sa.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};NY.prototype.H=function(){this.dispatchEvent(new H("edit",this.hb()))};
NY.prototype.F=function(){var a=u(function(){this.dispatchEvent(new H("del",this.hb()))},this),b=u(function(){this.C.getElement().focus()},this);zDc("Are you sure that you want to delete this notification rule?",a,void 0,void 0,b)};function JEc(a){R.call(this,a);this.C=null}w(JEc,R);JEc.prototype.Ga=function(){var a=this.Ba();this.C=a.Ga("TBODY");this.La=a.Ga("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};JEc.prototype.Zb=g("C");JEc.prototype.setVisible=function(a){this.getElement()&&Q(this.getElement(),a)};function KEc(a,b,c){hq.call(this);this.Ca=a;this.L=b;iq(this,"Set notification rules");pq(this,!1);a=new qq;a.set("cancel","Done",!1,!0);tq(this,a);this.C=new HEc(c);this.Wa(this.C,!1);this.F=new JEc;this.Wa(this.F,!1);this.J=new ls("Add another notification rule",mJ.getInstance(),this.Ba());this.Wa(this.J,!1)}w(KEc,hq);p=KEc.prototype;
p.Ga=function(){KEc.$.Ga.call(this);var a=this.Ba(),b=b0a(this.Ca,new om(Rqa+"91588")).toString(),b=a.Ga("A",{target:"_blank",href:b},"Help"),c=a.Ga("DIV");this.J.render(c);this.V=a.Ga("DIV");this.O=a.Ga("DIV");var d=a.Ga("DIV","waffle-dialog-notifications-bounds",this.V,this.O),b=a.Ga("DIV",null,a.Ga("DIV",{align:"right"},b),d,c);a.appendChild(this.Zb(),b);ar(this,"")};
p.Sa=function(){KEc.$.Sa.call(this);this.F.render(this.V);this.C.render(this.O);this.getHandler().R(this,"edit",this.b_b).R(this,"del",this.a_b).R(this.J,"action",this.$Zb).R(this,"saveRule",this.DSb).R(this,"cancelRuleEdit",this.M6a)};p.s2=function(a){this.isDisposed()||(this.C.setVisible(!1),LEc(this,!1),Oj(this.L,"/notifications/list",u(this.CWb,this,a)).$e())};
p.CWb=function(a,b,c){if(!this.isDisposed()){b=c.og();c=[];for(var d=0;d<b.length;d++)c[d]=new GEc(b[d]);this.Ee(c);if(a&&0==c.length)MEc(this,null,!1);else{if(a=this.hb())if(b=this.F,b.Gd(!0),b.Ba().Gd(b.Zb()),b.Ee(a),c=b.Ba(),0==a.length)c.appendChild(b.Zb(),c.Ga("TR",null,c.Ga("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Wa(new NY(a[d],c),!0);LEc(this,!0);this.focus()}}};
p.DSb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();M(a,1)?Rj(Oj(this.L,"/notifications/set",u(this.s2,this,!1)),{rule:b}).$e():Rj(Oj(this.L,"/notifications/create",u(this.s2,this,!1)),{rule:b}).$e()};p.M6a=function(){this.C.setVisible(!1);this.s2(!1)};p.b_b=function(a){MEc(this,a?a.target:null,!0)};p.$Zb=function(){MEc(this,null,!0)};function MEc(a,b,c){LEc(a,!1);var d=a.C;d.Ee(b);d.setVisible(!0);c&&a.C.focus()}
p.a_b=function(a){this.F.setVisible(!1);a=a.target;Rj(Oj(this.L,"/notifications/delete",u(this.s2,this,!1)),{rule_id:M(a,1)}).$e()};function LEc(a,b){a.F.setVisible(b);var c=mq(a);Q(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.s2(!0)};function NEc(a){var b="",c='Display language: <a id="ds-settings-link" target="_blank">'+(U(a.a9a)+"</a>"),b=b+('<tr class="dialog-settings-general-settings-div"><div><span>'+c+"</span></div>");a.wUb&&(b+='<div class="dialog-settings-english-name-div">'+U(Er({id:"waffle-settings-dialog-english-name-checkbox"}))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');return V(b+"</tr>")}
function OEc(){return V('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function OY(a,b,c,d){hq.call(this);this.Xb=a;this.dd=b;this.L=c;this.Kb=d;this.C={};this.Qb=this.zb=!1;this.zc=this.Ub=this.Mb="";this.Kc=new rh;this.J=[];this.F=this.Kc.cd((new Kf).Ra(),ritz_api.RitzModelApi.getWorkbookProperties());iq(this,"Settings for this spreadsheet");this.pb=!1;this.fb=new Fr;this.Wa(this.fb);this.V=new QS;this.Wa(this.V);this.O=new QS;this.Wa(this.O);this.Ib=new DT;this.Wa(this.Ib);this.$a=this.ib=null;this.kc=new Ln(1);this.Ca=this.Ia="";this.C[0]=DY();this.C[1]=DY();this.C[2]=
DY();this.C[3]=DY();this.C[4]=new JO;this.C[5]=new JO}w(OY,hq);var PEc=null,PY={a6:0,U3a:1,lZa:2,q1a:3,I1a:4,h_a:5},QEc={q4a:"waffle-settings-dialog-english-name-checkbox",r4a:"waffle-settings-dialog-english-name-checkbox-label"},REc=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],SEc=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=OY.prototype;
p.Ga=function(){OY.$.Ga.call(this);var a=this.Zb(),b=this.Ba(),c=[QY(b,"Locale","waffle-settings-label-locale"),RY(this,b,"This affects formatting details such as functions, dates and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),TEc(this),QY(b,"Time zone","waffle-settings-label-timezone"),RY(this,b,"Your spreadsheet's history will be recorded in this time zone. This will change all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
TEc(this)],d=[];d.push(QY(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(RY(this,b,"This affects how often NOW, TODAY, RAND and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(TEc(this));d.push(QY(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=b0a(this.L,new om(Rqa+"58515")).toString(),e=b.Ga("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(RY(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=QY(b,"Max. number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=RY(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");UEc(e);d.push(e);this.J.push(e);e=QY(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=RY(this,b,
"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");UEc(e);d.push(e);this.J.push(e);"OFF"==this.C[3].Cf().Za()&&VEc(this);d.push(TEc(this));c=Mb(c,d);c.push(T(NEc,{a9a:this.Ub,wUb:this.pb}));this.ib=b.Ga("TABLE","dialog-settings",b.Ga("TBODY",null,c));this.$a=b.Ga("table","dialog-settings",b.Ga("tbody",null,d));c=T(OEc);b.appendChild(a,c);this.Ib.mb(c);b.appendChild(a,
this.ib);b.appendChild(a,this.$a);Q(this.$a,!1);PEc||(a=new qq(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),PEc=a);tq(this,PEc);SY(this,4,yc(this.F,3)&&B(this.F,3).bba()?B(this.F,3).e$().toString():"50");SY(this,5,yc(this.F,3)&&B(this.F,3).Zaa()?B(this.F,3).P9().toString():"0.05");ar(this,"save")};function UEc(a){a=a.firstChild.firstChild;fp(a,"jfk-textinput");np(a,"width","7em")}function VEc(a){for(var b=0;b<a.J.length;b++)Q(a.J[b],!1)}
function QY(a,b,c){return a.Ga("TR",null,a.Ga("TD",{id:c,"class":"dialog-settings-label"},b))}function RY(a,b,c,d,e,f,h){b=b.Ga("TR",null,b.Ga("TD","dialog-settings-input"),b.Ga("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.La;$o(a,"labelledby",e);$o(a,"describedby",f);return b}function TEc(a){a=a.Ba();return a.Ga("TR",null,a.Ga("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.Ga("HR",{"class":"dialog-settings-sep"})))}
p.Sa=function(){OY.$.Sa.call(this);dd(this,"dialogselect",u(this.q_b,this));this.getHandler().R(this.C[3],"action",this.KUb);this.getHandler().R(this.Ib,"select",this.pEb);var a=this.C[4].getElement();this.V.Lj(a);$S(this.V,a,a);this.V.render();ZS(this.V);this.getHandler().R(a,"change",u(this.ZWb,this));a=this.C[5].getElement();this.O.Lj(a);$S(this.O,a);this.O.render();ZS(this.O);this.getHandler().R(a,"change",u(this.YWb,this));if(this.pb){var a=this.Ba().getElement(QEc.q4a),b=this.Ba().getElement(QEc.r4a);
this.fb.mb(a);pr(this.fb,b);this.fb.tc(!Ara||Y_a(this.L.F))}};p.setVisible=function(a){if(a){if(!this.zb){WEc(this);return}var b=this.L.L;SY(this,0,b.C);b=b.D||Gtb().name();SY(this,1,b);SY(this,2,yc(this.F,3)&&B(this.F,3).kpa()?B(this.F,3).Xla().toString():"");SY(this,3,yc(this.F,3)&&yc(B(this.F,3),1)?B(B(this.F,3),1)?"ON":"OFF":"OFF")}OY.$.setVisible.call(this,a);if(this.zb&&!this.Qb){if(a=Al("ds-settings-link"))a.href=this.Mb;this.Qb=!0}};
function WEc(a){Qj(a.dd.Qf("/info/settings").Wf(XEc()),u(function(a){a=a.og();(a={locale:a.l?this.uL(a.l):null,LWa:a.tz?this.uL(a.tz):null,i9a:a.dls,rJb:a.dln,WWb:a.hl},a.locale)&&a.LWa&&(YEc(this,0,a.locale),YEc(this,1,a.LWa),YEc(this,2,REc),YEc(this,3,SEc),this.Mb=a.i9a,this.Ub=a.rJb,this.zc=a.WWb,this.pb=Ara&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.zc),this.zb=!0);this.setVisible(!0)},a)).$e()}
function XEc(){var a=Cm(bn("win").location.href),b=Am(a,"hl"),a=Am(a,"forcehl");return["hl",b,"forcehl",a]}function YEc(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d],e=new Tq(e.caption,e.value);a.re(e);Zo(e.getElement(),"menuitem")}a.Hc().getElement().style.overflow="auto";dO(a,!0)}p.uL=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function SY(a,b,c){(a=a.C[b])&&a.gb(c)}
p.q_b=function(a){if("save"==a.key)if("ON"!=this.C[3].Cf().Za()||""==this.Ia&&""==this.Ca){ZEc(this);a=this.L.L.C;this.Xb.C($Ec(this));this.Xb.C(aFc(this));if(this.pb){var b=!Ara||Y_a(this.L.F);var c=this.fb.isChecked();b!=c?(f0a(this.L,c),b=qi(new pi,1).build(),this.Kb.fc(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].Cf(),c=null!=c&&c.Za()!=a);c&&gDa(this.L.D.C,this.p_b)}else a.preventDefault(),ZEc(this),""!=this.Ia&&XS(this.V,this.Ia,!0),""!=this.Ca&&XS(this.O,this.Ca,!0)};
p.KUb=function(a){if("ON"==a.target.Za())for(a=0;a<this.J.length;a++)Q(this.J[a],!0);else VEc(this);ZEc(this)};function ZEc(a){ZS(a.V);ZS(a.O)}p.ZWb=function(){this.Ia="";var a=this.C[4].Za()||"",a=this.kc.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Ia="Please enter an integer value.";else if(0>=a||1E4<a)this.Ia="Please enter a value between 1 and 10000."};p.YWb=function(){this.Ca="";var a=this.C[5].Za()||"",a=this.kc.parse(a);isNaN(a)?this.Ca="Please enter a numeric value.":0>a&&(this.Ca="Please enter a non-negative value.")};
p.pEb=function(a){switch(a.target.getId()){case "general-settings-tab":Q(this.ib,!0);Q(this.$a,!1);break;case "calculation-settings-tab":Q(this.ib,!1),Q(this.$a,!0)}};function $Ec(a){var b=a.C,c=b[PY.lZa].Cf().Za(),d=b[PY.q1a].Cf().Za();a=b[PY.I1a].Za()||"";var b=b[PY.h_a].Za()||"",e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new vK(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function aFc(a){var b=a.C;a=a.L.L;var c=b[PY.a6].Cf(),c=null==c?a.C:c.Za(),b=b[PY.U3a].Cf(),b=null==b?a.D||Gtb().name():b.Za();return new atb(c,b)}p.p_b=function(){(new nub).exec()};p.Ja=function(){$b(this.C,G);delete this.C;OY.$.Ja.call(this)};function bFc(a,b,c,d,e,f,h){hq.call(this,void 0,!1,h);this.J=this.F=this.O=this.L=null;this.Ca=a;this.Fe=b;this.C=[];this.V=new Y7b(a,d,e,f)}la(bFc,hq);p=bFc.prototype;
p.Ga=function(){hq.prototype.Ga.call(this);var a=this.Ba(),b=this.Fe.Rc(),c=xv(b.Te()),d=xv(new Mg(b.left+b.width-1,b.top+b.height-1));iq(this,"Sort range from "+(c+(" to "+d)));cFc||(c=new qq,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),cFc=c);tq(this,cFc);ar(this,"save");var e,c=a.Ga("DIV",{style:"overflow: hidden"},d=a.Ga("SPAN","jfk-checkbox"),e=a.Ga("SPAN",{style:"cursor: default"},"Data has header row")),f=this.J=new Fr(void 0,a);f.mb(d);pr(f,e);1==b.height&&f.eb(!1);lv(this.Ca,this.Fe.vc(),
b)||(f.tc(!0),f.eb(!1));hsa&&ritz_api.TablesApi.getTables((new rh).serialize(vh(b,this.Fe.vc())),u(function(a){if(0<a.length){var c=a[0];a=bWb(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c))c=th(a),c=1==c.Qg()-c.Tf();c&&(c=vh(b,this.Fe.vc()),c=a.Jb()==c.Jb()&&DBc(th(a),th(c))&&DBc(uh(a),uh(c)));c&&f.tc(!0)}},this));d=this.Zb();a.appendChild(d,c);this.L=a.Ga("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.Ga("TABLE",{cellSpacing:"0"},this.O=
a.Ga("TBODY")));a.appendChild(d,this.L);c=dFc(this);this.C.push(c);c=a.Ga("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);am(c,!0);Zo(c,"button");this.F=c};p.Sa=function(){hq.prototype.Sa.call(this);Pf(this.getHandler().R(this,"dialogselect",this.dKb),this.F,gd,this.blb).R(this.J,"change",this.Btb)};
function dFc(a){var b=a.Ba(),c=0==a.C.length,d=new eFc(a,c,a.Fe,0,b),e=b.Ga("TR",null,b.Ga("TD",{colspan:"4"},b.Ga("DIV","waffle-sd-row-separator")));d.render(a.O);b.appendChild(a.O,e);c||Pf(a.getHandler(),d.D,gd,u(a.B8a,a,d));a=fFc(a);gFc(d,a);return d}p.B8a=function(a){var b=this.C;if(1<b.length){var c=rb(b,a);-1!=c&&(Lb(b,c),b=a.getElement(),b=Ul(b),a.dispose(),Ql(b),Q(this.F,!0),this.F.focus(),Bn("Sort criteria removed."))}};
function fFc(a){var b=a.Fe.Rc(),c=b.hc(),b=b.Sc(),d=vb(a.C,function(a){return a.Kq()},a);if(d)for(var e=nB(a.Fe,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=pB(a.Fe,f);if(!Db(d,h))return h}return null}p.Btb=function(){for(var a=this.C,b=0;b<a.length;b++)gFc(a[b])};p.blb=function(){var a=lh(this.Fe.Rc(),"c"),a=Math.max(10,a);this.C.length<a&&(this.C.push(dFc(this)),Bn("Sort criteria added."));zp(qb(this.C).getElement(),this.L,!0);this.L.scrollLeft=0;this.C.length>=a&&Q(this.F,!1)};
p.dKb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.C,d=0;d<c.length;d++){var e=c[d];a.push(e.Kq());e=e.F.isChecked();b.push(e?1:0)}c=this.Fe.Rc();d=lh(c,"r");if(this.J.isChecked()&&1<d){var d=c.qc()+1,e=c.hc(),f=c.Lc(),h=c.Sc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new o8b(a,b,this.Fe,c,this.J.isChecked());Z7b(this.V,this.Fe,a)}};p.Ja=function(){hq.prototype.Ja.call(this);Ic(this.C)};var cFc=null;
function eFc(a,b,c,d,e){R.call(this,e);this.H=this.J=this.F=this.C=this.D=null;this.O=-1;this.V=a;this.L=b;this.Fe=c}la(eFc,R);eFc.prototype.Kq=function(){var a=this.C.Cf();return a?a.Za():-1};
eFc.prototype.Ga=function(){var a=this.Ba(),b=this.L?"sort by":"then by",c,d,e,f=a.Ga("TR","waffle-sd-tr-rules",a.Ga("TD","waffle-sd-delete",this.L?"":this.D=a.Ga("SPAN",{title:"Remove sort criteria."},"x")),a.Ga("TD","waffle-sd-td-rules",a.Ga("LABEL",{id:aq(this,"csl")},b)),b=a.Ga("TD","waffle-sd-column-selector"),a.Ga("TD","waffle-sd-td-ascending",e=a.Ga("DIV",null,c=a.Ga("DIV",{title:"Ascending"}),d=a.Ga("DIV",{title:"Descending"}))));Zo(e,"radiogroup");e=this.F=new jU(a,lm(a,hn(Hu(!0,this.Pf()))),
"ascending");e.render(c);a=this.J=new jU(a,lm(a,hn(Hu(!1,this.Pf()))),"descending");a.render(d);this.H=new lU([e,a]);mU(this.H,e);a=this.C=DY();a.render(b);$o(a.getElement(),"label",this.L?"Select first column to sort by:":"Select next column to sort by:");this.D&&(am(this.D,!0),Zo(this.D,"button"),cp(this.D,"Remove sort criteria."));this.La=f};
function gFc(a,b){var c=a.Ba(),d=a.V.J.isChecked(),e=a.Fe.Rc(),f=e.qc(),h=e.hc(),e=e.Sc();a.O=b||a.Kq();for(b=a.C.Lk();0<b;b--)a.C.rC(0);for(;h<e;h++)b=cb(vA(a.Fe.If(f,h)),25),b=new Tq(Va(b)||!d?"Column "+qv(h):b,pB(a.Fe,h),c),b.wg("waffle-sd-menu-item"),a.C.re(b);a.C.Vf(0);0<=a.O&&a.C.gb(a.O)}eFc.prototype.Ja=function(){R.prototype.Ja.call(this);this.C=this.D=this.Fe=this.V=null;G(this.F);G(this.J);G(this.H);this.H=this.J=this.F=null};Qc&&Wc("2");Nc&&Wc("9.0")&&Wc("10.0");function hFc(a){return V('<input type="text" id="docs-copy-link" class="docs-copy-link" value="'+W(a.link)+'" readonly="readonly">')};function TY(a,b,c,d){Gr.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Ia="";this.F=b||null;this.Ca=c||new gob(a);this.V=null!=d?d:null;a=new qq;vq(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.Ca.C()&&vq(a,{key:"copy-link",caption:"Copy link"});tq(this,a)}w(TY,Gr);p=TY.prototype;
p.Ga=function(){TY.$.Ga.call(this);fp(nq(this),"copy-link-dialog");fp(uq(this.D,"done"),"copy-link-done-button");this.C=T(hFc,{link:this.Ia},void 0,this.Ba());$o(this.C,"label","Link to this comment");this.Zb().appendChild(this.C);if(this.L=uq(this.D,"copy-link")){var a=Il("DIV");fp(a,"copy-link-butter-holder");this.getElement().insertBefore(a,lq(this));this.O=new Kr(a);this.J=Mr("Link copied to clipboard.","info",!1,4E3)}null!==this.V&&(np(this.Ix(),"z-index",this.V),np(nq(this),"z-index",this.V+
1))};p.zo=function(){TY.$.zo.call(this);this.F&&this.getHandler().R(this.F,"copy",this.eGa);this.C.focus();this.C.select()};p.Wq=function(){TY.$.Wq.call(this);this.F&&this.getHandler().Oc(this.F,"copy",this.eGa)};p.Sa=function(){TY.$.Sa.call(this);this.getHandler().R(this.C,"click",this.XSb);this.L&&this.getHandler().R(this.L,"click",this.Tob)};p.FTb=function(a){this.Ia=a;this.C&&(this.C.value=a)};p.XSb=function(a){a.target.focus();a.target.select()};
p.Tob=function(a){a.stopPropagation();this.F&&this.Ca.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.eGa=function(a){a.C&&this.J&&this.O&&(this.J.kb()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Ja=function(){TY.$.Ja.call(this);G(this.J);delete this.J;delete this.L;delete this.C};function iFc(){E.call(this)}w(iFc,jn);p=iFc.prototype;p.ogb=function(){return xDc};p.Egb=function(){return zDc};p.WKb=function(a,b,c,d){var e=new cr;a=new $q(a,b,c,d,void 0,!0,void 0);ar(a,"ok");b=u(e.mb,e);a.Wpa=b;F(a,e);a.Dj=!0;a.X$=Xfa(Va);return a};p.nib=function(){return EEc};p.l8a=function(a,b,c,d,e){return new bFc(a,b,0,c,d,e,void 0)};p.Ngb=function(){return YDc};p.QIa=function(){return dEc};p.fhb=function(){return nEc};p.i8a=function(a,b,c,d){return new wEc(a,b,c,d,sa,void 0)};p.sib=function(){return OY};
p.rib=function(){return vDc};p.qib=function(){return KEc};p.Igb=function(){return rY};p.oib=function(){return XBc};p.pib=function(){return vCc};p.Hgb=function(){return TY};wn("dialogs",iFc);
