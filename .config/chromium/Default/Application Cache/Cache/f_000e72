$U.prototype.XUa=fa(252,function(a){this.J=Pb(arguments,0)});function RV(a,b){return B(a,2,b)}function koc(a,b,c,d,e){return Nxb(a,u(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function SV(a){Yh(this,a,0,-1,null)}w(SV,Xh);function TV(a){Yh(this,a,0,-1,null)}w(TV,Xh);var loc=[3],moc=[1],noc=[1],ooc=[1],poc=[1,2],qoc=[2];function roc(a){return lc(wlc,function(b){return b.match(a)}).getName()}function soc(a){Yh(this,a,0,-1,null)}w(soc,Xh);
soc.prototype.Lf=function(){return M(this,2)};function toc(a){Yh(this,a,0,-1,null)}w(toc,Xh);toc.prototype.getChartType=function(){return M(this,1)};function uoc(a){Yh(this,a,0,-1,null)}w(uoc,Xh);function voc(a){Yh(this,a,0,-1,loc)}w(voc,Xh);voc.prototype.getChartType=function(){return M(this,1)};function woc(a){Yh(this,a,0,-1,moc)}w(woc,Xh);function xoc(a){Yh(this,a,0,-1,noc)}w(xoc,Xh);function yoc(a){Yh(this,a,0,-1,ooc)}w(yoc,Xh);function zoc(a){Yh(this,a,0,-1,poc)}w(zoc,Xh);
var Aoc={fyc:0,rBa:1,OBa:2};function Boc(a){Yh(this,a,0,-1,qoc)}w(Boc,Xh);
var Coc={qyc:0,SUM:1,AVERAGE:2,vza:3,Syc:4,zwc:5,MEDIAN:6,COUNT:7,bwc:8,cwc:9},Doc={UNKNOWN_ERROR:0,Fyc:1,zpc:2,Cbc:3},Eoc={uyc:0,Rbc:1,Ifa:2,nk:3,lyc:4,Q3b:5,mdc:6},Foc={ryc:0,rE:1,Fpc:2,lpc:3,Trc:4},Goc={myc:0,Bpc:1,YJ:2,Lmc:3},Hoc={dyc:0,Pxc:1,Rfc:2,Owc:3,Nwc:4,W6b:5,Cnc:6},Ioc={Rvc:0,$J:1,WZa:2,Lxc:3,Duc:4,u2a:5,Eyc:6,Qya:7,Owa:8,txa:9,HISTOGRAM:10},Joc={UNKNOWN:0,G3b:1,F3b:2,E3b:3,M4b:4,w6b:5,Q6b:6,o$b:7,scc:8,joc:9,esc:10,osc:11,dwc:12,fwc:13,sxc:14,Grc:15};function UV(){A.call(this)}w(UV,A);var Koc=null;UV.prototype.xm=function(){return B(this,1)};function VV(){A.call(this)}w(VV,A);var Loc=null;VV.prototype.getText=function(){return B(this,1)};VV.prototype.Pr=function(){return yc(this,1)};function WV(){A.call(this)}w(WV,A);var Moc=null;WV.prototype.getStatus=function(){return B(this,1)};WV.prototype.getError=function(){return B(this,9)};function XV(){A.call(this)}w(XV,A);var Noc=null;function YV(){A.call(this)}w(YV,A);var Ooc=null;
function ZV(){A.call(this)}w(ZV,A);var Poc=null;ZV.prototype.cba=function(){return yc(this,1)};ZV.prototype.getType=function(){return B(this,3)};ZV.prototype.setType=function(a){C(this,3,a)};function $V(){A.call(this)}w($V,A);var Qoc=null;function aW(){A.call(this)}w(aW,A);var Roc=null;
UV.prototype.Ra=function(){var a=Koc;a||(Koc=a=Gc(UV,{0:{name:"Error",Ob:"ritz.assistant.Error"},1:{name:"message",Ma:9,type:String},2:{name:"code",Ma:14,defaultValue:0,type:Doc},3:{name:"unsupported_op_reason",Ma:14,defaultValue:0,type:Eoc}}));return a};UV.Ra=UV.prototype.Ra;
VV.prototype.Ra=function(){var a=Loc;a||(Loc=a=Gc(VV,{0:{name:"AnswerQueryPhrase",Ob:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ma:9,type:String},2:{name:"start_byte",Ma:5,type:Number},3:{name:"num_bytes",Ma:5,type:Number}}));return a};VV.Ra=VV.prototype.Ra;
WV.prototype.Ra=function(){var a=Moc;a||(Moc=a=Gc(WV,{0:{name:"AnswerResponse",Ob:"ritz.assistant.AnswerResponse"},1:{name:"status",Ma:5,type:Number},10:{name:"parse_status",Ma:14,defaultValue:0,type:Foc},11:{name:"answer_status",Ma:14,defaultValue:0,type:Goc},2:{name:"formula",Ma:9,type:String},3:{name:"debug_parse_response",Ma:9,type:String},4:{name:"interpretation",Ma:9,type:String},5:{name:"debug_interpretation_response",Ma:9,type:String},6:{name:"unused_phrase",Wc:!0,Ma:11,type:VV},7:{name:"used_entity_phrase",
Wc:!0,Ma:11,type:VV},8:{name:"unused_entity_phrase",Wc:!0,Ma:11,type:VV},9:{name:"error",Ma:11,type:UV},12:{name:"alternate_suggestion",Wc:!0,Ma:11,type:ZV},14:{name:"deprecated_formula_builder_used",Ma:9,type:String},15:{name:"answer_visualization_type",Wc:!0,Ma:14,defaultValue:0,type:Ioc},16:{name:"formula_builder_used",Ma:14,defaultValue:0,type:Joc},17:{name:"charting_info",Ma:11,type:YV},18:{name:"answer_field_info",Wc:!0,Ma:11,type:XV},19:{name:"charting_formula",Ma:9,type:String},21:{name:"parse_info",
Wc:!0,Ma:11,type:$V}}));return a};WV.Ra=WV.prototype.Ra;XV.prototype.Ra=function(){var a=Noc;a||(Noc=a=Gc(XV,{0:{name:"AnswerFieldInfo",Ob:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ma:14,defaultValue:0,type:Cea},2:{name:"range_ref",Ma:9,type:String}}));return a};XV.Ra=XV.prototype.Ra;
YV.prototype.Ra=function(){var a=Ooc;a||(Ooc=a=Gc(YV,{0:{name:"ChartingInfo",Ob:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Wc:!0,Ma:14,defaultValue:0,type:Ioc},2:{name:"recommended",Ma:8,type:Boolean},3:{name:"user_requested_type",Wc:!0,Ma:14,defaultValue:0,type:Ioc},4:{name:"show_only_chart",Ma:8,type:Boolean}}));return a};YV.Ra=YV.prototype.Ra;
ZV.prototype.Ra=function(){var a=Poc;a||(Poc=a=Gc(ZV,{0:{name:"QuerySuggestion",Ob:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ma:9,type:String},2:{name:"formula",Ma:9,type:String},3:{name:"type",Ma:14,defaultValue:0,type:Hoc},4:{name:"deprecated_formula_builder_used",Ma:9,type:String},5:{name:"formula_builder_used",Ma:14,defaultValue:0,type:Joc}}));return a};ZV.Ra=ZV.prototype.Ra;
$V.prototype.Ra=function(){var a=Qoc;a||(Qoc=a=Gc($V,{0:{name:"ParseInfo",Ob:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Wc:!0,Ma:11,type:aW}}));return a};$V.Ra=$V.prototype.Ra;aW.prototype.Ra=function(){var a=Roc;a||(Roc=a=Gc(aW,{0:{name:"IntentInfo",Ob:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ma:14,defaultValue:0,type:Coc}}));return a};aW.Ra=aW.prototype.Ra;function bW(a,b,c,d,e,f){H.call(this,a,b);this.C=b;this.qa=c;this.Z=d||null;this.Pa=e||null;this.F=f||null}w(bW,H);bW.prototype.yk=g("qa");bW.prototype.Te=g("Z");function Soc(a,b,c,d,e,f){bW.call(this,"pe",null,d,e,f);this.J=a;this.L=b;this.xc=c}w(Soc,bW);Soc.prototype.Rd=g("xc");function Toc(a,b,c){bW.call(this,"se",null,2859);this.J=a;this.L=b;this.V=c}w(Toc,bW);function Uoc(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(Pm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(Pm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function cW(){}w(cW,mJ);ta(cW);cW.prototype.Fc=n("waffle-assistant-link-button");function Voc(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function Woc(a,b){R.call(this,b);this.D=a;this.C=new ls("",new cW,this.Ba());this.Wa(this.C)}w(Woc,R);p=Woc.prototype;p.Ga=function(){this.La=T(Voc)};p.Sa=function(){Woc.$.Sa.call(this);var a=this.bb("waffle-assistant-feedback-card-link");this.C.mb(a);this.getHandler().R(this.La,"mousedown",this.Rg).R(this.C,"action",this.Yrb);this.show(!1)};p.Rg=function(a){a.stopPropagation()};
p.show=function(a){var b=this.La,c=this.bb("waffle-assistant-feedback-card-link");jp(b,"waffle-assistant-feedback-card-hidden",!a);am(c,a)};p.Yrb=function(){P.Jy.Ec({source:this.D});this.show(!1);this.dispatchEvent(new H("feedback-dialog-opened"))};function dW(){}w(dW,js);ta(dW);dW.prototype.Fc=n("waffle-assistant-button");function eW(a,b,c,d){a&&(t(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Xa(b),rs(a,b,d),qic(a),a.setAttribute("data-tooltip-delay",500),QVb(a,t(c)?c:1))};function Xoc(){var a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Jt({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Jt({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function fW(a){R.call(this,a);this.C=new ls("",new dW,this.Ba());this.Wa(this.C);this.D=new ls("",new dW,this.Ba());this.Wa(this.D)}w(fW,R);fW.prototype.Ga=function(){this.La=T(Xoc)};fW.prototype.Sa=function(){fW.$.Sa.call(this);var a=this.bb("waffle-assistant-thumbs-down-button");this.C.mb(a);eW(a,"Not useful");a=this.bb("waffle-assistant-thumbs-up-button");this.D.mb(a);eW(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function Yoc(a,b){a.Ba().Df(a.bb("waffle-assistant-thumbs-text"),b)}fW.prototype.F=function(){this.dispatchEvent(new H("thumbs-down"));Q(this.La,!1)};fW.prototype.H=function(){this.dispatchEvent(new H("thumbs-up"));Q(this.La,!1)};function gW(a,b){var c=this;R.call(this,b);this.D=a;this.V=this.O=this.qa=null;this.fb=new lV(!0,"#4285f4");this.Wa(this.fb);this.ib=this.Mb=this.kc=!1;this.Oa=new Fk(function(){c.Oa.stop();c.La.parentNode.querySelector(":hover")==c.La?c.Oa.start():c.sT()},100);F(this,this.Oa);this.dd=this.Ib=!1}w(gW,R);p=gW.prototype;p.cE=Rf;p.eba=Sf;p.hM=Tf;p.gM=Tf;p.w$=Tf;p.Qma=Tf;p.Pma=Tf;p.hf=da("dd");p.Fd=g("dd");p.Doa=sa;p.Ga=function(){this.La=T(Uoc)};
p.Sa=function(){gW.$.Sa.call(this);var a=this.bb("waffle-assistant-card-spinner-container");this.fb.render(a);np(this.bb("waffle-assistant-card-inner"),"visibility","hidden");if(this.cE()){var a=this.La,b=new mp(a);F(this,b);this.getHandler().R(b,"focusin",this.Umb).R(b,"focusout",this.Tmb).R(a,"mouseenter",this.g1).R(a,"mouseleave",this.sT)}Zoc(this,!1);Pm&&(this.V=new Woc(this.kG(),this.Ba()),this.V.render(this.bb("waffle-assistant-card-feedback-container")),this.getHandler().R(this.V,"feedback-dialog-opened",
this.Zrb).R(this,"trigger_feedback",this.sWb),this.eba()?(this.O=new fW(this.Ba()),this.O.render(this.bb("waffle-assistant-thumbs-container")),$oc(this,!0),a=ib(this.w$()),Va(a)||Yoc(this.O,a),a=ib(this.Qma()),Va(a)||eW(this.O.bb("waffle-assistant-thumbs-up-button"),a),a=ib(this.Pma()),Va(a)||eW(this.O.bb("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.O,"thumbs-down",this.M0b).R(this.O,"thumbs-up",this.N0b)):$oc(this,!1));this.DI()};
function hW(a){return a.bb("waffle-assistant-card-content-container")}function apc(a){a.cE();return a.bb("waffle-assistant-card-options")}function $oc(a,b){Pm&&Q(a.bb("waffle-assistant-thumbs-container"),a.eba()&&b)}p.JK=function(){this.isDisposed()||(this.kc=!0,bpc(this))};function cpc(a,b){!a.Mb&&b&&(a.Mb=!0,bpc(a))}function bpc(a){if(a.kc&&a.Mb){var b=u(a.L0b,a);a.OI(b)}}p.g1=function(){this.ib||(Zoc(this,!0),this.ib=!0,this.Oa.start())};p.sT=function(){Zoc(this,!1);this.ib=!1};
p.Umb=function(){Zoc(this,!0)};p.Tmb=function(){var a=this,b=new Fk(function(){Xl(a.La,document.activeElement)||a.La.parentNode.querySelector(":hover")==a.La||Zoc(a,!1)},0);F(this,b);b.start()};p.M0b=function(){dpc(this,!0);$oc(this,!1);var a=this.gM();this.dispatchEvent(new bW("ue",this,a))};p.N0b=function(){$oc(this,!1);var a=this.hM();this.dispatchEvent(new bW("ue",this,a))};p.Zrb=function(){dpc(this,!1)};p.sWb=function(){dpc(this,!0)};
function Zoc(a,b){var c=a.bb("waffle-assistant-card-options");a=a.cE();Q(c,a&&b)}p.L0b=function(){this.fb.setActive(!1);Q(this.fb.La,!1);np(this.bb("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new H("content-rendered"))};function dpc(a,b){jp(a.bb("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.V.show(b)};function epc(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(ss({Ce:"waffle-assistant-section-more-button",content:vr("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function fpc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function gpc(){var a=V;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+U(fpc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here at the moment</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=V(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function hpc(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(ss({Ce:"waffle-assistant-panel-back-button",content:vr(""+U(Jt({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function iW(a){R.call(this,a);this.dd=new lV(!1,"#4285f4");this.Wa(this.dd);this.L=new R(this.Ba());this.Wa(this.L);this.C=[];this.We=this.Ye=!1;this.Id=this.Bd=this.Ib=this.Z=null;this.kc=new ts("",a,4);Pq(this.kc,2,!1);this.Wa(this.kc)}w(iW,R);var ipc={defaultHelpArticleId:"6280499"};p=iW.prototype;p.Ga=function(){iW.$.Ga.call(this);this.La=T(gpc);this.Bd=this.bb("waffle-assistant-panel-content-container");this.Id=this.bb("waffle-assistant-empty-list")};
p.Sa=function(){iW.$.Sa.call(this);var a=this.bb("waffle-assistant-spinner-container");this.dd.render(a);this.L.mb(this.bb("waffle-assistant-panel-card-holder"));this.kc.mb(this.bb("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.kc,"action",this.O0b).R(this.La,"scroll",Bic(this.nYa,10,this))};p.setVisible=function(a){var b=this;Q(this.La,a);y(this.C,function(a){if(!a.wc()){var c=b.L.kd();a.qa=c;b.L.Wa(a,!0);a.JK()}});this.Ye=a};
p.ata=function(a,b){var c=this.Ba();this.Z&&this.v8();this.Z=new R;this.Wa(this.Z);a=gr(a,hpc,{title:b});this.Ib=new ts("",this.Ba());this.Z.Wa(this.Ib);this.Ib.mb(c.bb("waffle-assistant-panel-back-button",a));eW(this.Ib.La,"Back");this.Z.getHandler().R(this.Ib,"action",this.lmb)};p.v8=function(){this.Z.dispose();this.Z=null};function jpc(a,b){a.dd.setActive(b);Q(a.bb("waffle-assistant-panel-pane"),!b)}p.oI=function(a){Q(this.Id,a);Q(this.Bd,!a)};
function kpc(a,b){Kb(a.C,b);a.L.removeChild(b);a.L.Zh(b,0);a.C.push(b)}p.aI=function(a){Kb(this.C,a);-1!=dq(this.L,a)&&this.L.removeChild(a,!0)};p.HZ=function(){this.L.Gd(!0);Ic(this.C);this.C=[]};p.nYa=function(){for(var a=this.La,a=a.scrollTop+Fp(a).height,b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(cpc(d,!0),b+=Fp(d.La).height):cpc(d,!1)}};p.hf=function(a){this.We=a;y(this.C,function(b){b.hf(a)})};p.Fd=g("We");p.O0b=function(){P.Go.Ec(ipc)};p.lmb=function(){this.dispatchEvent("me")};function jW(a,b,c,d){R.call(this,d);this.V=a;this.$a=b;this.Z=new ts("",this.Ba());this.Wa(this.Z);this.J=new R(this.Ba());this.Wa(this.J);this.C=null;this.Xa=[];this.Pa=this.Oa=!1;this.Kb=c}w(jW,R);p=jW.prototype;p.kOa=Rf;p.gua=Sf;p.Ga=function(){jW.$.Ga.call(this);this.La=T(epc,{title:this.J4()})};
p.Sa=function(){jW.$.Sa.call(this);this.J.mb(this.bb("waffle-assistant-section-card-holder"));this.Z.mb(this.bb("waffle-assistant-section-more-button"));this.getHandler().R(this.Z,"action",this.bxb);this.C=this.kEa();F(this,this.C);Q(lpc(this),this.kOa());this.setVisible(!1)};p.setVisible=function(a){if(this.wc()&&this.kb()!=a&&(Q(this.La,a),a)){Q(this.Z.La,this.IVa());a=new Jia;N(a,4,this.hwa());var b=new hi;ci(b,58,a);a=ri(qi(new pi,10),b).build();this.Kb.fc(2774,a)}};
p.kb=function(){return this.wc()&&Ip(this.La)};p.IVa=function(){return this.Xa.length>this.V};p.kEa=function(){return new iW(this.Ba())};p.hf=function(a){this.Pa=a;y(mpc(this),function(b){b.hf(a)});this.C.hf(a)};p.Fd=g("Pa");p.uh=sa;
p.gwa=function(a){this.Xa=a;for(var b=0;b<a.length;b++){if(this.J.kd()<this.V){var c=this.g8(a[b]);c.hf(this.Pa);var d=this.J.kd();c.qa=d;this.J.Wa(c,!0)}if(this.gua()&&(this.C.oI(!1),c=this.C,d=this.g8(a[b]),c.C.push(d),c.Ye)){jpc(c,!1);var e=c.L.kd();d.qa=e;c.L.Wa(d,!0);d.JK()}}};function mpc(a){var b=[];a.J.Jf(function(a){b.push(a)});return b}function lpc(a){return a.bb("waffle-assistant-section-content")}p.ppa=function(){return this.J.Yaa()};
p.lW=function(){this.Xa=[];Ic(this.J.Gd(!0));this.setVisible(!1);this.gua()&&(this.C.HZ(),this.C.oI(!0))};function npc(a){a.J.Jf(function(a,c){c<this.V&&a.JK()},a)}p.iwa=function(a){var b=0;if(this.Oa)this.C.nYa();else if(this.ppa()){this.setVisible(!0);for(var b=Fp(this.bb("waffle-assistant-section-header")).height+Fp(lpc(this)).height,c=mpc(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.wLa(c[d]),cpc(c[d],!0),b+=Fp(c[d].La).height):cpc(c[d],!1)}else this.setVisible(!1);return a-b};p.wLa=sa;
p.setActive=function(a){(this.Oa=a)||this.C.v8()};p.$b=g("Oa");function opc(a,b){a.C.ata(b,a.J4())}p.bxb=function(){this.setActive(!0);this.dispatchEvent("re")};p.wu=g("Kb");var ppc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function qpc(a){var b=new vC(sc(ppc));return Nkc(a,b)}
function rpc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.dc("useFirstColumnAsDomain")&&a.Rd()&&"number"===a.Rd().hd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.dc("useFirstColumnAsDomain")&&a.Rd()&&"string"===a.Rd().hd(0)){var c=0,d=Jl("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Rd().getNumberOfRows();b++)Zl(d,a.Rd().Uf(b,0)),c=Math.max(c,Mp(d).width);Ql(d);c=Math.min(27,Math.max(15,10+100*c/271))}en()||Xm||(a.setOption("chartArea.top","15%"),b=a.dc("hAxis.title"),a.setOption("chartArea.height",Va(ib(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Va(ib(a.dc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function spc(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function tpc(){return V(U(ss({Ce:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:vr(""+U(Jt({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(ss({Ce:"waffle-assistant-zoom-button",content:vr(""+U(Jt({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function upc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.t7a)+"</span>"),d=0==a.zHa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.zHa;for(var e=a.length,f=0;f<e;f++)var h=a[f],c=c+((0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(Pm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function vpc(a,b,c,d,e,f,h){R.call(this,h);this.F=a;this.D=b;this.J=e;this.Kb=f;this.C=this.xc=null;this.H=qi(new pi,10).build()}w(vpc,R);p=vpc.prototype;p.Sa=function(){vpc.$.Sa.call(this);(new hU(KC,this.D.tf())).send(u(this.spb,this,this.D))};p.Doa=function(a,b){a=new Soc(this.F.clone(),this.J,this.xc,2746,a,b);this.dispatchEvent(a)};p.spb=function(a,b){b&&(b.Ci()?jC.xB(this.La,b):(b=b.Rd(),a.$d(b),CU(a,b),kC(a,"ready",u(this.B0b,this,a)),QU(a,this.La,this.Kb,Xm),this.xc=b))};
p.B0b=function(a){a.ym()&&(kC(a.ym(),"onmouseover",u(this.z0b,this)),kC(a.ym(),"onmouseout",u(this.A0b,this)))};p.z0b=function(){this.C=Ka()};p.A0b=function(){Ea(this.C)&&500<Ka()-this.C&&this.Kb.fc(2750,this.H);this.C=null};function wpc(a,b,c,d,e){R.call(this,e);this.J=a;this.Oa=b;this.Kb=c;this.O=d;this.L=Ec(this.J,23);this.Ia=B(this.J,22);this.D=B(this.J,26);this.Ca=[];this.De=new rh;this.V=this.F=this.C=null;this.Z=!1;this.qa=new ts("",this.Ba());this.Wa(this.qa);this.H=null}w(wpc,R);p=wpc.prototype;p.Ga=function(){wpc.$.Ga.call(this);this.La=T(upc,{t7a:this.D,zHa:this.L});this.La.style.visibility="hidden"};
p.Sa=function(){wpc.$.Sa.call(this);var a=this.bb("waffle-assistant-facet-toggle");this.qa.mb(a);this.getHandler().R(this.La,"mousedown",this.Rg).R(this.qa,"action",this.NEb);Pm&&(this.V=new Woc("assistantAutovisFacetFeedback",this.Ba()),this.V.render(this.bb("waffle-assistant-facet-feedback-container")),this.C=new fW(this.Ba()),this.Wa(this.C),this.C.render(this.bb("waffle-assistant-facet-thumbs-container")),Yoc(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.C,
"thumbs-up",this.y0b).R(this.C,"thumbs-down",this.x0b));xpc(this,Pra)};p.Fd=g("Z");p.hf=function(a){this.Z=a;ypc(this)};p.Rg=function(a){a.stopPropagation()};p.NEb=function(){var a=ep(this.bb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");xpc(this,a);zpc(this,a?2647:2646)};
function xpc(a,b){var c=a.bb("waffle-assistant-facet-toggle");Zl(c,b?"HIDE":"SHOW");jp(a.bb("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);y(a.Vi("waffle-assistant-faceted-chart"),function(a){am(a,b)});a.C&&Q(a.C.La,b);var d='Show chart broken down by "'+(a.D+'"');a='Hide chart broken down by "'+(a.D+'"');eW(c,b?a:d)}
function Apc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function Bpc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function ypc(a){a.O&&!a.Z&&y(a.Ca,u(function(a){var b=a.La;if(!this.O.contains(b)){var d=this.O;a=new Cpc(b,a);Zmb(d,a)}},a))}p.y0b=function(){zpc(this,2649)};p.x0b=function(){zpc(this,2648);this.V.show(!0)};function zpc(a,b){var c=a.Kb,d=new MU,e=a.H.getChartType();d.C=e;e=a.H.Rd();d.F=e?e.clone():null;NU(c,b,d,10,a.H,a.H.tf())};function kW(a,b,c,d,e,f){gW.call(this,a,f);this.C=B(a,8);this.Kc=b;this.zc=c;this.Kb=d;this.$a=e;this.L=new ts("",this.Ba());this.Wa(this.L);this.Z=new ts("",this.Ba());this.Wa(this.Z);this.De=new rh;this.Xb=null;this.Pa=!1;this.Ub=[];this.Qb=[];this.zb=[];this.Xa=this.Ia=this.F=this.H=this.Ca=null;this.J=qi(new pi,10).build()}w(kW,gW);
var lW={YYa:"waffle-assistant-after-chart-preview",rZa:"waffle-assistant-before-chart-preview",EZa:"waffle-assistant-card-draggable",O5:"waffle-assistant-chart-highlights",i1a:"waffle-assistant-insert-chart-button",Rga:"waffle-assistant-chart-preview",g3a:"waffle-assistant-button-separator",D3a:"waffle-assistant-styled-border",E3a:"waffle-assistant-styled-rect",F4a:"waffle-assistant-zoom-button"};p=kW.prototype;p.OI=function(a){this.Xb=a;Dpc(this)};
p.DI=function(){Epc(this,u(function(a){a=Qlc(this.Kc,a);cp(this.La,a)},this),!1)};p.cE=Sf;p.kG=n("autovisFeedback");p.hM=n(2208);p.gM=n(2207);p.w$=n("Was this chart useful?");p.Ga=function(){kW.$.Ga.call(this);hW(this).appendChild(T(spc));apc(this).appendChild(T(tpc));yc(this.C,22)&&(this.F=new wpc(this.C,this.qa,this.Kb,this.$a,this.Ba()),this.Wa(this.F,!0),this.F.hf(this.Fd()))};
p.Sa=function(){kW.$.Sa.call(this);fp(this.La,lW.EZa);var a=this.bb(lW.i1a);this.L.mb(a);eW(a,"Insert chart");a=this.bb(lW.F4a);this.Z.mb(a);eW(a,"View full size");var a=this.bb(lW.rZa),b=this.bb(lW.Rga),c=this.bb(lW.YYa);this.getHandler().R(this.La,"keydown",this.u0b).R(b,"click",this.Anb).R(a,"focus",this.vmb).R(c,"focus",this.mlb).R(this.L,"action",this.Fub).R(this.L.La,"mousedown",this.Rg).R(this.Z,"action",this.zGb).R(this.Z.La,"mousedown",this.Rg).R(this.bb(lW.O5),"mousedown",this.Rg).R(dv(this.Kc),
"Da",this.v0b);Fpc(this);this.Kb.fc(2790,this.J);this.F&&this.Kb.fc(2791,this.J)};p.hf=function(a){kW.$.hf.call(this,a);Fpc(this);this.wc()&&Gpc(this)};function Fpc(a){if(a.wc()){var b=a.Fd();a.L.setVisible(!b);a=a.Ba().bb(lW.g3a,apc(a));Q(a,!b)}}p.u0b=function(a){13==a.keyCode&&a.target==this.La&&(a.preventDefault(),a.stopPropagation(),Hpc(this,2255))};
function Ipc(a){for(var b=a.getChartType(),c=!!B(a.C,14),d=B(a.C,16),e=!!B(a.C,15),f="Histogram"==b,b="PieChart"==b,h=tT(Ec(a.D,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=Jpc(h[m].rect,c!=b);Ob(l,q)}var c=tB(a.zc).ld(),r=[];for(v in Hg)r.push(c.I4(Hg[v]));var v=vb(l,function(a){return vb(r,Ha(eh,a))});f&&e&&(v=Pb(v,1));a.zb=Kpc(v.length,b&&0<d||!f&&!b&&e,b&&k);d=tB(a.zc);for(e=0;e<v.length;e++)for(f=a.zb[e],b=0;b<v[e].length;b++)v[e][b]&&nh(v[e][b])&&(k=FS(d,v[e][b],lW.E3a),F(a,k),kH(xI(d),k,
!0),np(k.La,"background-color",f),k.setVisible(!0),a.Ub.push(k),k=dI(d,v[e][b],lW.D3a,1,0),F(a,k),Fgb(k,f),k.setVisible(!0),a.Qb.push(k))}function Lpc(a){Ic(a.Ub);Ic(a.Qb);a.Ub=[];a.Qb=[];a.zb=[]}p.v0b=function(){this.Pa&&(Lpc(this),Ipc(this))};p.g1=function(){kW.$.g1.call(this);this.Ia=Ka();this.Pa||(Ipc(this),this.Pa=!0)};p.sT=function(){kW.$.sT.call(this);Ea(this.Ia)&&500<Ka()-this.Ia&&this.Kb.fc(2789,this.J);this.Ia=null;Lpc(this);this.Pa=!1};p.Anb=function(){this.La.focus()};
p.vmb=function(){var a=this.bb(lW.O5);Ip(a)?a.focus():this.La.nextSibling&&this.La.nextSibling.focus()};p.mlb=function(){var a;if(a=this.V)a=this.V,a.Hb("waffle-assistant-feedback-card-hidden")?a=!1:(a.bb("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Z.La.focus()};p.Fub=function(){this.Kb.fc(2255,this.J);Hpc(this,2255)};p.Rg=function(a){a.stopPropagation()};p.zGb=function(){X.Y4.Ec(this)};p.Doa=function(a,b){Hpc(this,2257,a,b)};
function Hpc(a,b,c,d){Epc(a,u(function(a){a=new Soc(a,this.qa,this.H&&this.H.Rd(),b,c,d);this.dispatchEvent(a)},a),!1)}
p.w0b=function(a,b){if(b){var c=this.bb(lW.Rga);if(b.Ci())jC.xB(c,b);else{a.$d(b.Rd());CU(a,a.Rd());jT(a,"ready",u(this.t0b,this,a));b=[];try{var d=new df;d.setContext(a.toJSON());var e=!!B(this.C,14);C(d,3,e);var f=B(this.C,16);C(d,4,f);C(d,5,"ROWS"==(e?"ROWS":"COLS"));C(d,8,0);if(B(this.C,24)){var h=B(this.C,25);C(d,9,h)}for(var k=tT(Ec(this.D,4)),e=0;e<k.length;e++)d.addRange(vh(k[e].rect,k[e].Xc));var l=this.De.serialize(d);b=vb(xmc(Ha(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
umc)}catch(m){b=[]}d=this.bb(lW.O5);Q(d,0<b.length);0<b.length&&(d.appendChild(b[0]),am(d,!0));this.H=a;QU(a,c,this.Kb,Xm)}}};p.t0b=function(a){null!==this.Ca&&(Ki(Ii.getInstance(),this.Ca),this.Ca=null);this.isDisposed()||(a.ym()&&(kC(a.ym(),"onmouseover",u(this.r0b,this)),kC(a.ym(),"onmouseout",u(this.s0b,this))),this.Xb(),Gpc(this))};p.r0b=function(){this.Xa=Ka()};p.s0b=function(){Ea(this.Xa)&&500<Ka()-this.Xa&&this.Kb.fc(2795,this.J);this.Xa=null};
function Gpc(a){if(a.$a&&!a.Fd()){var b=a.bb(lW.Rga);if(!a.$a.contains(b)){var c=a.$a;a=new Cpc(b,a);Zmb(c,a)}}}function Mpc(a){a.Ib&&(a.Ca=Ji(Ii.getInstance(),tj.Swa),a.Ib=!1);B(a.C,16);var b=qpc(a.C);b.Nda(KC);var c=Pkc(a.D);b.Vh(c.toString());a.F&&(c=c.clone(),a.F.F=c);return b}
function Dpc(a){var b=Mpc(a),b=rpc(b,a.bb("waffle-assistant-card-inner"));(new hU(KC,b.tf())).send(u(a.w0b,a,b));a.F&&Epc(a,u(function(a){var c=this.F,e=b;a=new vC(a.toJSON());var e=new vC(e.toJSON()),f=c.Vi("waffle-assistant-faceted-chart");if(1<f.length){Bpc(a);var h=e;Apc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");en()||Xm||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,Bpc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),Apc(e);h=tT(Ec(c.J,27));DZa(c.F,h);for(var h=B(c.J,25),k=0;k<f.length;k++){var l=Ca(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Ia,r=new jf;C(r,1,q);Ca(l)&&r.gb(l);C(m,7,r);c.F.Sb("dt",encodeURIComponent(JSON.stringify(c.De.serialize(m))));
q=new vC(a.toJSON());q.Vh(c.F.toString());m=e.clone();m.Vh(c.F.toString());var v=c,x=q.dc("title");x||(x=roc(q));r=x+(' when "'+(v.D+('" is "'+(l+'"'))));v=x+(' by "'+(v.D+'"'));r=l?r:v;q.setOption("title",r);m.setOption("title",r);v=new vpc(q,m,0,0,c.Oa,c.Kb,c.Ba());c.Wa(v);r=f[k];v.mb(r);c.Ca.push(v);v=c;x=roc(q);q=x+(' broken down by "'+(v.D+('" for "'+(l+'"'))));v=x+(' broken down by "'+(v.D+'"'));cp(r,l?q:v);c.H=m}ypc(c);c.La.style.visibility="visible"},a),!1)}
function Epc(a,b,c){var d=Mpc(a);(new hU(KC,d.tf())).send(function(a){a?(a=a.Rd(),c&&d.$d(a),CU(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function Kpc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=Djc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Ob(d,d);return d}function Jpc(a,b){return b?phc(a,new Ug(a.width,1)):phc(a,new Ug(1,a.height))};function Npc(){NI.call(this);this.Pa.push(this);this.Ca=this.Ia=!0;this.ib="waffle-assistant-dragged-card"}w(Npc,Ymb);Npc.prototype.contains=function(a){return!!y(this.L,function(b){if(b.element==a)return!0})};Npc.prototype.ana=function(a){var b=Npc.$.ana.call(this,a);if(en()||Xm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=vb(b.querySelectorAll("clippath"),function(a){return a.id}),Opc(b,a);return b};
function Opc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];Ca(c)&&bb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=Sl(a);for(c=0;c<a.length;c++)Opc(a[c],b)}function Cpc(a,b){PI.call(this,a,b)}w(Cpc,PI);Cpc.prototype.cna=g("element");function Ppc(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function mW(a,b){gW.call(this,a,b);this.C=B(a,8)}w(mW,gW);p=mW.prototype;p.DI=sa;p.kG=n("assistantWordCloudFeedback");p.hM=n(2634);p.gM=n(2633);p.Ga=function(){mW.$.Ga.call(this);hW(this).appendChild(T(Ppc));fp(hW(this),"waffle-assistant-word-cloud-content-container")};
p.OI=function(a){for(var b=Ec(this.C,19),c=Ec(this.C,20),d=this.bb("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(Qpc(this,b,c,e),120<d.clientHeight){Qpc(this,b,c,e-1);break}b=this.Ba();c=B(this.C,2);c=km(b,c);d=this.bb("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function Qpc(a,b,c,d){var e=a.bb("waffle-assistant-word-cloud-words-container");for(a=a.Ba();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(km(a," "));var l=a.createElement("SPAN");a.appendChild(l,km(a,b[k]));a.appendChild(e,l);fp(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function nW(a,b,c,d,e){jW.call(this,20,d,c,e);this.O=a;this.L=b;this.D=new Npc;F(this,this.D);this.F=null;this.H=0}w(nW,jW);p=nW.prototype;p.Sa=function(){nW.$.Sa.call(this);this.D.Ue();this.getHandler().R(this.D,"drag",this.q0b).R(this.D,"dragend",this.Qm)};p.J4=n("Analysis");p.Yia=function(a){return 0==a};p.g8=function(a){return"WordCloud"==B(a,8).getChartType()?new mW(a,this.Ba()):new kW(a,this.O,this.L,this.wu(),this.D,this.Ba())};p.hf=function(a){nW.$.hf.call(this,a);a&&Gmb(this.D)};
p.wLa=function(a){this.getHandler().Jc(a,"content-rendered",this.p0b);this.H++};p.p0b=function(){0==--this.H&&this.dispatchEvent("oe")};p.q0b=function(){this.F=Bp(this.D.bd.target)};p.Qm=function(a){var b=this.F,c=tB(this.L).Yd();if(Yg(eG(c,"page",!1,!1)).contains(b)){var d=cG(c,b.x,b.y,"page"),c=gG(c,ch(d),"page"),b=new Mg(b.x-c.left,b.y-c.top);a.C.getData().Doa(d,b)}this.F=null};p.hwa=n(2);function Rpc(a,b,c){this.J=a;this.D=[];this.C=[];this.F=b;this.H=c}w(Rpc,E);function oW(a,b){pW(a);Spc(a,b)}function Spc(a,b){if(null!=b){var c=tB(a.J),d=c.ld(),d=vb(gc(Hg),d.I4,d);b=vb(d,Ha(eh,b.rect));for(d=0;d<b.length;d++)if(b[d]&&nh(b[d])){var e=FS(c,b[d],a.H);F(a,e);kH(xI(c),e,!0);e.setVisible(!0);a.D.push(e);e=dI(c,b[d],a.F,1,0);F(a,e);e.setVisible(!0);a.C.push(e)}}}function pW(a){Ic(a.D);Ic(a.C);a.D=[];a.C=[]};function Tpc(a){var b=a.type;if(!t(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return t(a.value)?a.value:null}}
function Upc(a,b){var c=a.type;if(t(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(Ca(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":Ca(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};var Vpc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),Wpc=[{$j:["Thank you","Thankyou","Thanks"],Sg:"No problem"},{$j:["you are amazing","This is great","omg"],Sg:"Happy to help"},{$j:["I love you"],Sg:"Must be in the air"},{$j:["How do you know","How are you so smart"],Sg:"It's all in the data"},{$j:["Are you sure"],Sg:"Send feedback if this doesn't seem correct to help improve accuracy"},{$j:["How are you"],Sg:"Pretty good, thanks"},
{$j:["Hi","Hello","Hey"],Sg:"Hi, there. Try asking a question about your data."},{$j:["You are stupid","This is dumb","You are wrong"],Sg:"Help improve this experience by sending feedback"},{$j:["How smart are you"],Sg:"Pretty smart"}];function Xpc(a){for(var b=0;b<Wpc.length;++b)if(-1!=Ab(Wpc[b].$j,function(b){return Qa(a,b)}))return b;return-1};function qW(a,b,c,d,e,f,h){this.C=a;this.bZ=b;this.H=(void 0===h?null:h)||b;this.D=d;this.Hq=c;this.Ca=d?Ec(d,6):[];this.Ia=d?Ec(d,7):[];this.qa=d?Ec(d,8):[];this.error=e||1;this.interpretation=d&&yc(d,4)?B(d,4):null;this.O=d?Ec(d,12):[];this.Z=f;this.V=!1;this.L=[];this.J=!1;this.F=null;if(this.D&&yc(this.D,17))if(c=B(this.D,17),this.V=B(c,4)||!1,a=Ec(c,3),b=Ec(c,1),0<a.length)if(0==b.length||1>=this.H.length||1>this.H[0].length)this.L.push("Charts for this question are not supported.");else{for(c=
0;c<b.length;c++)if(Db(a,b[c])){this.J=!0;this.F=b[c];break}null==this.F&&10==a[0]&&Db(b,2)&&(this.J=!0,this.F=2);null==this.F&&(this.J=!0,this.F=Ypc(this,b),1==a.length&&6==a[0]||this.L.push("Requested chart type is not supported for this question."))}else 0<b.length&&1<this.H.length&&1<this.H[0].length&&(this.F=Ypc(this,b),this.J=B(c,2)||!1,20<=this.H.length||3<=this.H[0].length)&&(this.J=!0)}function Zpc(a){return 1==a.error&&null!=a.Hq}
function $pc(a){return{RN:aqc(a),interpretation:a.interpretation,bZ:a.bZ,Hq:a.Hq,Z1:1<a.bZ.length&&1<a.bZ[0].length,Rm:a.Rm(),IUb:a.V,IHb:a.L}}qW.prototype.Rm=function(){var a;if(a=Vm&&null!=this.F)a:switch(this.F){case 2:case 3:case 4:case 5:case 10:case 7:a=!0;break a;default:a=!1}return a&&2<this.H.length};
qW.prototype.getChartType=function(){if(!this.Rm())return null;switch(this.F){case 2:return"ColumnChart";case 3:return"LineChart";case 4:return"ScatterChart";case 5:return"PieChart";case 10:return"Histogram";case 7:return"LineChart";default:throw Error("Unknown chart type.");}};function bqc(a){if(!a.D||!yc(a.D,17))return null;var b=B(a.D,17);C(b,2,a.J);return b}function cqc(a){a.Rm();return a.H[0][0]}
function dqc(a){return vb(Ec(a.D,18),function(b){if(B(b,2)){var c=a.Z.C;return wv(B(b,2),c)}},a)}function eqc(a){return{RN:aqc(a),error:fqc(a)}}function Ypc(a,b){if(!Ec(a.D,18).length)return b[0];a=gqc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(Db(b,a[c]))return a[c];return b[0]}function hqc(a,b,c){var d={};null!=b?(d.v=iqc(a,b,c),d.f=b):d.v=null;return d}
function gqc(a){for(var b=new bC,c=a.H[0],d=Pb(a.H,1),e=Ec(a.D,18),f=[],h=0;h<c.length;h++)null!=e[h]&&yc(e[h],1)?f.push(jqc(B(e[h],1))):f.push(0==h?"string":"number"),b.jt({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){for(var h=[],k=0;k<c.length;k++)h.push(hqc(a,d[e][k],f[k]));b.$w(h)}return b}
function iqc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return b=b||"0",a=eIa(a.Z.L.C).DECIMAL_SEP,b=b.replace(new RegExp("[^0-9"+a+"]","g"),""),b=b.replace(a,"."),ob(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Wa(a[0])&&Wa(a[1])&&(Wa(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Wa(a[d])&&
(c[d]=ob(a[d]));"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function jqc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function kqc(a){if(!yc(a.D,9))return"";if(yc(a.D.getError(),3))switch(B(a.D.getError(),3)){case 1:return"Sorry, questions related to formatting aren't supported at the moment.";case 2:return"Answers provides formulas based on your data. Charts aren't supported at the moment. Please use the menus to create a chart.";case 3:return"Sorry, this action isn't supported at the moment.";case 4:return"Sorry, this function isn't supported at the moment.";case 5:return"Sorry, your question is too general. Please ask a more specific question.";
default:return"Sorry, this function isn't supported at the moment."}return a.D.getError().xm()||""}
function fqc(a){switch(a.error){case 2:return"It looks like you're offline. Try again when you've reconnected.";case 3:return"We're having a problem getting your answer at the moment. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask questions and learn more about your data.";case 6:return kqc(a)||"Sorry, couldn't understand your question.";case 7:return a=Xpc(a.C),-1!=a?Wpc[a].Sg:""}return""}
function aqc(a){var b=[];if(Zpc(a)){var c=[];y(Mb(a.Ca,a.qa),function(a){c.push(lqc(a,"waffle-assistant-answercard-question-unused-phrase"))});y(a.Ia,function(a){c.push(lqc(a,"waffle-assistant-answercard-question-used-entity"))});Tb(c,function(a,b){return a.WV>b.WV?1:-1});var d=0;y(c,function(c){var e=c.length,h=c.WV;h>d?b.push({text:a.C.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.C.substring(h,d),className:c.ck}))});d<a.C.length&&b.push({text:a.C.substring(d),className:null})}else b.push({text:a.C,
className:null});return b}function lqc(a,b){return{WV:B(a,2),length:B(a,3),ck:b}};function rW(a,b,c,d){I.call(this);this.O=a;this.V=b;this.qa=c;this.Pa=d;this.Qa=new J(this);F(this,this.Qa);this.C=new $U;F(this,this.C);this.L="";this.J=[];this.F=this.D=this.H=null;this.Z=!1;cmc(this.C,this.O);this.C.Ca=10;this.C.fb=!0;this.C.O=!1;this.C.XUa("waffle-assistant-visible");this.C.qa=Xa("waffle-assistant-dragged-formula").split(" ");this.C.Ue();this.Qa.R(this.C,"beforedragstart",this.Ia).R(this.C,"dragmove",this.Oa).R(this.C,"beforedragend",this.Ca)}w(rW,I);rW.prototype.hf=da("Z");
rW.prototype.Ia=function(a){a=rb(this.O.childNodes,a.C);this.L=this.J[a]};
rW.prototype.Oa=function(a){var b=a.event instanceof Zp?a.event.nM:a.event;this.Z?(a.J.Hz(b,!0),a.preventDefault()):(tp(a.F,a.event.clientX,a.event.clientY),a=up(a.F),b=tB(this.V).Yd(),Yg(eG(b,"page",!1,!1)).contains(a)?(a=cG(b,a.x,a.y,"page"),(b=vw(fv(this.qa),a.y,a.x))?a=new Mg(b.hc(),b.qc()):b=ch(a),this.H=a,this.D&&this.D.getRect().equals(b)||(a=tB(this.V),G(this.D),this.D=FS(a,b,"waffle-assistant-formula-insertion-rect"),F(this,this.D),kH(xI(a),this.D),G(this.F),this.F=dI(a,b,"waffle-assistant-formula-insertion-border",
2,0),F(this,this.F),Fgb(this.F,"#000"),this.F.setVisible(!0))):mqc(this))};rW.prototype.Ca=function(a){if(this.H){var b=this.H,c=fv(this.qa),b=new wG(c,b,this.L);this.Pa.C(b);this.dispatchEvent(new H("formula_inserted"))}a.J.Hz(null,!0);a.preventDefault();this.L="";mqc(this)};function mqc(a){a.H=null;G(a.D);a.D=null;G(a.F);a.F=null};function nqc(a){var b=a.error,c=a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Jt({icon:"docs-icon-img docs-icon-unsupported-black"}))+'</div><div class="waffle-assistant-errorcard-content">';c?(b=U(b)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+b+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(b)+"</div>";
return V(a+"</div></div>")};function oqc(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+pqc({RN:a.iF.RN}),d=a.iF.bZ;var e=a.iF.Hq;var f=a.iF.interpretation,h=a.iF.Z1,k=a.iF.Rm,l=a.iF.IUb;a=a.iF.IHb;null==d||wa(d);wa(a);var m=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+yr("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(f?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(f)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){if(!l){k&&(m+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-chart-tab">CHART</div></div>');m+='<div class="waffle-assistant-answercard-answer">';if(h){m+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=d[0],f=l.length,q=0;q<f;q++)m+='<span class="waffle-assistant-answercard-answer-col">'+
U(l[q])+"</span>";m+="</div>"}m+='<div class="waffle-assistant-answercard-answer-rows">';l=ur("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));f=d.length;for(q=0;q<f;q++){var r=d[q];if(h&&0==q)r="";else{var v=l;wa(r);for(var v='<div class="'+W(v)+'">',x=r.length,z=0;z<x;z++)var D=r[z],v=D?v+('<span class="waffle-assistant-answercard-answer-col">'+U(D)+"</span>"):v+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+
'">N/A</span>');r=V(v+"</div>")}m+=r}m+="</div></div>"}m+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart"></div></div>':""}if(0<a.length){m+='<div class="waffle-assistant-answercard-info-msgs">';d=a.length;for(h=0;h<d;h++)m+='<div class="waffle-assistant-answercard-info-msg">* '+U(a[h])+"</div>";m+="</div>"}m+='<div class="waffle-assistant-answercard-footer">';k&&(m+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');
m+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(Jt({icon:"docs-icon-img docs-icon-insert-formula"}))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+
U(e)+"</div></div></div></div></div></div></div>";e=V(m);return b(c+e+"</div></div>")}
function pqc(a){wa(a.RN);a=a.RN;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+yr("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function qqc(){var a=V;var b=V('<div class="waffle-assistant-answers-card-remove">'+U(Jt({icon:"docs-icon-img docs-icon-trash"}))+"</div>");return a(U(b))};function rqc(a){this.Kb=a}function sqc(a,b){var c=new TV;N(c,3,b);N(c,8,asa);b=new MS;ci(b,4,c);c=new hi;ci(c,46,b);c=ri(qi(new pi,10),c).build();a.Kb.fc(2753,c)};function tqc(a,b,c,d,e,f){H.call(this,"sqc");this.V=a;this.J=f||"";this.L=b;this.F=d;this.Z=e;this.C=c}w(tqc,H);function uqc(a,b,c,d){var e=new woc;N(e,2,c);y(b,function(a){M(e,1).push(a)});N(e,3,d);d=new SV;N(d,1,a);N(d,3,b[c]);ci(d,11,e);return d}function vqc(a,b,c,d){var e=new yoc;N(e,2,c);y(b,function(a){M(e,1).push(a)});N(e,3,d);d=new SV;N(d,1,a);N(d,2,b[c]);ci(d,10,e);return d}function wqc(a){var b=new zoc;y(a,function(a){var c=a.type;M(b,1).push(c);a.$Ha&&(a=a.$Ha,M(b,2).push(a))});return b}function xqc(a){var b=new xoc;y(a,function(a){a=a.type;M(b,1).push(a)});return b}
function yqc(a){var b=new voc,c=Ec(a,3),d=Ec(a,1);if(0<c.length){for(var e,f=0;f<d.length;f++)if(Db(c,d[f])){e=d[f];break}e||(e=c[0]);N(b,2,e)}for(c=0;c<d.length;c++)e=d[c],M(b,3).push(e);a=B(a,2);N(b,4,a);return b};function sW(a,b,c,d,e,f,h,k,l,m,q){gW.call(this,new XU,q);this.C=a;this.We=dqc(a);this.Kc=a.Rm();this.Zd=a.Rm()&&a.J;this.Xb=a.V;this.Ia=!1;this.Qb=b;this.zb=c;this.Ub=d;this.zc=l;this.vf=h;this.Kb=e;this.Id=f;this.Bd=k;this.Qe=m;this.pe=qi(new pi,10).build();this.$a=new ls("",new dW,this.Ba());this.Wa(this.$a);this.L=null;this.J=new ls("",new cW,this.Ba());this.Wa(this.J);this.Z=new ls("",new cW,this.Ba());this.Wa(this.Z);this.Ca=new ls("",new dW,this.Ba());this.Wa(this.Ca);this.H=new DT;this.Wa(this.H);
this.F=null;this.xc=gqc(this.C);this.Pa=new Rpc(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");F(this,this.Pa);this.Xa=!1}w(sW,gW);p=sW.prototype;p.$la=g("Bd");p.Ga=function(){sW.$.Ga.call(this);apc(this).appendChild(T(qqc))};
p.Sa=function(){sW.$.Sa.call(this);var a=this.bb("waffle-assistant-answers-card-remove");this.$a.mb(a);eW(a,"Remove card",0);this.getHandler().Jc(this.$a,"action",this.D0b).R(this.J,"action",this.fCb).R(this.Z,"action",this.Htb).Jc(this.J,"action",u(this.nQa,this,!0)).Jc(this.Z,"action",u(this.nQa,this,!1))};
p.OI=function(a){hW(this).appendChild(T(oqc,{iF:$pc(this.C)}));this.J.mb(this.bb("waffle-assistant-answercard-see-formula-link"));this.Z.mb(this.bb("waffle-assistant-answercard-hide-formula-link"));this.L=new rW(this.bb("waffle-assistant-answercard-formula-text-container"),this.Qb,this.zb,this.Ub);this.L.hf(this.Fd());this.L.J=[this.C.Hq];F(this,this.L);var b=this.bb("waffle-assistant-answercard-formula-text");eW(b,"Click to copy or drag to insert",void 0,"Formula: "+(this.C.Hq+". Click/Press ENTER to copy, or drag to insert it into the sheet."));
ric(b,this.Fd());Pf(this.getHandler().Jc(this.L,"formula_inserted",this.uJb),this.bb("waffle-assistant-answercard-formula-text"),gd,this.Wsb);zqc(this,this.Qe);if(this.Kc){if(this.Xb)Aqc(this),this.Ia=!0;else{this.H.mb(this.bb("waffle-assistant-answercard-tabs"));b=new BT("");b.mb(this.bb("waffle-assistant-answercard-formula-tab"));this.H.Wa(b);var c=new BT("");c.mb(this.bb("waffle-assistant-answercard-chart-tab"));this.H.Wa(c);this.getHandler().R(this.H,"select",this.oEb).Jc(b,"action",u(this.lQa,
this,0)).Jc(c,"action",u(this.lQa,this,1));this.H.Cw(this.Zd?c:b)}b=this.bb("waffle-assistant-answercard-insert-chart");this.Ca.mb(b);Bqc(this);this.getHandler().R(this.Ca,"action",this.C0b)}a()};
function Aqc(a){a.F=new RU;var b=a.C.getChartType();C(a.F,1,b);C(a.F,2,a.C.interpretation||"");if("Histogram"===b)b=cqc(a.C),C(a.F,3,b),C(a.F,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.xc.hd(0)&&(b=a.xc.gh(0),C(a.F,3,b),b=1),1==a.xc.getNumberOfColumns()-b?(b=a.xc.gh(b),C(a.F,6,b)):C(a.F,6,"Values");else{var b=a.F,c=cqc(a.C);C(b,3,c);c=a.C;c.Rm();C(b,6,c.H[0][1]||"")}b=qpc(a.F);b.$d(a.xc);c=a.bb("waffle-assistant-answercard-chart");b=rpc(b,c);CU(b,b.Rd());b.setOption("title",
"");QU(b,c,a.Kb,Xm);a.Ia=!0}
p.C0b=function(){if(this.F){var a=qpc(this.F);a.$d(this.xc);CU(a,a.Rd());var b=fv(this.zb),c=Iv(b),d=Zhc(b,c,!1),c=oB(b,d.y),b=pB(b,d.x),d=KZa(this.zc.J),c={oid:null,ar:c,ac:b,x:16,y:16,h:Dy.height,w:Dy.width,p:{context:{chartName:"Chart"+(d+1)}}},b=new of;C(b,2,"0.6");d=this.xc.toJSON();C(b,1,d);c=new HC(Xu(this.zb)||0,c,!1,!1,b);HS(c,a);this.Qb.dispatchEvent(new vD("objectRequest"));this.Ub.C(new tG(this.zc,c));c=this.C.F;a=new toc;N(a,1,c);c=new TV;ci(c,11,a);a=new MS;ci(a,4,c);c=new hi;ci(c,46,
a);a=ri(qi(new pi,10),c).build();this.Kb.fc(2874,a)}};p.DI=function(){cp(this.La,"Answer Card for question: "+this.C.C)};p.cE=Sf;p.kG=n("assistantAnswersFeedback");p.hM=n(2628);p.gM=n(2627);p.w$=n("Was this answer correct?");p.Qma=n("Correct");p.Pma=n("Incorrect");p.WO=g("C");p.hf=function(a){sW.$.hf.call(this,a);this.L&&this.L.hf(a);var b=this.Hb("waffle-assistant-answercard-formula-text");b&&ric(b,a);Bqc(this)};
p.g1=function(){sW.$.g1.call(this);if(!this.Xa){var a=this.Pa,b=this.We;pW(a);for(var c=0;c<b.length;c++)Spc(a,b[c]);this.Xa=!0}};p.sT=function(){sW.$.sT.call(this);pW(this.Pa);this.Xa=!1};p.oEb=function(){switch(ET(this.H)){case 0:Cqc(this,!1);break;case 1:Cqc(this,!0);break;default:ET(this.H)}};
function Cqc(a,b){Q(a.bb("waffle-assistant-answercard-chart-container"),b);Q(a.bb("waffle-assistant-answercard-answer"),!b);Q(a.bb("waffle-assistant-answercard-formula-holder"),!b);Bqc(a);!a.Ia&&b&&Aqc(a)}function Bqc(a){var b=(a.Xb||1==ET(a.H))&&!a.Fd();a.Ca.setVisible(b)}function zqc(a,b){a.J.setVisible(!b);a.Z.setVisible(b);Q(a.bb("waffle-assistant-answercard-formula"),b);b?a.bb("waffle-assistant-answercard-formula-text").focus():(a.J.La.focus(),a.J.hq(!0))}p.D0b=function(){sqc(this.Id,!0);this.dispatchEvent(new H("rc"))};
p.fCb=function(){zqc(this,!0)};p.Htb=function(){zqc(this,!1)};p.nQa=function(a){var b=new TV;N(b,9,a);a=new MS;ci(a,4,b);b=new hi;ci(b,46,a);b=ri(qi(new pi,10),b).build();this.Kb.fc(2849,b)};p.lQa=function(a){var b=this.C.F,c=bqc(this.C),d=new voc;c&&(d=yqc(c));N(d,1,b);b=new uoc;ci(b,1,d);switch(a){case 0:N(b,2,2);break;case 1:N(b,2,1);break;default:N(b,2,0)}a=new TV;ci(a,10,b);d=new MS;ci(d,4,a);a=new hi;ci(a,46,d);a=ri(qi(new pi,10),a).build();this.Kb.fc(2850,a)};
p.uJb=function(){this.Kb.fc(2709,this.pe)};p.Wsb=function(){var a=this.Ba().Tb(),b=a.createElement("textarea");b.textContent=this.C.Hq;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&tW(this.vf,"Formula copied to clipboard",this.Ba())};function Dqc(){var a=ur("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input type="text" class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Jt({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return V(a)};function Eqc(a){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(pqc({RN:a.mHa.RN}))+U(nqc({error:a.mHa.error,showHelp:a.showHelp}))+"</div></div>")}function Fqc(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function uW(a,b,c,d,e){gW.call(this,new XU,e);this.H=a;this.Z=b;this.L=d;this.Ca=c;this.J=new ls("",new dW,this.Ba());this.Wa(this.J);this.C=new ls("",new cW,this.Ba());this.Wa(this.C);this.F=new ls("",new cW,this.Ba());this.Wa(this.F)}w(uW,gW);p=uW.prototype;p.DI=function(){cp(this.La,"Error Card for question: "+this.H.C)};p.kG=n("assistantAnswersFeedback");p.cE=Sf;p.eba=Rf;p.Ga=function(){uW.$.Ga.call(this);apc(this).appendChild(T(qqc))};
p.Sa=function(){uW.$.Sa.call(this);var a=this.bb("waffle-assistant-answers-card-remove");this.J.mb(a);this.F.setVisible(this.L);eW(a,"Remove card",0);this.getHandler().Jc(this.J,"action",this.I0b).Jc(this.C,"action",this.qCb).R(this.F,"action",this.H0b)};
p.OI=function(a){hW(this).appendChild(T(Eqc,{mHa:eqc(this.H),showHelp:this.L}));if(Pm){var b=T(Fqc);this.Ba().appendChild(this.La,b);this.C.mb(this.bb("waffle-assistant-answercard-feedback-link"))}this.L&&this.F.mb(this.bb("waffle-assistant-answers-helpcenter-link"));a()};p.$la=g("Z");p.WO=g("H");p.qCb=function(){this.C.setVisible(!1);Q(this.bb("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new H("trigger_feedback"))};p.I0b=function(){sqc(this.Ca,!1);this.dispatchEvent(new H("rc"))};
p.H0b=function(){P.Go.Ec()};function Gqc(a){gW.call(this,new XU,a);this.C=this.Ba().createElement("div");Zl(this.C,"Previous")}w(Gqc,gW);p=Gqc.prototype;p.DI=function(){cp(this.La,"Previous questions below")};p.Ga=function(){Gqc.$.Ga.call(this);hp(this.La,"waffle-assistant-card");fp(this.La,"waffle-assistant-answers-previousheadercard")};p.OI=function(a){0<this.Ba().gi(hW(this)).length||hW(this).appendChild(this.C);a()};p.eba=Rf;p.kG=n("assistantAnswersFeedback");function Hqc(a){var b=""+((a.q9?U(nqc({error:a.q9,showHelp:a.showHelp})):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":""));var c=ur("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.AVb;for(var d=a.length,e=0;e<d;e++){var f=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Jt({icon:"docs-icon-img docs-icon-help"}))+
'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+U(f)+"</div></div></div>"}return V(b+"</div>")};function vW(a,b,c,d,e,f){gW.call(this,a,f);this.C=e||null;this.Z=b;this.F=d;this.Ca=c;this.L=this.C?5==this.C.error:!1;this.H=new ls("",new cW,this.Ba());this.Wa(this.H);this.J=new ls("",new dW,this.Ba());this.Wa(this.J)}w(vW,gW);p=vW.prototype;p.Ga=function(){vW.$.Ga.call(this);this.cE()&&apc(this).appendChild(T(qqc))};
p.Sa=function(){vW.$.Sa.call(this);fp(this.La,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.J0b);if(this.cE()){var a=this.bb("waffle-assistant-answers-card-remove");this.J.mb(a);eW(a,"Remove card",0);this.getHandler().Jc(this.J,"action",this.K0b)}};p.hM=function(){return Db([Iqc,wW],this.F)?2799:Db([Jqc,Kqc],this.F)?2801:null};p.gM=function(){return Db([Iqc,wW],this.F)?2798:Db([Jqc,Kqc],this.F)?2800:null};p.w$=n("Were these interesting?");
p.Qma=n("Interesting");p.Pma=n("Not interesting");p.kG=n("assistantAnswersFeedback");p.cE=function(){return this.C?!Zpc(this.C):!1};p.DI=function(){var a=this.F.title;a&&this.C?cp(this.La,a+(" for question: "+this.C.C)):cp(this.La,"Suggested questions")};
p.OI=function(a){var b=this;this.Ca.then(function(c){if(0==c.length)Q(b.La,!1);else{var d=b.Ba(),e=hW(b);if(0==d.gi(e).length){var f=T(Hqc,{title:b.F.title,AVb:vb(c,function(a){return a.query}),q9:b.C?fqc(b.C):"",showHelp:b.L});e.appendChild(f);var h=vb(c,function(a){return a.type}),e=b.Vi("waffle-assistant-answercard-question-container");y(e,function(a,e){var f=new ls("",new dW,d);b.Wa(f);f.mb(a);b.getHandler().R(f,"action",u(b.aEb,b,c[e],h,e))});b.L&&b.H.mb(b.bb("waffle-assistant-answers-helpcenter-link"))}}a()})};
p.K0b=function(){sqc(this.Z,!1);this.dispatchEvent(new H("rc"))};p.aEb=function(a,b,c){this.dispatchEvent(new tqc(this.F.Z3,a.Hq||null,b,c,this.F.yZ,a.query))};p.J0b=function(){P.Go.Ec()};var Lqc={title:"",yZ:0,Z3:null},Iqc={title:"",yZ:5,Z3:1},wW={title:"Suggested questions",yZ:5,Z3:1},Kqc={title:"Did you mean?",yZ:2,Z3:4},Jqc={title:"Related questions",yZ:4,Z3:4};function Mqc(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function xW(a){return Mqc(a,1)[0]}function Nqc(a){var b=0;y(a,function(c,d){c.length>a[b].length&&(b=d)});return vb(a[b],function(b,d){return vb(a,function(a){return a[d]})})};function Oqc(a){this.F=[];this.D={};this.J=a;this.C=new DN}function Pqc(a,b,c,d){function e(a){return a.toLowerCase()}Qb(b,void 0,e);Qb(c,void 0,e);Qb(d,void 0,e);y(b,a.H,a);y(c,a.H,a);y(d,a.H,a)}Oqc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function Qqc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}Oqc.prototype.cI=function(a,b,c){if(Xa(a||"")){var d=this.J.Mm();d=Rqc(this,a.substring(0,d));var e=Sqc(this,b-d.length,a);d=Mb(d,e)}else d=Sqc(this,b);d.length>b&&(d=Pb(d,0,b));c(a,d)};
function Sqc(a,b,c){var d=c||"";c=ac(a.D,function(a){return Qa(a,d)});var e=Tqc(gc(c),d?1:2,1);a=ub(a.F,function(a){return Qa(a.query,d)&&!e[a.query.toLowerCase()]});b=Tqc(a,b-ec(e),2);b=gc(b);var f=vb(b,function(a,b){a.Xua=b;return a.CWa});y(b,function(a){a.Vua=f});return Mb(b,gc(e))}
function Rqc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={wea:h.wea,A2:h.A2,zU:h.zU},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.zU={};h.A2=0;h.wea=f.substr(k);var l=a.C.Ie(h.wea);y(l,function(b){return function(c){var d=c.length-b.wea.length;b.A2=Math.max(d,b.A2);c=a.C.get(c);b.zU[d]||(b.zU[d]=[]);Ob(b.zU[d],c)}}(h));for(l=0;l<=h.A2&&0<d;++l){var m=h.zU[l];if(m)for(var q=0;q<m.length&&0<d;++q){var r=m[q];bb(b.toLowerCase(),r.toLowerCase())||e[r]||(--d,c.push({text:r,Hq:"",
vA:0,tDa:f.length-k,CWa:void 0,Vua:[],Xua:-1}),e[r]=!0)}}}return c}function Tqc(a,b,c){b=Mqc(a.length,Math.min(a.length,b));var d={};y(b,function(b){b=a[b];var e=Ca(b)?b:b.query;d[e.toLowerCase()]={text:e,Hq:Ca(b)?"":b.Hq,vA:c,tDa:0,CWa:Ca(b)?void 0:b.type,Vua:[],Xua:-1}});return d};function yW(){$G.call(this,"",null,!1)}w(yW,$G);yW.prototype.wD=function(a,b){if(2==a.vA||1==a.vA)return yW.$.wD.call(this,a.text,b);var c=this.Za(),d=this.Mm(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.tDa)+a.text;e||(f+=" ");a=yW.$.wD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.qk;b.blur();b.focus();this.B3(f.length);return a};
yW.prototype.Ng=function(a){var b=yW.$.Ng.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,kfb(b)&&b.IG()&&a.preventDefault(),b=!0);return b};function Uqc(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Jt({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Jt({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Jt({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function Vqc(a){this.wb=a||xl()}
Vqc.prototype.lA=function(a,b,c){b=T(Uqc);var d=this.wb.bb("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.wb.Df(d,a.text);var d=this.wb.bb("waffle-assistant-answers-ac-entity-icon",b),e=this.wb.bb("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.wb.bb("waffle-assistant-answers-ac-session-query-icon",b);Q(d,0==a.vA);Q(e,2==a.vA);Q(f,1==a.vA);d="";switch(a.vA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&fp(c,d);this.wb.appendChild(c,b)};function zW(a,b,c,d,e,f,h,k,l,m,q){iW.call(this,q);this.vf=c;this.Fg=d;this.Ag=e;this.Qe=a;this.zb=h;this.Ia=m;this.Pa=this.O=this.J=this.Xb=null;this.Ca=new yW;this.Ca.cIa=!0;this.Ca.Oa=!0;this.Xa=new Oqc(this.Ca);a=new YG(null,new Vqc(q));this.H=new UG(this.Xa,a,this.Ca);F(this,this.H);this.Kb=f;this.fb=this.Oa=this.F=null;this.pb=k;this.pe=this.Mb=!1;this.ib=qi(new pi,10).build();this.De=new rh;this.Ub=l;this.qa={};this.V=this.Kc=this.D=this.zc=null;this.Zd=Ii.getInstance();this.Qb="";this.$a=
null}w(zW,iW);p=zW.prototype;p.Ga=function(){zW.$.Ga.call(this);var a=this.H.we();a.className="waffle-assistant-answers-ac-renderer";a.$N="waffle-assistant-answers-ac-row";a.i7="waffle-assistant-answers-ac-active";a.Bpa="waffle-assistant-answers-ac-highlighted"};p.Sa=function(){zW.$.Sa.call(this);this.Ca.C=this.H;this.H.jZ=!1;this.H.jca=6;this.getHandler().R(this.H,"update",this.Xlb);this.oI(null==this.F)};
p.ata=function(a,b){zW.$.ata.call(this,a,b);b=this.Ba();var c=this.Z;b.appendChild(a,T(Dqc));this.Kc=b.bb("waffle-assistant-answers-input",a);this.V=b.bb("waffle-assistant-answers-query-box",a);this.J=new ls("",new dW,this.Ba());c.Wa(this.J);this.J.mb(b.bb("waffle-assistant-answers-clear-query-button",this.V));this.Pa=new lV(!1,"#4285f4");c.Wa(this.Pa);this.zc=b.bb("waffle-assistant-answers-spinner-container",this.V);this.Pa.render(this.zc);this.D=b.bb("waffle-assistant-answers-input-box",this.V);
zfb(this.Ca,this.D);eW(this.J.getElement(),"Clear query");c.getHandler().R(this.V,"submit",u(this.KFb,this)).R(this.V,"focus",u(this.gHa,this,!0),!0).R(this.V,"blur",u(this.gHa,this,!1),!0).R(this.J,"action",u(this.l7a,this)).R(this.D,"input",u(this.LWb,this)).R(this.D,"focus",u(this.bUa,this));this.J.setVisible(!1)};p.v8=function(){Bfb(this.Ca,this.D);this.J.setVisible(!1);this.Pa.dispose();this.Pa=null;zW.$.v8.call(this)};
p.oI=function(a){var b=this;if(this.Kc){Q(this.Kc,!a);var c=Du;c&&c.dispatchEvent("resize")}a?(this.$a&&this.$a.dispose(),this.$a=new Fk(function(){zW.$.oI.call(b,a)},300,this),F(this,this.$a),this.$a.start()):(this.$a&&this.$a.stop(),zW.$.oI.call(this,a))};p.uh=da("Xb");
function Wqc(a,b,c,d){var e=vb(Ec(c,1),function(a){return a.getName()}),f=[],h=[];y(Ec(c,2),function(a){f.push(a.getName());h=h.concat(Ec(a,2))});Pqc(a.Xa,e,f,h);Xqc(a.Qe).then(function(a){this.Xa.F=a;nm(this.Ba())==this.D&&this.bUa()},null,a);e=a.F&&a.Oa&&b&&d&&(!a.F.equals(b)||!a.Oa.equals(d));a.F=b;a.Oa=d;a.fb=c;if(e&&an)for(c=vb(a.C,function(a){if(a instanceof sW||a instanceof uW)return a.WO().C}),a.HZ(),d=0;d<c.length;d++)if(e=c[d]){var k=new SV;N(k,1,5);AW(a,k,void 0,e)}a.oI(null==b)}
p.reset=function(){vT(this.qa);vT(this.Xa.D);var a=this.Xa;a.F=[];a.C.clear();this.O=null};p.Xlb=function(a){if(a.row)if(a=a.row,2==a.vA){var b=uqc(1,a.Vua,a.Xua,2);AW(this,b,a.Hq);this.Kb.fc(2652,this.ib)}else 0==a.vA?(this.Mb=!0,this.Kb.fc(2651,this.ib)):1==a.vA&&(a=new SV,N(a,1,3),AW(this,a))};p.gHa=function(a){jp(this.V,"waffle-assistant-answers-query-box-focused",a);this.H.Of()&&!a&&this.H.Ij()};p.LWb=function(){this.J.setVisible(!!Tpc(this.D))};
p.bUa=function(){this.H.Dw(this.D);var a=ib(Tpc(this.D));this.Ca.B3(a.length);hfb(this.H,a||"  ");this.H.update(!0)};
function AW(a,b,c,d){var e=a.Ia.L.Qs();N(b,13,e);e=new TV;ci(e,5,b);d=d||Xa(Tpc(a.D));if(!a.Xb||3<=a.Xb.getStatus().getState().C)if(a.qa[d])Yqc(a,d,!1);else{c=new qW(d,null,null,null,2,a.Ia);Zqc(a,c,!0,e);return}else{var f=a.qa[d];f&&f instanceof uW&&2==f.WO().error&&delete a.qa[d]}if(d&&a.F)if(a.qa[d])a.Kb.fc(2681,a.ib),Yqc(a,d,!0);else{var f=$qc(),h=ai(ai(f,MS,46),TV,4);N(h,2,a.Mb);f=ri(qi(new pi,10),f).build();a.Kb.fc(2635,f);a.Mb=!1;f=yv(a.F.rect);b=Bk(Nj(Ck(Pj(Qj(a.Xb.Qf("/answers/parse").Wf("q",
d,"qt",M(b,1),"gid",a.F.Xc,"range",f),u(a.Pk,a,d,e)),u(a.E0b,a,d,e)),"POST"),2));an&&a.Oa&&(e=0==a.Oa.rect.width||0==a.Oa.rect.height?"":yv(a.Oa.rect),b.Wf("headerRange",e));c&&b.Wf("sgfml",c);b.$e();a.Qb=Ji(a.Zd,tj.Nwa);arc(a,!0)}else Upc(a.D,"");a.D.blur();a.J.setVisible(!!d);a.H.Of()&&a.H.Ij()}function Yqc(a,b,c){var d=a.qa[b];d!=qb(a.C)&&(1<a.C.length&&brc(a),c&&crc(a,d.WO()).then(function(a){drc(this,d,a)},null,a),kpc(a,d))}
p.KFb=function(a){a.stopPropagation();a.preventDefault();a=new SV;N(a,1,2);AW(this,a)};p.l7a=function(){Upc(this.D,"");this.J.setVisible(!1)};p.E0b=function(a,b){if(this.F){var c=M(ai(b,SV,5),1),c=1==c||4==c?Aoc.rBa:Aoc.OBa,d=$qc(),e=ai(ai(d,MS,46),TV,4);N(e,1,c);N(b,1,c);c=ri(qi(new pi,10),d).build();this.Kb.fc(2640,c);erc(this,a,b)}};function erc(a,b,c){arc(a,!1);b=new qW(b,null,null,null,3,a.Ia);Zqc(a,b,!1,c);frc(a)}
p.Pk=function(a,b,c){this.F&&this.pb.C.D.ze.then(function(){var d=null,e=null,f=!1,h=ai(b,SV,5),k=M(h,1),l=$qc(),k=1==k||4==k?Aoc.rBa:Aoc.OBa,m=ai(ai(l,MS,46),TV,4);N(m,1,k);N(b,1,k);l=ri(qi(new pi,10),l).build();if(c.rl()){e=this.De.cd(WV.Ra(),c.og());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.Kb.fc(q,l)}q=B(e,10);N(h,4,q);q=B(e,11);N(h,5,q);yc(e,16)&&(q=B(e,16),N(h,16,q));if(1==f){erc(this,
a,b);return}if(2==f){e=-1!=grc(a);h=-1!=Xpc(a);f=4;d=ai(b,SV,5);e?(f=5,N(d,8,2)):h&&(f=7,N(d,8,1));h=new qW(a,null,null,null,f,this.Ia);e?(e=new uW(h,!0,this.Ub,!0,this.Ba()),hrc(this,h,e,b)):Zqc(this,h,!0,b);arc(this,!1);frc(this);return}q=yc(e,2)?B(e,2):null;f=!0;if(q){k="";d=irc(this.pb,q,this.F,!!this.fb&&!!B(this.fb,4));N(h,14,!!d);if(!d){if(m=q.match(/([A-Z]*)\(/)){var r=ai(ai(l.C?ai(l.C,hi,4):null,MS,46),TV,4);N(r,7,m[1]);N(b,7,m[1])}this.Kb.fc(2645,l)}d&&jrc(d)||(l=this.pb,r=this.F,k="="!=
q[0]?"="+q:q,m=krc(l),r=lrc(m,r),k=Oxb(l.C,k,m,r.row,r.zj));l=yc(e,19)?irc(this.pb,B(e,19)||"",this.F,!!this.fb&&!!B(this.fb,4)):d;d=new qW(a,d,"="!=q[0]?"="+q:q,e,null,this.Ia,l);k&&d.L.push(k);d.Rm()&&(q=bqc(d),l=new voc,q&&(l=yqc(q)),N(l,1,d.F),ci(h,15,l))}else yc(e,9)&&(q=e.getError(),d=new qW(a,null,null,e||null,6,this.Ia),l=B(q,2),N(h,6,l),yc(q,3)&&(q=B(q,3),N(h,12,q)))}else this.Kb.fc(2640,l);d||(d=new qW(a,null,null,e||null,4,this.Ia));arc(this,!1);Zpc(d)?mrc(this,d,f,b):Zqc(this,d,f,b);frc(this)},
function(){erc(this,a,b)},this)};function frc(a){""!=a.Qb&&(Ki(a.Zd,a.Qb),a.Qb="")}function nrc(a){if(null!=a.Hq)return Jqc;switch(a.error){case 4:case 6:return 0<a.O.length?Kqc:wW;case 5:return wW}return Lqc}function $qc(){var a=new TV;N(a,8,asa);var b=new MS;ci(b,4,a);a=new hi;ci(a,46,b);return a}function grc(a){return Ab(Vpc,function(b){return Qa(a,b)})}
function orc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=B(b[d],2),f=!!a.fb&&!!B(a.fb,4),e=irc(a.pb,e,a.F,f);jrc(e)&&(e={query:B(b[d],1),Hq:B(b[d],2),type:b[d].getType()},yc(b[d],5)&&(e.$Ha=B(b[d],5)),c.push(e))}return yi(c)}function mrc(a,b,c,d){c=new sW(b,a.vf,a.Fg,a.Ag,a.Kb,a.Ub,a.zb,c,a.Ia,a.pe,a.Ba());hrc(a,b,c,d)}function Zqc(a,b,c,d){c=new uW(b,c,a.Ub,!1,a.Ba());hrc(a,b,c,d)}
function hrc(a,b,c,d){brc(a);var e=crc(a,b,d);prc(a,c);qrc(a);Zpc(b)&&Qqc(a.Xa,b.C);e.then(function(a){if(d){var b=$qc(),e=ai(b,MS,46);ci(e,4,d);b=ri(qi(new pi,10),b).build();this.Kb.fc(2781,b)}drc(this,c,a)},null,a);c.$la()&&(a.qa[b.C]=c);a.getHandler().R(c,"rc",a.wNa)}function drc(a,b,c){b instanceof uW&&null!=c&&Ip(c.getElement())&&(b=b.getElement(),Q(b,!1),a.getHandler().R(c,"rc",a.wNa))}function brc(a){rrc(a);y(a.C,function(a){a instanceof uW&&(a=a.getElement(),Q(a,!0))});src(a)}
function src(a){0!=a.C.length&&(a.O?kpc(a,a.O):(a.O=new Gqc(a.Ba()),prc(a,a.O)))}function rrc(a){y(a.C,function(b){b instanceof sW||b instanceof uW||b==a.O||a.aI(b)})}
function crc(a,b,c){var d=nrc(b),e=null;d==Jqc||d==Kqc?0<b.O.length&&(e=orc(a,b)):d==wW&&(e=trc(a.Qe));var f=null;return e?(f=new vW(new XU,a.Ub,e,d,b,a.Ba()),prc(a,f),a.Kb.fc(2769,a.ib),a.getHandler().R(f,"sqc",u(a.$Db,a)),e.then(function(a){if(c){var b=ai(c,SV,5);Db([Jqc,Kqc],f.F)?(a=wqc(a),ci(b,7,a)):Db([Iqc,wW],f.F)&&(a=xqc(a),ci(b,9,a))}return f},null,a)):yi(f)}
p.$Db=function(a){Upc(this.D,a.J);this.D.focus();var b=a.V,b=1==b?uqc(b,a.C,a.F,3):vqc(b,a.C,a.F,a.Z);AW(this,b,a.L);this.Kb.fc(2762,this.ib)};function arc(a,b){Q(a.zc,b);Q(a.Ba().bb("waffle-assistant-answers-button-container",a.V),!b);a.Pa&&a.Pa.setActive(b)}function prc(a,b){b.hf(a.Fd());a.C.push(b);a.Ye&&(a.L.Zh(b,0,!0),b.JK());cpc(b,!0)}function qrc(a){for(var b=a.C;5<b.length;)a.aI(b[0])}p.HZ=function(){zW.$.HZ.call(this);this.reset()};
p.wNa=function(a){var b=this,c=this.Ba();a=a.target;if(a instanceof sW)this.aI(a),tW(this.zb,"Answer removed",c,u(this.VAb,this,a));else if(a instanceof uW)this.aI(a),tW(this.zb,"Card removed",c);else if(a instanceof vW&&a.C&&!Zpc(a.C)){var d=a.C.C;y(this.C,function(a){a instanceof uW&&a.WO().C==d&&(b.aI(a),tW(b.zb,"Card removed",c))})}a=this.C;!this.O||a[0]!=this.O&&a[a.length-1]!=this.O||(this.aI(this.O),this.O=null)};
p.VAb=function(a){mrc(this,a.WO(),a.$la());tW(this.zb,"'Remove answer' undone",this.Ba())};p.aI=function(a){if(a.wc()){if(a instanceof sW||a instanceof uW)delete this.qa[a.WO().C],a==qb(this.C)&&rrc(this);zW.$.aI.call(this,a)}G(a)};function urc(){var a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Jt({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+yr("Ask a question about your data")+'" /></div></form></div>');return V(a)};function vrc(a,b){this.C=a;this.D=b}function irc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=krc(a);c=lrc(e,c);(a=koc(a.C,b,e,c.row,c.zj))&&d&&a.length<a[0].length&&(a=Nqc(a));return a}function jrc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function krc(a){a=Xu(a.D);return null!=a?a.toString():"0"}
function lrc(a,b){var c={row:0,zj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Lc()+1?c.row=b.Lc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Sc()+1&&(c.zj=b.Sc()+1));return c};function wrc(a){var b=[];if(yc(a,25)&&(a=B(a,25)))for(var c=0;c<zc(a,1);c++){var d=B(a,1,c);if(yc(d,2)){var e=B(d,2);e&&b.push(xrc(e,yrc(d)))}}return b}function zrc(a){var b=wrc(a);yc(a,6)&&(a=B(a,6))&&b.push(xrc(a,0));return b}function yrc(a){return(a=yc(a,4)?B(a,4):0)?a:0}function xrc(a,b){return{name:a,g5a:b}};function Arc(a,b,c){this.Ca=a;this.Ia=b;this.D=[];this.F=[];this.L=[];this.O=[];this.V=[];this.Z=[];this.C=new jg;this.J=new jg;this.qa=new jg;this.H=new jg;Brc(this,c)}function Crc(a,b){return kg(a,b)?a.get(b).values.jd():[]}
function Brc(a,b){for(var c=new og,d=new og,e=0;e<b.length;e++){for(var f=zrc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(kg(a.Ca,m)){var q=a.Ca.get(m);c.add(q);h.push(q)}kg(a.Ia,m)&&(m=a.Ia.get(m),d.add(m),k.push(m))}Drc(a,h,k)}a.D=c.jd();a.F=d.jd();Tb(a.D);Tb(a.F);a.L=vb(a.C.jd(),function(a){return a.key});Tb(a.L);a.O=vb(a.J.jd(),function(a){return a.key});Tb(a.O);a.V=vb(a.qa.jd(),function(a){return a.key});Tb(a.V);a.Z=vb(a.H.jd(),function(a){return a.key});Tb(a.Z)}
function Drc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)BW(a.C,b[d],b[e]),BW(a.C,b[e],b[d]);for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)BW(a.J,b[d],c[e]),BW(a.qa,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)BW(a.H,c[b],c[d]),BW(a.H,c[d],c[b])}function BW(a,b,c){var d;kg(a,b)?d=a.get(b).values:d=new og;d.add(c);a.set(b,{key:b,values:d})};function Erc(a,b){this.C=a;for(var c=new jg,d=0;d<zc(a,2);d++)c.set(a.Ed(d).getName().toLowerCase(),d);this.O=c;c=new jg;for(d=0;d<zc(a,1);d++)c.set(B(a,1,d).getName().toLowerCase(),d);this.Ca=c;c=[];for(d=0;d<zc(a,2);d++)CW(a.Ed(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<zc(a,1);d++)CW(B(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<zc(a,1);d++){for(var e=B(a,1,d).getName(),f=!0,h=0;h<Frc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+Frc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ia=
c;this.qa=Grc(a,0);this.V=Grc(a,1);c=[];for(d=0;d<zc(a,2);d++).8<=B(a.Ed(d),6)&&c.push(d);this.Z=c;c=[];for(d=0;d<zc(a,2);d++)e=a.Ed(d),.95<=Ec(e,2).length/B(e,8)&&c.push(d);this.Pa=c;c=[];for(d=0;d<zc(a,3);d++)f=a.Ed(B(a,3,d)),e=Ec(f,2).length/B(f,8),f=zc(f,3)/zc(f,2),.5<e||.3>f||c.push(B(a,3,d));this.Oa=c;this.F=Hrc(zc(a,2));this.H=Hrc(zc(a,1));this.D=new Arc(this.O,this.Ca,b)}function Hrc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}
function Grc(a,b){for(var c=[],d=0;d<zc(a,2);d++)a.Ed(d).getType()==b&&c.push(d);return c}function Irc(a,b){if(0==a.length&&0==b.length)return-1;for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=Jrc(c,a[d]);for(a=0;a<b.length;a++)d=Jrc(c,b[a]),c=0<d.length?d:c;return 0<c.length?c[xW(c.length)]:-1}function DW(a,b,c,d,e,f){var h=[a.J,a.D.D],k=[a.F];b&&(k.push(a.qa),k.push(a.Z));c&&k.push(a.Oa);d&&k.push(a.Pa);null!=f&&-1!=f?h.push(Crc(a.D.J,f)):e&&h.push(a.D.O);return Irc(k,h)}
function EW(a,b,c){var d=[a.L,a.D.F],e=[a.H];b&&e.push(a.Ia);c&&d.push(a.D.V);return Irc(e,d)}function Krc(a,b){for(var c=5;;){var d=a.C.Ed(b),e=xW(zc(d,2));c--;if(CW(RV(d,e))||0==c)return e}}function Lrc(a,b){for(var c=5;;){var d=a.C.Ed(b),e=xW(zc(d,3)),e=B(d,3,e);c--;if(CW(RV(d,e))||0==c)return e}}function FW(a,b){b=a.C.Ed(b);a=b.getName();CW(a)||(b=Mrc(Ec(b,7)),a=null==b?a:b);return a}function GW(a,b){b=B(a.C,1,b);a=b.getName();CW(a)||(b=Mrc(Ec(b,2)),a=null==b?a:b);return a}
function Mrc(a){for(var b=0;b<a.length;b++)if(CW(a[b]))return a[b];return null}function CW(a){return null==a?!1:50>=a.length}function Nrc(a){for(var b=Mqc(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}function Jrc(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var Frc=["average","total","sum","mean","median"];function Orc(a,b){this.C=[];this.F=[];this.H=this.V=this.J=this.D=null;this.O=new og;this.L=new og;this.Z=a;this.Kb=b;this.qa=qi(new pi,10).build()}Orc.prototype.reset=function(){this.C=[];this.F=[];this.D&&(this.D.cancel(),this.D=null);this.L=new og;this.O=new og};Orc.prototype.uh=da("H");function Xqc(a){return Hra&&a.D?a.D.then(function(){return this.F.slice()},null,a):yi(a.C.slice())}function Prc(a){Tb(a,function(a,c){return c.weight-a.weight});return vb(a,function(a){return a.Wua})}
function Qrc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;default:return.3}}function HW(a,b,c,d,e){e=Math.pow(Math.random(),1/(Qrc(d)*(void 0===e?1:e)));a.L.contains(c)||(b.push({Wua:{query:c,Hq:void 0,type:d},weight:e}),a.O.add(d),a.L.add(c))}
function IW(a,b){return!a.O.contains(b)}function trc(a){return Xqc(a).then(function(a){return 3>=a.length?a:Pb(a,0,3)},null,a)}function Rrc(a,b){var c=[];b=wrc(b);for(var d=0;d<b.length&&-1!=a.Ca.get(b[d].name.toLowerCase(),-1);d++)c.push(b[d]);return c}function Src(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=Trc;break a;case 4:a=Urc;break a}a=Vrc}return a[xW(a.length)]}
function Wrc(a){var b=null;a.D=new wi(function(a){if(!this.H||3<=this.H.getStatus().getState().C)this.F=this.C,a();var c=yv(this.J.rect),e=vb(this.C,function(a){return a.query});b=Ck(Bk(Nj(Pj(Qj(this.H.Qf("/answers/parsesuggestions").Wf("gid",this.J.Xc,"range",c),u(function(b){Xrc(this,b).then(a)},this)),u(function(b){8==b.errorCode&&this.Kb.fc(2833,this.qa);this.F=this.C;a()},this)).setContent(["queries",Uh(e)]).setTimeout(2E3),1)),"POST").$e()},a);Di(a.D,function(){b&&b.dispose()})}
function Xrc(a,b){return a.Z.C.D.ze.then(function(){var a=[];if(b.rl())for(var d=b.og(),e=0;e<d.length;e++){var f;if(f=d[e])f=!!this.V&&!!B(this.V,4),f=irc(this.Z,d[e],this.J,f),f=jrc(f);f&&(this.C[e].Hq=d[e],a.push(this.C[e]))}this.F=a},function(){this.F.length=0},a)}var Yrc="Minimum Maximum Most Least Highest Lowest".split(" "),Zrc=["Top","Bottom"],Vrc=["Average","Median"],Trc=["Total","Average","Median"],Urc=["Median"],$rc=["before","after"];function JW(a,b,c,d,e,f,h,k){jW.call(this,1,f,e,k);this.pb=c;this.Ca=null;this.qa=new ls("",new cW,this.Ba());this.Wa(this.qa);this.Ia=new ls("",new cW,this.Ba());this.Wa(this.Ia);a=new Lxb(a,!0,!0);a=new vrc(a,c);this.fb=new rqc(e);this.O=new Orc(a,e);this.L=new zW(this.O,0,b,c,d,e,this.$a,a,this.fb,h,k);c=asc;this.D=new Rpc(b,c.V0a,c.W0a);F(this,this.D);this.F=this.H=null;this.ib=qi(new pi,10).build()}w(JW,jW);
var asc={V0a:"waffle-assistant-answers-styled-border",W0a:"waffle-assistant-answers-styled-rect",g1a:"waffle-assistant-answers-input-box",G2a:"waffle-assistant-answers-query-box",Fsc:"waffle-assistant-answers-query-box-focused",w1a:"waffle-assistant-answers-learn-more",ync:"waffle-assistant-answers-logging-message-container",k2a:"waffle-assistant-answers-logging-opt-out"};p=JW.prototype;p.Ga=function(){JW.$.Ga.call(this);var a=T(urc);this.Ba().appendChild(lpc(this),a)};
p.Sa=function(){JW.$.Sa.call(this);var a=asc,b=this.bb(a.G2a),c=this.bb(a.g1a);this.Ia.mb(this.bb(a.k2a));this.qa.mb(this.bb(a.w1a));this.getHandler().R(b,"focus",this.jAb,!0).R(b,"blur",this.hAb,!0).R(b,"mouseover",this.lAb).R(b,"mouseout",this.kAb).R(b,"click",this.iAb).R(c,"input",this.F0b).R(this.Ia,"action",this.Gyb).R(this.qa,"action",this.nvb).R(dv(this.pb),"Da",Bic(this.G0b,25,this));this.setVisible(null!=this.H);bsc(this,Gra&&Jra&&bn("showAnswersLoggingOptOut"))};p.IVa=Rf;p.kOa=Sf;
p.gua=Rf;p.J4=n("Answers");p.hwa=n(1);p.Yia=function(a){return 3==a||0==a};p.gwa=function(a,b){Tb(a,function(a,b){return B(b,2)-B(a,2)});for(var c=[],d=null,e=0;e<a.length;e++){var f=Fc(a[e],1);3==f?d=a[e]:0==f&&c.push(B(a[e],8))}d&&B(d,2)?(e=b||null,f=0==B(d,11)?DS(B(d,10)):null,0<zc(d,4)?csc(this,DS(B(d,4,0)),B(d,9),f,c):csc(this,e,B(d,9),f,c),this.F||(JW.$.gwa.call(this,a,b),this.getHandler().R(this.F,"sqc",this.ZDb))):this.lW(!0)};
p.g8=function(a){if(!this.F){var b=trc(this.O);this.F=new vW(a,this.fb,b,Iqc,void 0,this.Ba())}return this.F};p.kEa=g("L");p.ppa=function(){return this.kb()};
p.lW=function(a,b,c){this.O.reset();(a||b)&&this.F&&(JW.$.lW.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||t(b)&&!b)this.F&&(JW.$.lW.call(this,a,b,c),this.F.dispose(),this.F=null),this.wc()&&(this.O.reset(),this.H=null,a=this.L,a.wc()&&(b=a.Xa,b.F=[],b.C.clear(),a.D&&Upc(a.D),a.HZ(),a.F=null,a.oI(!0),a.J&&!a.J.isDisposed()&&a.J.setVisible(!1),a.Mb=!1),this.setVisible(!1),this.$b()&&pW(this.D));c&&this.L.reset()};p.uh=function(a){this.Ca=a;this.L.uh(a);this.O.uh(a)};
p.setActive=function(a){JW.$.setActive.call(this,a);a?oW(this.D,this.H):pW(this.D)};function dsc(a,b){a.$b()&&(b?pW(a.D):oW(a.D,a.H))}function bsc(a,b){Q(a.bb("waffle-assistant-answers-logging-message-container"),b)}function esc(a,b){a=a.bb("waffle-assistant-answers-query-box");jp(a,"waffle-assistant-answers-query-box-focused",b)}p.G0b=function(){this.$b()&&oW(this.D,this.H)};p.jAb=function(){esc(this,!0);oW(this.D,this.H)};p.hAb=function(){esc(this,!1);this.$b()||pW(this.D)};
p.lAb=function(){oW(this.D,this.H)};p.kAb=function(){this.$b()||pW(this.D)};p.iAb=function(){fsc(this,"")};p.F0b=function(){var a=this.bb("waffle-assistant-answers-input-box");fsc(this,a.value);a.value=""};p.ZDb=function(a){var b=this;fsc(this,a.J);var c=uqc(1,a.C,a.F,1),d=new Fk(function(){AW(b.L,c,a.L)},300);F(this,d);d.start();this.wu().fc(2652,this.ib)};
function fsc(a,b,c){a.setActive(!0);a.dispatchEvent("re");var d=new Fk(function(){var d=a.L;Upc(d.D,b);d.D.focus();a.L.pe=c||!1},300);F(a,d);d.start()}
function csc(a,b,c,d,e){var f=c||new UU;a.H=b;var h=a.O,k=e;h.reset();var k=Ira?k:[],l=[],m=new Erc(f,k);if(Ira)for(var q=k,r=0;r<q.length;r++){var v=q[r];switch(v.getChartType()){case "BarChart":var x=h,z=m,D=l;if(IW(x,13)||IW(x,2)){var L=B(v,6);if(L&&-1!=z.O.get(L.toLowerCase(),-1)){var O=Rrc(z,v);1<O.length&&(Vm&&IW(x,23)?HW(x,D,"Scatter chart of "+O[0].name+" vs "+O[1].name,23,2):IW(x,2)&&HW(x,D,"Correlation of "+O[0].name+" and "+O[1].name,2,1.5))}}break;case "ScatterChart":var S=h,aa=l,ia=Rrc(m,
v);1<ia.length&&(Vm&&IW(S,23)?HW(S,aa,"Scatter chart of "+ia[0].name+" vs "+ia[1].name,23,2):IW(S,2)&&HW(S,aa,"Correlation of "+ia[0].name+" and "+ia[1].name,2,1.5));break;case "PieChart":for(var ja=h,oa=l,xa,ya=[],Na=wrc(v),fb=0;fb<Na.length&&-1!=m.O.get(Na[fb].name.toLowerCase(),-1);fb++)ya.push(Na[fb]);xa=ya;1==xa.length&&4==xa[0].g5a&&(Vm&&IW(ja,20)?HW(ja,oa,"Bar chart of distribution of "+xa[0].name,20,2):IW(ja,14)&&HW(ja,oa,"Distribution of "+xa[0].name,14,1.5))}}if(IW(h,1)){var Ta=m.C,Ja=EW(m,
!1,!0),sb=DW(m,!0,!1,!0,!0,Ja);if(-1!=sb&&-1!=Ja){var fc=10<=zc(Ta.Ed(sb),2)?"5 ":"",cd=FW(m,sb),zd=GW(m,Ja);cd!=zd&&HW(h,l,Zrc[xW(Zrc.length)]+" "+fc+cd+" by "+zd,1)}}if(IW(h,2)&&1<zc(m.C,1)){a:if(2>m.H.length)var Df=[-1,-1];else{var kf=Irc([m.H],[m.L,m.D.F,m.D.Z]);if(-1!=kf){var Bb=Crc(m.D.H,kf);if(0<Bb.length){var ge=[kf],ne=xW(Bb.length);ge.push(Bb[ne]);Df=ge;break a}}Df=Nrc(2<=m.L.length?m.L:m.H)}var Dc=Df,Gd=GW(m,Dc[0]),lf=GW(m,Dc[1]);Gd!=lf&&HW(h,l,"Correlation of "+Gd+" and "+lf,2)}if(IW(h,
3)){var Lg=m.C,yj=EW(m,!0);-1!=yj&&HW(h,l,Src(Ec(B(Lg,1,yj),3))+" of "+GW(m,yj),3)}if(IW(h,5)){var zj=m.C,Hk=EW(m,!0,!0),hl=DW(m,!0,!0,!1,!0,Hk);if(-1!=Hk&&-1!=hl){var Sp=GW(m,Hk),lr=zj.Ed(hl),mr=FW(m,hl);if(0<zc(lr,3)&&mr!=Sp){var nr=Lrc(m,hl);HW(h,l,Src(Ec(B(zj,1,Hk),3))+" of "+Sp+" when "+mr+" is "+RV(lr,nr),5)}}}if(IW(h,9)){var Tp=EW(m,!1,!0),En=DW(m,!0,!1,!0,!0,Tp);if(-1!=En&&-1!=Tp){var Lo=GW(m,Tp),vm=FW(m,En);vm!=Lo&&HW(h,l,vm+" with "+Yrc[xW(Yrc.length)]+" "+Lo,9)}}if(IW(h,10)&&0<zc(m.C,1)){var Fn=
GW(m,EW(m));HW(h,l,Yrc[xW(Yrc.length)]+" "+Fn,10)}if(IW(h,11)){var Lu=m.C,Mo=DW(m,!0,!0,!1,!1,-1);if(-1!=Mo){var Ns=FW(m,Mo);0<zc(Lu.Ed(Mo),3)&&HW(h,l,"Most frequent "+Ns,11)}}if(IW(h,12)){var Mu=m.C,No=EW(m,!0);a:{if(1==m.V.length){var tk=m.V[0];if(!B(m.C.Ed(tk),5)){var XA=tk;break a}}XA=-1}var or=XA;if(-1!=or&&-1!=No){var Nu=GW(m,No),hF=Mu.Ed(or);if(0<zc(hF,2)){var Cb=Krc(m,or);HW(h,l,Src(Ec(B(Mu,1,No),3))+" of "+Nu+" "+$rc[xW($rc.length)]+" "+RV(hF,Cb),12)}}}if(IW(h,15)){var RS=m.C,zB=EW(m,!0),
Yu=DW(m,!1,!0,!1,!0,zB);if(-1!=zB&&-1!=Yu){var Cx=GW(m,zB),SS=FW(m,Yu);if(SS!=Cx){var Dx=RS.Ed(Yu);if(2<=zc(Dx,3)){var vF=Mqc(zc(Dx,3),2);HW(h,l,"Compare "+Src(Ec(B(RS,1,zB),3))+" "+Cx+" for "+SS+" "+RV(Dx,B(Dx,3,vF[0]))+" and "+RV(Dx,B(Dx,3,vF[1])),15)}}}}if(IW(h,16)){var TS=DW(m,!0,!0,!1,!1);if(-1!=TS){var wF=FW(m,TS);HW(h,l,"List unique values in "+wF,16)}}if(IW(h,17)){var vL=m.C,xF=DW(m,!0,!0,!1,!1);if(-1!=xF){var US=vL.Ed(xF),yF=FW(m,xF);if(!(1>zc(US,3))){var zF=Lrc(m,xF);HW(h,l,"What percentage of "+
yF+" is "+RV(US,zF),17)}}}if(IW(h,13)){var at=m.C,bt=EW(m,!0,!0),AF=DW(m,!0,!0,!1,!0,bt);if(-1!=bt&&-1!=AF){var BF=GW(m,bt),Ex=FW(m,AF);Ex!=BF&&HW(h,l,Src(Ec(B(at,1,bt),3))+" of "+BF+" by "+Ex,13)}}if(Vm&&IW(h,18)){var CF=EW(m);-1!=CF&&HW(h,l,"Histogram of "+GW(m,CF),18,2)}var Zu=3>l.length;if((Zu||0==xW(5))&&IW(h,7)){var wL=m.C,Fx=EW(m,!1,!0),ct=DW(m,!1,!1,!1,!0,Fx);if(-1!=ct&&-1!=Fx){var DF=wL.Ed(ct),xL=FW(m,ct),EF=GW(m,Fx);if(0<zc(DF,2)&&xL!=EF){var VS=Krc(m,ct);HW(h,l,"Show "+EF+" for "+xL+" "+
RV(DF,VS),7)}}}if((Zu||0==xW(5))&&IW(h,8)){var yL=m.C;a:if(2>m.F.length)var Gx=[-1,-1];else{var A2=[m.J,m.D.D,m.D.L],$u=[m.F];$u.push(m.qa);$u.push(m.Z);var Hx=Irc($u,A2);if(-1!=Hx){var Yp=Crc(m.D.C,Hx);if(0<Yp.length){var Ix=[Hx],zm=xW(Yp.length);Ix.push(Yp[zm]);Gx=Ix;break a}}var Jx=Nrc(2<=m.J.length?m.J:m.F);Jx[0]!=Hx&&(Jx[1]=Jx[0],Jx[0]=Hx);Gx=Jx}var FF=Gx,dha=FF[0];if(1<zc(yL,2)&&-1!=dha){var WS=FF[1],eha=yL.Ed(WS),B2=FW(m,WS),fha=FW(m,dha);if(0<zc(eha,2)&&B2!=fha){var ACa=Krc(m,WS);HW(h,l,"What is "+
fha+" where "+B2+" is "+RV(eha,ACa),8)}}}h.C=Prc(l);h.J=b;h.V=f;Hra&&Wrc(h);a.setVisible(null!=b);Wqc(a.L,b,f,d);a.$b()&&oW(a.D,a.H)}p.Gyb=function(a){a.stopPropagation();a.preventDefault();this.Ca&&(Ck(Pj(Qj(this.Ca.Qf("/answers/logoptout"),u(this.bwb,this)),u(this.awb,this)),"POST").$e(),this.wu().fc(2663,this.ib))};p.nvb=function(a){a.stopPropagation();a.preventDefault();Po("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};
p.bwb=function(a){a.rl()&&bsc(this,!1)};p.awb=ca();function gsc(){var a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colours for <span class="waffle-assistant-banding-range"></span></div>'+hsc()+"</div>");return V(a)}
function isc(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+hsc()+"</div>")}function hsc(){var a=""+U(ss({Ce:"waffle-assistant-formatting-edit-button",content:ur("Edit"),style:4}));return V(a)};function jsc(a,b,c){gW.call(this,a,c);a=vb(Ec(this.D,7),Tic);this.C=new OT(!1,a,7);this.Wa(this.C);this.J=new ts("",this.Ba());this.Wa(this.J);this.Kb=b;this.H=!1;this.F=-1}w(jsc,gW);var ksc={Lfa:"waffle-assistant-banding-color-picker-container",Vfa:"waffle-assistant-formatting-edit-button",IJ:"waffle-assistant-banding-range"};p=jsc.prototype;p.Ga=function(){jsc.$.Ga.call(this);hW(this).appendChild(T(gsc))};
p.Sa=function(){jsc.$.Sa.call(this);this.getHandler().R(this.J,"action",this.mrb).R(this.C,"banding-scheme-changed",this.pmb);this.Kb.C(2768)};p.OI=function(a){var b=this.bb(ksc.Lfa);this.C.render(b);Zic(this.C);var b=this.bb(ksc.IJ),c=B(this.D,4,0),d=xh(c);Zl(b,yv(d));lsc(this,c);b=this.bb(ksc.Vfa);this.J.mb(b);a()};p.DI=function(){cp(this.La,"Suggested alternating background colours");Lq(this.C,"Choose a colour scheme")};p.kG=n("assistantBandingFeedback");p.hM=n(2672);p.gM=n(2671);
p.mrb=function(a){zn.dispatchEvent({type:"show-banding-pane-recommendation",ITa:this.D,p8a:$ic(this.C)});a.stopPropagation()};p.pmb=function(a){if(!this.H&&PT(this.C)){var b=this.F;this.F=this.C.Lh();this.F==b?this.dispatchEvent(new bW("qe",this,2797)):this.dispatchEvent(new bW("ke",this,2673));a.stopPropagation()}};
function lsc(a,b){a.H=!0;var c=b.Jb();b=xh(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.qc(),b.hc(),b.Lc(),b.Sc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new rh).cd(xd.Ra(),c),c=Tic(c)):c=null;c?(c=ajc(a.C,c),DI(a.C,c?c.getElement():null)):DI(a.C,null);a.F=a.C.Lh();a.H=!1};function msc(a,b){gW.call(this,a,b);this.C=new ts("",this.Ba());this.Wa(this.C);this.pb=Ec(a,6)}w(msc,gW);var KW={Vfa:"waffle-assistant-formatting-edit-button",G0a:"waffle-assistant-conditionalformat-format-preview",b3a:"waffle-assistant-conditionalformat-rule-holder",j5:"waffle-assistant-conditionalformat-description",h2a:"one-rule",d4a:"two-rules",R3a:"three-rules",A2a:"waffle-assistant-conditionalformat-format-preview-label"};p=msc.prototype;p.Ga=function(){msc.$.Ga.call(this);hW(this).appendChild(T(isc))};
p.Sa=function(){msc.$.Sa.call(this);var a=this.bb(KW.Vfa);this.C.mb(a);eW(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.Llb)};p.OI=function(a){Zl(this.bb(KW.j5),Fc(this.D,3));var b=this.bb(KW.b3a),c=new nsc(this,this.Ba());this.Wa(c);c.mb(b);eW(b,"Apply conditional format rules");a()};p.DI=sa;p.kG=n("assistantConditionalFormatFeedback");p.hM=n(2630);p.gM=n(2629);
p.Llb=function(){this.dispatchEvent(new bW("le",this,2563));this.dispatchEvent(new bW("ne",this,2670,void 0,void 0,xh(B(this.pb[0],1,0))));Dn()};function nsc(a,b){Iq.call(this,void 0,void 0,b);this.C=a}w(nsc,Iq);
nsc.prototype.ge=function(a){nsc.$.ge.call(this,a);var b=this.C.pb;switch(b.length){case 0:break;case 1:var c=KW.h2a;break;case 2:case 4:c=KW.d4a;break;default:c=KW.R3a}for(var d=0;d<b.length;d++){var e=b[d],f=Il("DIV");gp(f,[KW.G0a,c]);var h=Il("DIV");fp(h,KW.A2a);f.appendChild(h);Zl(h,"123");if(yc(e,2)){var k=B(B(e,2),1);switch(B(B(k,1),1)){case 9:case 13:var k=Ec(B(k,1),2)[0],l=Ec(e,1)[0];Zl(h,yz(k,Fc(l,1),Fc(l,2),Fc(l,4)))}}fic(e,f);a.appendChild(f)}};
nsc.prototype.Di=function(){var a=this.C;a.dispatchEvent(new bW("le",a,2563));return!0};function osc(a,b,c){jW.call(this,2,b,a,c)}w(osc,jW);p=osc.prototype;p.J4=n("Formatting");p.Yia=function(a){return 2==a||4==a};p.g8=function(a){var b=B(a,1);switch(b){case 2:return new msc(a,this.Ba());case 4:return a=new jsc(a,this.wu(),this.Ba()),this.getHandler().R(a,"ke",this.jUb).R(a,"qe",this.SGb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.jUb=function(a){tW(this.$a,"Alternating colours applied",this.Ba(),u(this.qmb,this,a.C))};p.SGb=function(){this.$a.clear()};
p.qmb=function(a){this.dispatchEvent(new bW("ve",a,2796))};p.hf=function(a){osc.$.hf.call(this,a);this.setVisible(!a)};p.iwa=function(a){return this.Fd()?(this.setVisible(!1),a):osc.$.iwa.call(this,a)};p.hwa=n(3);function LW(a,b,c,d,e){R.call(this);this.J=a;this.Oa=b;this.Z=c;this.D=d;this.H=e}la(LW,R);LW.prototype.getTableRange=g("Z");LW.prototype.Vda=function(a,b){this.Z=a;this.D=b};LW.prototype.Sa=function(){R.prototype.Sa.call(this);this.getHandler().R(this.J.C,"M",this.Pa)};LW.prototype.Pa=function(){this.Oa.Ec()};function psc(a,b,c){var d=a.Lc(),e=a.Sc();switch(b){case 0:d=Math.min(d,a.qc()+c);break;case 1:e=Math.min(e,a.hc()+c)}return sh(a.Jb(),a.qc(),a.hc(),d,e)};function qsc(a,b){E.call(this);this.F=a;this.H=b;this.C=new Rpc(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");F(this,this.C);this.D=new Rpc(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");F(this,this.D)}la(qsc,E);qsc.prototype.Ja=function(){pW(this.C);pW(this.D);E.prototype.Ja.call(this)};
function rsc(a,b,c,d,e,f){axb(b);var h=xh(d),h=new ah(h.qc(),h.hc(),Math.min(h.Lc(),h.qc()+6),Math.min(h.Sc(),h.hc()+3)),k=X3a(b),l=tB(a.F).Yd(),m=l.eg(new Qg(h.qc(),h.Lc()),"r",!1,!1,!0,!0)-1,l=l.eg(new Qg(h.hc(),h.Sc()),"c",!1,!1,!0,!0)-1,m=Math.min(115,m),l=Math.min(c.offsetWidth-2,l);bxb(b,k,l,m);c=psc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.qc();k=d.hc();switch(e){case 0:h=Math.min(d.Lc(),d.qc()+f);break;case 1:k=Math.min(d.Sc(),d.hc()+f)}d=sh(d.Jb(),h,k,d.Lc(),d.Sc());oW(b,DS(d));oW(a.D,DS(c))};function ssc(a){var b=a.ZSa,c=a.wRa,d=a.iDa;return V('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+U(a.$Sa)+'</div></div><div class="waffle-tables-popup-content">'+U(b)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+U(c)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+U(d)+"</div></div></div></div>")}
function tsc(){var a=ur("Edit data range");var b=""+('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper">Data Range'+U(Ric({qba:!0}))+'</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');b=V(b);a=""+ssc({$Sa:a,ZSa:vr(""+b),wRa:ur("Update"),iDa:ur("Cancel")});
return V(a)}function usc(){var a=""+ssc({$Sa:ur("Improve suggestions"),ZSa:vr('<div class="waffle-tables-popup-header-message"></div>'),wRa:ur("No"),iDa:ur("Yes")});return V(a)}function vsc(a){a='For <span class="waffle-assistant-table-bar-range">'+(U(a.MVb)+"</span>");return V(""+a)}function wsc(a){a='Is <span class="waffle-assistant-table-first-header">'+(U(a.PGb)+"</span> a header row, containing titles that describe the columns below?");return V(""+a)};function MW(a,b,c,d,e,f){LW.call(this,a,X.tY,d,e,f);this.C=(new hP).build();F(this,this.C);this.L=new ls("",new dW,this.Ba());this.Wa(this.L);Wt(this.C,this.L,X.X6);this.F=new ls("",new dW,this.Ba());this.Wa(this.F);Wt(this.C,this.F,X.tY);this.V=new qsc(b,c);F(this,this.V);this.O=new Io(this);F(this,this.O)}la(MW,LW);MW.prototype.Ga=function(){this.La=T(usc)};
MW.prototype.Sa=function(){LW.prototype.Sa.call(this);this.L.mb(this.bb("waffle-tables-popup-done"));this.F.mb(this.bb("waffle-tables-popup-cancel"));var a=psc(this.getTableRange(),this.H,1),a=yv(xh(a)),a=T(wsc,{PGb:a});this.bb("waffle-tables-popup-header-message").appendChild(a);this.O.subscribe(X.X6,"action",this.Ca).subscribe(X.tY,"action",this.qa);var a=this.bb("waffle-assistant-table-canvas"),b=this.bb("waffle-assistant-canvas-container");rsc(this.V,a,b,this.getTableRange(),this.H,this.D)};
MW.prototype.qa=function(){this.dispatchEvent("te")};MW.prototype.Ca=function(){var a=xh(this.getTableRange());switch(this.H){case 0:a=aha(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=aha(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=yv(a);this.dispatchEvent(new Toc(a,this.D-1,this.H));this.dispatchEvent("te")};function xsc(a,b,c,d,e,f,h){LW.call(this,a,X.tQ,d,e,f);this.Xa=b;this.Ia=d;this.$a=e;a=xh(d);this.F=yv(a);this.Ca=new qsc(b,c);F(this,this.Ca);this.C=null;this.Kb=h;this.L=(new hP).build();F(this,this.L);this.V=new ls("",new dW,this.Ba());this.Wa(this.V);Wt(this.L,this.V,X.sY);this.O=new ls("",new dW,this.Ba());this.Wa(this.O);Wt(this.L,this.O,X.tQ);this.qa=new Io(this);F(this,this.qa)}la(xsc,LW);p=xsc.prototype;p.Ga=function(){this.La=T(tsc)};
p.Sa=function(){LW.prototype.Sa.call(this);this.V.mb(this.bb("waffle-tables-popup-done"));this.O.mb(this.bb("waffle-tables-popup-cancel"));var a=this.bb("waffle-range-selection-input");a.focus();this.getHandler().R(this.La,"keydown",this.eKb).R(a,"keyup",this.fKb).R(a,Xba,this.uEb).R(this.Xa,"selectionChange",this.gKb);this.qa.subscribe(X.sY,"action",this.hKb).subscribe(X.tQ,"action",this.Omb);pD(this.J,"selection-input");ysc(this)};p.Ja=function(){pD(this.J,"normal");LW.prototype.Ja.call(this)};
function zsc(a){var b=a.bb("waffle-assistant-table-canvas"),c=a.bb("waffle-assistant-canvas-container");rsc(a.Ca,b,c,a.getTableRange(),a.H,a.D)}p.Omb=function(){this.dispatchEvent("te")};p.hKb=function(){var a=this.$a!=this.D,b=!zic(this.Ia,this.getTableRange());if(a||b)a&&this.Kb.fc(35506),b&&this.Kb.fc(35507),this.dispatchEvent(new Toc(this.F,this.D,this.H));this.dispatchEvent("te")};function ysc(a){var b=a.bb("waffle-range-selection-input"),c=xh(a.Ia);a.F=yv(c);b.value=a.F;Asc(a);zsc(a)}
p.Vda=function(a,b){LW.prototype.Vda.call(this,a,b);zsc(this)};function Bsc(a){var b=fv(a.J.C),c=b.vc(),b=XHa(a.F,b);null!=b&&(c=vh(b,c),a.Vda(c,Csc(a,c)),Asc(a))}function Csc(a,b){b=Dsc(b);return a.D>b?b:a.D}function Dsc(a){var b=Fc(a,2);a=a.Lc();return Math.min(a-b-1,3)}
function Asc(a){G(a.C);a.C=new NH;a.Wa(a.C);Wt(a.L,a.C,X.pha);LS(a.C,RT.getInstance());a.C.render(a.bb("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.Atb);for(var b=Dsc(a.getTableRange()),c=0;c<=b;c++){var d=(new Nn("{NUM_ROWS,plural, =0{none}=1{1 row}other{# rows}}")).format({NUM_ROWS:c});a.C.re(new Tq(d))}a.C.Vf(a.D)}p.uEb=function(){var a=this.bb("waffle-range-selection-input");this.F!==a.value&&(this.F=a.value,Bsc(this))};
p.gKb=function(a){var b=a.rect;!b||a.V||gh(b)||(this.F=a=yv(b),b=this.bb("waffle-range-selection-input"),b.value=a,b.select(),Bsc(this))};p.eKb=function(a){var b=this.bb("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;Bsc(this);X.sY.Ec();break;case 27:a.stopPropagation(),a.preventDefault(),ysc(this),X.tQ.Ec()}};p.fKb=function(){this.F=this.bb("waffle-range-selection-input").value;Bsc(this)};
p.Atb=function(){var a=this.C.Lh();this.Vda(this.getTableRange(),a)};function NW(a,b,c,d){Ot.call(this,a,b,c,d,void 0,void 0,!0)}w(NW,Ot);NW.prototype.Ga=function(){NW.$.Ga.call(this);fp(this.La,"waffle-assistant-toast");fp(this.bb("docs-ui-toast-content"),"waffle-assistant-toast-content")};NW.prototype.gF=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=aq(this,b);NW.$.gF.call(this,a,b,c)};NW.prototype.Yh=function(a,b,c,d){this.gF(a,b,d);a=cq(this,b);Pf(this.getHandler(),a,gd,u(function(){this.setVisible(!1);c()},this))};function Esc(){this.C=null}w(Esc,E);Esc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function tW(a,b,c,d){a.clear();a.C=new NW(b,c,!1,5E3);a.C.render();d&&a.C.Yh("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}Esc.prototype.Ja=function(){Esc.$.Ja.call(this);this.clear()};function Fsc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+yr("Press Enter to insert formula")+'"></span></div>');return V(a)};function OW(a,b){R.call(this);this.C=a;this.D=b}w(OW,R);p=OW.prototype;p.Ga=function(){this.La=T(Fsc,{name:this.C,title:this.D})};p.Sa=function(){OW.$.Sa.call(this);var a=this.bb("waffle-assistant-quicksum-entry-name");eW(a);this.getHandler().R(this.La,"keypress",this.o0b);Q(this.La,!1)};p.getFunctionName=g("C");p.gb=function(a){Zl(this.bb("waffle-assistant-quicksum-entry-value"),a||"");Q(this.La,!!a)};p.kb=function(){return Ip(this.La)};
p.o0b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new H("insert",this)))};function PW(a,b,c,d,e){R.call(this,e);this.Oa=a;this.Ca=b;this.L=c;this.Kb=d;this.D=a.C;this.Ia=new rh;this.V=qi(new pi,17).build();this.O=qi(new pi,2).build();this.J=!1;this.F=[];this.C=null;this.H=[]}w(PW,R);
PW.prototype.Sa=function(){PW.$.Sa.call(this);this.Zh(new OW(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Zh(new OW(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Zh(new OW(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Zh(new OW(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Zh(new OW(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new rW(this.La,
this.Ca,this.D,this.L);this.C.hf(this.J);F(this,this.C);this.getHandler().R(this,"insert",this.Z).R(this.C,"formula_inserted",this.qa)};
function Gsc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(ev(a.D)){var c=fv(a.D),d=c.dk(),e=cD(a.D);if(yb(d,c.Nt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=sh(e+"",h.qc(),h.hc(),h.Lc(),h.Sc());c.push(a.Ia.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){Q(a.La,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.qd(0).gb(b(d.sum));a.qd(1).gb(b(d.average));a.qd(2).gb(b(d.min));a.qd(3).gb(b(d.max));
1<e?a.qd(4).gb(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):Q(a.La,!1);if(a.C){a.C.J=[];a.H=[];for(d=0;d<a.kd();++d)e=a.qd(d),a.H.push(Hsc(a,e.getFunctionName()));a.C.J=a.H}}else Q(a.La,!1)}else Q(a.La,!1)}else Q(a.La,!1)}PW.prototype.hf=function(a){this.J=a;this.C&&this.C.hf(a);jp(this.La,"waffle-assistant-quicksum-panel-readonly",a)};
PW.prototype.Z=function(a){var b=a.target;a=this.F[0];a=new Mg(a.left,a.Lc());b=b.getFunctionName();b=Hsc(this,b);a=new wG(fv(this.D),a,b);this.L.C(a);this.Kb.fc(2624,this.O)};PW.prototype.qa=function(){this.Kb.fc(2624,this.V)};function Hsc(a,b){var c=Fv(a.Oa.L);a=vb(a.F,function(a){return yv(a)});return"="+b+"("+a.join(c)+")"};function Isc(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(ss({content:ur("INSERT CHART"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(ss({Ce:"waffle-autovis-lightbox-close",content:vr(""+U(Jt({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:ur("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
U(ss({content:vr("&#10094;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:wr('aria-label="'+yr("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(ss({content:vr("&#10095;"),style:4,Ce:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:wr('aria-label="'+yr("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.qLb)+"</div></div></div>");return V(a)}function Jsc(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function QW(a,b,c,d){R.call(this,d);this.F=a;this.D=b;this.Kb=c;this.H=[];this.C=new ts("",this.Ba());this.Wa(this.C);this.O=new ts("",this.Ba());this.Wa(this.O);this.L=new ts("",this.Ba());this.Wa(this.L);this.J=new ts("",this.Ba());this.Wa(this.J)}w(QW,R);p=QW.prototype;p.Ga=function(){QW.$.Ga.call(this);this.La=T(Isc,{qLb:this.F.length})};
p.Sa=function(){QW.$.Sa.call(this);var a=X.aP.isEnabled();this.hf(!a);a=this.bb("waffle-autovis-lightbox-close");this.C.mb(a);a=this.bb("waffle-autovis-lightbox-insert");this.O.mb(a);var b=this.bb("waffle-autovis-lightbox-previous");this.L.mb(b);b=this.bb("waffle-autovis-lightbox-next");this.J.mb(b);Ksc(this);Lsc(this,this.D,!1);this.getHandler().R(document.body,Wba,this.iXb).R(this.La,"keydown",this.jXb).R(Hl(),"resize",this.mXb).R(this.C,"action",this.close).R(this.O,"action",this.Gub).R(this.L,
"action",this.lXb).R(this.J,"action",this.kXb);b=new HG(this.La,this.Ba());IG(b);F(this,b);a.focus()};function Ksc(a){var b=a.bb("waffle-autovis-lightbox-content"),c=a.bb("waffle-autovis-lightbox-content-inner");a=a.bb("waffle-autovis-lightbox-page-count");var d=Fl();a=Fp(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Cp(c,d,e);Cp(b,d,e+a.height+35)}p.hf=function(a){jp(this.La,"waffle-autovis-lightbox-readonly",a)};
function Lsc(a,b,c){c&&Bn("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Msc(a,b):a.F[b]&&Epc(a.F[b],u(a.Gnb,a,b),!0)}p.Gnb=function(a,b){if(!this.isDisposed()&&b){var c=this.bb("waffle-autovis-lightbox-container"),d=T(Jsc);c.appendChild(d);this.H[a]=d;QU(b,d,this.Kb,Xm);Msc(this,a)}};function Msc(a,b){Q(a.H[a.D],!1);Q(a.H[b],!0);a.L.eb(0!=b);a.J.eb(b!=a.F.length-1);var c=a.bb("waffle-autovis-lightbox-page-number");Zl(c,b+1);a.D=b}p.iXb=function(a){!Xl(this.La,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.jXb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Lsc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||Nsc(this);a.stopPropagation()};p.mXb=function(){var a=this.bb("waffle-autovis-lightbox-container");Nl(a);this.H=[];Ksc(this);Lsc(this,this.D,!0)};p.Gub=function(){this.close();Hpc(this.F[this.D],2256)};p.lXb=function(){0!=this.D&&Lsc(this,this.D-1,!0);0==this.D&&this.J.La.focus()};p.kXb=function(){Nsc(this);this.D==this.F.length-1&&this.L.La.focus()};
function Nsc(a){a.D!=a.F.length-1&&Lsc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.od=function(){QW.$.od.call(this);var a=this.F[this.D];a&&a.La&&a.La.focus()};function Osc(a,b,c){I.call(this);this.Xb=a;this.Qb=b;this.Ab=c;this.J=a.C;this.De=new rh;this.$a=ck();this.L=new Vj;this.Ub=this.C=this.F=this.V=this.O=this.Oa=this.qa=null;this.Mb=!1;this.D=null;this.kc=!0;this.fb=this.zb=!1;this.Ib=this.ib=null;this.Z=Ii.getInstance();this.Xa=this.Pa="";this.Ca=this.Ia=null;b=this.Xb.L.Qs();this.H=new YU;C(this.H,15,!0);C(this.H,2,nra);a=Qra&&!a.Fd();C(this.H,3,a);C(this.H,4,!0);a=Um&&(bsa||"en"==SC(b));C(this.H,5,a);C(this.H,6,Mra);C(this.H,7,!0);C(this.H,10,!1);
C(this.H,11,asa);C(this.H,12,csa);C(this.H,14,an);this.pb=-1!=window.location.href.indexOf("eeos=false");a=new J(this);F(this,a);a.R(this.Qb,"C",this.R0b)}w(Osc,I);var Psc={B6b:"cu",CZa:"cs",BZa:"ce",G1a:"ls",E1a:"le"};function Qsc(a){a.fb=!0;a.L.cancel(!0);a.Oa=null;a.O=null;a.V=null;a.F=null;a.qa&&(a.qa.cancel(!0),a.qa=null)}p=Osc.prototype;
p.update=function(a,b,c){c&&this.C&&!zb(c,function(a){return tha(a,this.C.rect)},this)||!a&&this.C&&c&&1==c.length&&1==c[0].Hh()&&this.C.rect.contains(c[0])||(this.$a.cancel(!0),a&&Qsc(this),this.$a=Rsc(),this.$a.addCallback(this.w6a,this),this.$a.addCallback(Ha(this.x6a,b),this))};p.uh=da("ib");p.R0b=function(){this.qa&&3==this.Qb.getState()&&(this.qa.Yb(),this.qa=null)};function Rsc(){var a=null,b=new Vj(function(){null===a||Hi(a)}),a=Gi(function(){b.Yb()});return b}
function Ssc(a,b,c,d,e){b&&(a.Xa=Ji(a.Z,tj.aya,!1,Tsc(a)));a.Ia=d;a.Ca=e;a.L.cancel(!0);a.L=new Vj;Usc(a);a.L.addCallback(a.V8a,a);b&&(a.L.addCallback(Ha(a.R8a,c),a),a.pb||null==a.ib||xw(a.Xb)?(a.L.addCallback(a.C6a,a),a.L.addCallback(a.D6a,a)):a.L.addCallback(a.fib,a),a.L.addCallback(a.Q8a,a));Yj(a.L,a.Q0b,a)}p.Q0b=function(a){this.zb=!0;a instanceof Wj||this.Ab.pq(Error("Assistant cancelled"),{cause:a})};
p.w6a=function(){var a=this.J.getActiveGrid();if(a){var b=fv(this.J),c=b.dk(),d=Vsc(this,c||[]),e=Vsc(this,this.Ub||[]);d&&!e||!d&&!Wsc(c,this.Ub)?(this.F=null,this.Mb=!0):this.Mb=!1;this.Ub=c;var f=bB(b).clone();y(b.dk(),function(a){f.Ln(a)});this.D=new oh(a.Jb(),"",f)}else this.D=null};
p.x6a=function(a){this.Pa=Ji(this.Z,tj.$xa,!1,Tsc(this));var b=this.J.getActiveGrid(),c=this.D&&this.D.Xc;this.C&&this.C.Xc!=c&&(this.C=null);if(!b||b.Jb()!=c||null===c)return this.D=null;var d=this.J.getActiveGrid().D,b=sz(d,this.D.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||Xu(this.J)!=c)return null;var b=fv(this.J),f=Xsc(this,a),h=pz(b.D,"r"),k=b.Un("r");return!b.Nt(f)||h>=f.qc()&&PPa(b)||k<=f.Lc()&&OPa(b)?(this.dispatchEvent(new H("ls")),tz(d,f,gc(Gg),a?void 0:500).addCallback(this.Y8a,
this)):f},this);b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.Jb()==c&&null!==c?Ysc(this,a,fv(this.J)):null},this);b.addCallback(function(b){var d=this.C;b&&3<b.Hh()&&(d=b&&new oh(c,"",b));if(null===d&&null!==this.C||null!==d&&!d.equals(this.C))this.F=this.V=this.O=this.Oa=null;b=null!==d&&d.equals(this.C);if(b=this.fb||this.Mb||!b&&(null===this.O||null!==this.V&&null===this.F))this.kc=this.zb&&this.kc||!this.C||!d||!d.rect.intersects(this.C.rect);var e=null!==d&&d.contains(this.C);
this.C=d;""!=this.Pa&&(Ki(this.Z,this.Pa),this.Pa="");b&&Ssc(this,a,e,this.Ia,this.Ca)},this);return b};function Xsc(a,b){return null!=a.D?ritz_api.AssistantApi.getExploreTableRectForSelection(""+a.D.Xc,a.D.rect.top,a.D.rect.height+a.D.rect.top,a.D.rect.left,a.D.rect.width+a.D.rect.left,b,Vra,ah):null}
function Usc(a){if(null===a.C||null===a.C.rect||null!==a.Oa)a.L.Yb();else{var b=Ji(a.Z,tj.Rwa,!1,Tsc(a)),c=a.L;ritz_api.AssistantApi.getAssistantConfidence(""+a.C.Xc,a.C.rect.top,a.C.rect.height+a.C.rect.top,a.C.rect.left,a.C.rect.width+a.C.rect.left,a.De.serialize(a.H),function(d){Ki(a.Z,b);a.Oa=d+0;c.Yb()})}}p.Y8a=function(){this.dispatchEvent(new H("le"))};p.V8a=function(){this.dispatchEvent(new Zsc(this.C,this.Oa))};p.R8a=function(a){a=new $sc(a,this.fb);this.fb=!1;this.dispatchEvent(a)};
p.fib=function(){if(null===this.C||null===this.C.rect||null!==this.V&&null!==this.F)return null;G(this.Ib);return 3!=this.Qb.getState()?(this.qa=new Vj,this.qa.addCallback(this.GUa,this),this.qa):this.GUa()};
p.GUa=function(){var a=Ji(this.Z,tj.cya,!1,Tsc(this)),b=atc(this),c=b&&!b.LPa,d=this.Ia||vh(this.C.rect,this.C.Xc),b=ritz_api.AssistantApi.getAssistantRequestProto(d,c?b.rows:[],c?b.He:[],this.Ca),b=this.De.cd(WU.Ra(),b),c=new rh;c.rv=!0;var b=Uh(c.serialize(b)),e=new Vj;this.Ib=Pj(Qj(Nj(Bk(Ck(this.ib.Qf("/explore/getrecommendations").Wf("rp",b),"GET")).setTimeout(6E4),1),function(b){var c=Ji(this.Z,tj.bya,!1,Tsc(this));b=btc(this,b.og());Ki(this.Z,c);this.V=Ec(b,1);this.F=Ec(b,2);this.Ib=null;Ki(this.Z,
a);e.Yb()},this),function(){this.V=[];this.F=[];e.Yb()},this).$e();return e};
p.C6a=function(){function a(){d=null;ritz_api.AssistantApi.continueAssistantRecommendation(this.O)?(this.V=Ec(btc(this,ritz_api.AssistantApi.getAssistantRecommendations(this.O)),1),e.Yb()):d=Gi(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.V)return null;this.O=ritz_api.AssistantApi.newAssistantRecommender(this.De.serialize(this.H));this.F=this.V=null;if(this.Ia&&this.Ca){var b=DS(this.Ia),c=DS(this.Ca);ritz_api.AssistantApi.startAssistantRecommendationWithHeader(this.O,
""+b.Xc,b.rect.top,b.rect.height+b.rect.top,b.rect.left,b.rect.width+b.rect.left,c.rect.top,c.rect.height+c.rect.top,c.rect.left,c.rect.width+c.rect.left)}else ritz_api.AssistantApi.startAssistantRecommendation(this.O,""+this.C.Xc,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var d=null,b=u(function(){null!==d&&(Hi(d),this.F=this.V=this.O=d=null)},this),e=new Vj(b),d=Gi(a,5,this);return e};
p.D6a=function(){var a=atc(this);a&&this.O&&null===this.F&&(this.F=a.LPa?[]:Ec(btc(this,ritz_api.AssistantApi.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.He)),2))};p.Q8a=function(){this.zb=!1;var a=this.F&&0<this.F.length?this.F:this.V;""!=this.Xa&&(Ki(this.Z,this.Xa),this.Xa="");this.dispatchEvent(new ctc(this.C,a||[]))};function btc(a,b){return a.De.cd(VU.Ra(),b)}
function Ysc(a,b,c){b=b.clone();dc(Gg,function(a){for(var d=!0;d&&b;){for(var f=Kg(a),h=0;h<(f?b.width:b.height);h++){var k=mh(b,a),l=f?b.hc():b.qc(),k=f?c.If(k,l+h):c.If(l+h,k);if(!OSb(k)&&k.Nr()){d=!1;break}}d&&(wha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function Wsc(a,b){return Vb(a,b,function(a,b){return fh(a,b)})}
function atc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.Jb()!=a.C.Xc)return null;for(var c=fv(a.J).dk(),c=vb(c,Ha(eh,a.C.rect)),c=ub(c,va),d=vb(c,function(a){return new Xg(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new og,e=new og,f=0;f<d.length;f++){for(var h=0;h<d[f].width;h++)e.add(d[f].left+h);for(h=0;h<d[f].height;h++)b.add(d[f].top+h)}a=Vsc(a,c);return{rows:b.jd(),He:e.jd(),LPa:a}}
function Vsc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(gh(b)||0==b.Hh())return!0;a=dUa(fv(a.J).Z,b.top,b.left);return b.equals(a)}function Tsc(a){var b=new ki;N(b,5,a.pb||null==a.ib||xw(a.Xb)?1:2);N(b,6,!a.pb);N(b,11,fsa);return si(qi(new pi,41),b).build()}function Zsc(a,b){H.call(this,"cu");this.C=a;this.F=b}w(Zsc,H);function ctc(a,b){H.call(this,"ce");this.C=a;this.F=b}w(ctc,H);function $sc(a,b){H.call(this,"cs");this.C=a;this.F=b}w($sc,H);function RW(a,b,c,d,e,f){GT.call(this,f);this.Ia=a;this.dd=b.C;this.zb=c;this.pe=d;this.Kb=e;this.Xa=new PW(b,c,d,e,this.Ba());this.Wa(this.Xa);this.L=new lV(!1,"#4285f4");this.Wa(this.L);this.J=null;this.kc=this.Xb=!1;this.Mb=!0;this.Ib=Ii.getInstance();this.fb=this.$a="";this.Oa=qi(new pi,10).build()}w(RW,GT);p=RW.prototype;p.Ga=function(){RW.$.Ga.call(this);this.La=T(dtc,{fUb:Um})};
p.Sa=function(){RW.$.Sa.call(this);var a=this.bb("waffle-assistant-quicksum-panel");this.Xa.mb(a);a=this.bb("waffle-assistant-spinner-container");this.L.render(a);this.getHandler().R(this,"close-sidebar",this.dpa).R(this.Ia,Psc.G1a,this.Voa).R(this.Ia,Psc.E1a,this.Uoa).R(this.Ia,Psc.CZa,this.voa).R(this.Ia,Psc.BZa,this.uoa).R(this.bb("waffle-assistant-scroll-pane"),"scroll",Bic(this.jwa,10,this));a=X.aP.isEnabled();this.hf(!a)};
p.resize=function(){var a=this.bb("waffle-assistant-sidepane-content"),a=Fp(a).height,b=this.bb("waffle-assistant-spinner-container");np(b,"margin-top",a/2-16+"px")};p.uh=sa;function etc(a,b){var c=ftc(a);0!=c.length&&(G(a.J),c=c.filter(function(a){return a instanceof kW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.J=new QW(c,b,a.Kb,a.Ba()),a.J.render(),F(a,a.J),a.J.hf(a.kc)))}p.hf=function(a){this.kc=a;jp(this.La,"waffle-assistant-readonly",a);this.Xa.hf(a);this.J&&!this.J.isDisposed()&&this.J.hf(a)};
p.setVisible=function(a){var b=this.kb();RW.$.setVisible.call(this,a);if(a&&!b){var c=Xsc(this.Ia,a);c?(b=new soc,N(b,1,lh(c,"r")),N(b,2,lh(c,"c")),c=c.Hh(),N(b,3,c),c=new ki,ci(c,4,b),b=si(ti(this.Oa),c).build()):b=this.Oa;this.fb=Ji(this.Ib,tj.gya,!1,b);this.L.setActive(!0);SW(this)}a||gtc(this,!0)};p.Voa=function(){this.kb()&&(gtc(this,!0),this.L.setActive(!0),SW(this))};p.Uoa=function(){this.kb()&&(this.L.setActive(!1),SW(this))};
p.voa=function(a){this.kb()&&(this.Kb.C(2775,this.Oa),gtc(this,void 0,a.C,a.F),htc(this)||this.L.setActive(!0),SW(this),this.Mb=!1)};
p.uoa=function(a){if(this.kb()){this.Kb.C(2776,this.Oa);var b=a.F;0<b.length&&(this.$a=Ji(this.Ib,tj.eya));gtc(this,!1);this.L.setActive(!1);a=a.C;for(var c=0;c<b.length;c++){var d=Fc(b[c],1);an&&5==d&&(this.Z=B(b[c],12),this.V=B(b[c],4,0),this.qa=B(b[c],11),itc(this),2==this.Z&&(this.O=new MW(this.pb,this.zb,this.Kc,this.V,this.Z,this.qa),this.Wa(this.O,!0)))}for(c=0;c<this.D.length;c++){for(var d=[],e=0;e<b.length;e++){var f=Fc(b[e],1);this.D[c].Yia(f)&&d.push(b[e])}0<d.length?this.D[c].gwa(d,a):
this.D[c].lW(!0)}b=ftc(this);0<b.length&&this.Xb&&(b[b.length-1].Ib=!0);this.Xb=!1;SW(this);jtc(this);this.jwa()}};function SW(a){var b=htc(a),c=Ip(a.bb("waffle-assistant-quicksum-panel")),d=a.L.$b(),b=b||c||d;a=a.bb("waffle-assistant-empty-list");Q(a,!b)}p.Dc=sa;p.fta=sa;p.wu=g("Kb");p.Fd=g("kc");p.dpa=sa;p.OJb=function(){""!=this.$a&&(Ki(this.Ib,this.$a),this.$a="");""!=this.fb&&(Ki(this.Ib,this.fb),this.fb="");this.Mb||(this.Kb.fc(2777,this.Oa),this.Mb=!0)};function dtc(a){a=a||{};var b=V,c=vr('<div class="waffle-assistant-replaceable-title">'+ktc()+"</div>");var d=d=a||{};var e=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(fpc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');e=d.fUb?e+"To see answers, formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
e+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";d=V(e+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Give it a try</a></div></div></div>');d=V(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
d+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return b(U(QT(tr({title:c,bl:vr(""+d),id:ur("autovis"),Q3:ur("waffle-assistant-sidepanel"),sea:ur("waffle-assistant-title"),WZ:ur("waffle-assistant-sidepane-content")},a))))}
function ktc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(fpc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function TW(a,b,c,d,e,f,h,k){RW.call(this,a,b,c,d,e,k);this.Zd=f;this.pb=b;this.Pa=new R(this.Ba());this.Wa(this.Pa);this.Ca=new Esc;F(this,this.Ca);this.D=[];this.F=null;this.ib=new ts("",k,4);Pq(this.ib,2,!1);this.Wa(this.ib);this.Kc=h;this.V=null;this.Z=0;this.qa=null;this.Qb=new ls("",new dW,this.Ba());this.Wa(this.Qb);this.Ub=new R(this.Ba());this.Wa(this.Ub);this.zc=(new hP).build();F(this,this.zc);Wt(this.zc,this.Qb,X.W6);this.O=this.H=null}w(TW,RW);
var UW={nE:"waffle-assistant-scroll-pane-feature-content",nac:"waffle-assistant-empty-list",q0a:"waffle-assistant-features",v1a:"waffle-assistant-empty-list-learn-more",Nga:"waffle-assistant-expanded-panel",jAa:"waffle-assistant-replaceable-title",bvc:"waffle-assistant-scroll-pane",M3a:"waffle-assistant-sidepane-tables-range",N3a:"waffle-sidebar-tables-bar",O3a:"waffle-assistant-tables-edit-range-button",uQ:"waffle-assistant-title"},ltc={defaultHelpArticleId:"6280499"};p=TW.prototype;
p.Sa=function(){var a=this;TW.$.Sa.call(this);this.Pa.mb(this.bb(UW.Nga));eW(this.C.La,"Close");an&&(this.Ub.mb(this.bb(UW.M3a)),itc(this),this.Qb.mb(this.bb(UW.O3a)));var b=this.pb.L.Qs();Um&&(bsa||"en"==SC(b))&&(b=new JW(this.Zd,this.zb,this.dd,this.pe,this.wu(),this.Ca,this.pb,this.Ba()),this.Wa(b),this.D.push(b));b=new osc(this.wu(),this.Ca,this.Ba());this.Wa(b);this.D.push(b);b=new nW(this.dd,this.zb,this.wu(),this.Ca,this.Ba());this.Wa(b);this.D.push(b);var c=this.bb(UW.q0a);y(this.D,function(b){b.render(c);
a.Pa.Wa(b.C,!0)});this.ib.mb(this.bb(UW.v1a));this.getHandler().R(this.ib,"action",this.P0b).R(this,"te",this.IDa);mtc(this)};p.P0b=function(){P.Go.Ec(ltc)};function jtc(a){y(a.D,function(a){npc(a)})}function gtc(a,b,c,d){y(a.D,function(a){a.lW(b,c,d)})}function htc(a){return!!zb(a.D,function(a){return a.ppa()})}
p.jwa=function(){var a=this,b=this.bb("waffle-assistant-scroll-pane").scrollTop+Fp(this.bb("waffle-assistant-sidepane-content")).height;y(this.D,function(c){a.F&&a.F!=c||(c instanceof nW&&a.getHandler().Jc(c,"oe",a.OJb),b=c.iwa(b))})};function ftc(a){if(a.F)return a.F.C.C;var b=[];y(a.D,function(a){Ob(b,mpc(a))});return b}p.hf=function(a){TW.$.hf.call(this,a);mtc(this)};p.uh=function(a){y(this.D,function(b){b.uh(a)})};p.fta=function(){var a=this.bb(UW.jAa),b=this.bb(UW.uQ);Ep(b,Fp(a).height)};
p.Dc=function(){var a=this,b=this.bb(UW.nE),c=this.bb(UW.jAa),d=this.Pa.La;if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,Q(b,!0),Q(d,!1),gr(c,ktc),ap(c,"label"),this.resize();else if(this.F=zb(this.D,function(a){return a.$b()}))Q(b,!1),Q(d,!0),this.F.C.setVisible(!0),opc(this.F,c),cp(c,this.F.J4());this.fta();b=new Fk(function(){var b=Du;b&&b.dispatchEvent("resize");a.jwa()},300);F(this,b);b.start()};
p.setVisible=function(a){var b=this.kb();TW.$.setVisible.call(this,a);a&&!b&&ntc(this,!0);a||this.Ca.clear()};p.dpa=function(){TW.$.dpa.call(this);this.F&&this.Dc();this.IDa()};p.Voa=function(){TW.$.Voa.call(this);ntc(this,!0)};p.Uoa=function(){TW.$.Uoa.call(this);ntc(this,!1)};p.voa=function(a){TW.$.voa.call(this,a);ntc(this,!0,a.C)};p.uoa=function(a){TW.$.uoa.call(this,a);ntc(this,!1)};
function otc(a,b){b?(VXb(a.H),a.H=new xsc(a.pb,a.zb,a.Kc,a.V,a.Z,a.qa,a.wu()),a.Wa(a.H),a.H.render(a.getElement())):a.H&&(a.removeChild(a.H,!0),G(a.H),a.H=null);(a=ptc(a))&&dsc(a,b)}function mtc(a){y(a.D,function(b){b.hf(a.Fd())})}function ptc(a){a=zb(a.D,function(a){return a instanceof JW});return null!=a?a:null}function ntc(a,b,c){y(a.D,function(a){c||jpc(a.C,b)});an&&(b&&(a.V=null,a.Z=0,a.qa=null),itc(a))}
function itc(a){var b=a.bb(UW.N3a),c="";a.V&&0==a.qa?(c=xh(a.V),c=yv(c),Q(b,!0)):Q(b,!1);b=T(vsc,{MVb:c});a=a.Ub.Zb();Nl(a);a.appendChild(b)}p.IDa=function(){otc(this,!1);this.O&&(this.removeChild(this.O,!0),G(this.O));this.O=null;var a=ptc(this);a&&dsc(a,!1)};function qtc(a,b,c,d,e,f,h,k,l,m,q,r){var v=this;MT.call(this,b,h);this.Z=a;this.C=b;this.O=c;this.Ia=d;this.$a=e;this.L=f;this.J=c.C;this.Oa=this.Ca=!1;this.Kb=l;this.Xa=r;this.De=new rh;this.F=null;rtc(this);X.X4.eb(!0);a=new Jia;N(a,6,stc());b=new hi;ci(b,58,a);this.H=qi(ri(new pi,b),10).build();this.Pa=Ii.getInstance();this.qa=Ji(this.Pa,tj.dya);a=new Fk(function(){return ttc(v,!1)},100);F(this,a);a.start()}w(qtc,MT);
function rtc(a){var b=dv(a.$a);a.Kf().R(a.Ia,"selectionChange",a.U0b).R(a.J,"M",a.S0b).R(b,"ea",a.Pwb).R(a.C,"le",a.Nlb).R(a.C,"ke",a.Mlb).R(a.C,"qe",a.UAb).R(a.C,"ne",a.hnb).R(a.C,"pe",a.T0b).R(a.C,"ue",a.JDb).R(a.C,"re",a.vCb).R(a.C,"me",a.jmb).R(a.C,"ve",a.V0b).R(a.Z,"cu",a.Hob).R(a.C,"se",a.zCb);Jo(a.V,X.aP,$n,a.Jub).subscribe(X.bP,"action",a.gmb).subscribe(X.Y4,"action",a.uDb).subscribe(X.sfa,"action",a.oSa).subscribe(X.Iy,"action",a.uyb).subscribe(X.W6,"action",a.FDb)}p=qtc.prototype;p.Ih=function(){return X.tfa};
p.Xv=function(){return X.Twa};p.bv=function(a){qtc.$.bv.call(this,a);X.Y4.eb(a);ttc(this,!1);!this.Ca&&a&&(this.Ca=!0);Qn(this.Xa,{Lb:a})};p.j1=function(a){var b=this;this.C.fta();var c=new Fk(function(){qtc.$.j1.call(b,a)},300);F(this,c);c.start()};p.uh=function(a){this.C.uh(a);this.Z.uh(a)};p.gmb=function(){var a=this.C.kb();this.Ih().setVisible(!a);a?this.Kb.fc(2226,this.H):(this.C.focus(),this.Kb.fc(2253,this.H))};p.oSa=function(){this.C.kb()||this.bv(!0)};
p.uyb=function(){var a=ptc(this.C);a&&!a.$b()&&(this.oSa(),fsc(a,"",!0))};p.uDb=function(a){etc(this.C,a)};p.FDb=function(){otc(this.C,!0)};p.U0b=function(){ttc(this,!0)};function ttc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.F&&c[0].equals(a.F)){a.F=null;return}}var d=a.C;d.kb()&&(Gsc(d.Xa),SW(d));a.Z.update(!b,a.C.kb(),c)}
p.Hob=function(a){""!=this.qa&&(Ki(this.Pa,this.qa),this.qa="");var b=a.F||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&c.Hh()>=Wra&&lh(c,"r")>=Yra&&lh(c,"c")>=Zra&&c.Hh()<=Xra)&&.6<=b;d!==this.Oa&&(this.Oa=d,X.X4.Ec(d));c&&a&&a.rect&&(c=.9<=b,d=1E3>=a.rect.Hh(),a=ritz_api.RitzModelApi.isFormsRegion(""+a.Xc,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=!this.C.kb()&&!this.Ca&&c&&d&&!xw(this.O),a=Nra&&a,d=Ora&&this.O.Fd(),c&&(a||d)&&(c=new Jia,N(c,1,b),N(c,2,a),N(c,3,d),N(c,5,
csa),N(c,6,stc()),b=new hi,ci(b,58,c),b=ri(qi(new pi,10),b).build(),this.LCa(b)))};p.LCa=function(a){var b=this;this.C.Xb=!0;var c=OVa(fv(this.J));if(!yUb.C&&!c){var d=a||this.H;this.Ih().setVisible(!0);this.Kb.fc(2225,d);this.Kb.fc(2253,this.H);a=new Fk(function(){b.C.kb()||b.Kb.fc(2752,d)},5E3);F(this,a);a.start()}};function stc(){switch($ra){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.jmb=function(){this.C.Dc()};
p.V0b=function(a){var b=a.C,c=B(b.D,4,0),d=parseInt(c.Jb(),10);this.F=xh(c);this.L.C(new qVb(d));lsc(b,c);this.Kb.fc(a.yk(),this.H)};p.S0b=function(){ev(this.J)?(this.C.eb(!0),ttc(this,!1)):(this.Ih().setVisible(!1),this.C.eb(!1))};p.Jub=function(){this.C.hf(!X.aP.isEnabled())};p.Pwb=function(a){ttc(this,!1,lHa(a))};
p.Nlb=function(a){var b=fv(this.J),c=""+b.vc(),d=[],e=gic(b);if(e){var b=new Te,f=Fc(e,2);C(b,3,f);f=Fc(e,2);C(b,2,f);e=Fc(e,1);C(b,1,e);d.push(b)}b=a.C.pb;for(e=0;e<b.length;e++)f=new Te,C(f,2,b[e]),d.push(f);this.L.C(new ZU(d,c));this.Kb.C(a.yk(),this.H)};
p.Mlb=function(a){var b=a.C,c=$ic(b.C),d=B(b.D,4,0),e=c.ev?c.Kx:null,f=c.C?c.px:null,h=parseInt(d.Jb(),10),k=utc(d);this.F=xh(d);k?this.L.C(new LT(k,h,this.F,e,c.Js,c.Ht,f)):this.L.C(new JT(h,this.F,e,c.Js,c.Ht,f));d=new wic;N(d,1,1);c=new MS;b=B(b.D,2);N(c,2,b);ci(c,5,d);b=new hi;ci(b,46,c);b=ri(qi(new pi,10),b).build();this.Kb.C(a.yk(),b)};p.UAb=function(a){a=a.C;var b=B(a.D,4,0),c=parseInt(b.Jb(),10),d=utc(b);this.F=xh(b);this.L.C(new KT(d,c));lsc(a,b)};
p.zCb=function(a){var b=fv(this.O.C),c=b.vc(),b=vh(XHa(a.J,b),c);a=psc(b,a.V,a.L);c=this.Z;Qsc(c);Ssc(c,!0,!0,b,a)};function utc(a){var b=a.Jb();a=xh(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.qc(),a.hc(),a.Lc(),a.Sc(),7,!1);return 0<b.length?b[0]:null}p.hnb=function(a){hB(fv(this.J),a.F);this.Kb.C(a.yk(),this.H)};
p.JDb=function(a){var b=a.C;a=a.yk();if(b instanceof sW||b instanceof vW)this.Kb.C(a,this.H);else{var c=ftc(this.C),d=new MS,e=B(b.D,2),c=c.indexOf(b);N(d,1,c);N(d,2,e);e=new hi;ci(e,46,d);if(b instanceof kW){(d=b.H)?(b=vtc(this,b,d),b=Flc(b,d,d.tf())):b=null;if(!b)return;ci(e,39,b)}else if(b instanceof mW){var f=b.D,c=new Boc;if(b instanceof mW)b=1;else throw Error("Unknown text analysis card type.");f=Ec(B(f,8),20).slice(0,10);N(c,2,f||[]);N(c,1,b);ci(d,3,c)}e=ri(qi(new pi,10),e).build();this.Kb.C(a,
e)}};p.vCb=function(){this.C.Dc()};
p.T0b=function(a){var b=a.J;if(b){var c=fv(this.J),d=a.Te();d||(d=tB(this.Ia).ld().C.Te());var e=16,f=16,h=a.Pa;h&&(e=h.x,f=h.y);h=KZa(this.O.J);c={oid:null,ar:oB(c,d.y),ac:pB(c,d.x),x:e,y:f,h:Dy.height,w:Dy.width,p:{context:{chartName:"Chart"+(h+1)}}};c=new HC(Xu(this.J)||0,c,!1,!1);d=b.tf();e=new om(d);f=Am(e,"headers");f=null!=f&&Ca(f)&&Wa(f)?parseInt(f,10):-1;c.$a=f;c.Z=0;f="1"==Am(e,"transpose");c.Pa=f;c.L=f?"ROWS":"COLS";f=Am(e,"range");f=kic(kT(f,","),this.J);c.iI(f);HS(c,b);(e=Am(e,"dt"))&&
vZa(c,this.De.cd(ef.Ra(),JSON.parse(decodeURIComponent(e))));this.Ia.dispatchEvent(new vD("objectRequest"));this.L.C(new tG(this.O,c));e=wtc(this,b,a.L,a.Rd());e.Wk(c.getId()||0);NU(this.Kb,a.yk(),e,10,b,d)}};function vtc(a,b,c){var d=ftc(a.C).filter(function(a){return a instanceof kW});return wtc(a,c,d.indexOf(b),b.H&&b.H.Rd())}
function wtc(a,b,c,d){var e=new MU;a=ftc(a.C).filter(function(a){return a instanceof kW}).map(function(a){return a.getChartType()});e.O=a;e.H=c;Clc(e,b.getChartType());e.F=d?d.clone():null;return e};function xtc(){E.call(this)}w(xtc,jn);xtc.prototype.C=function(){return Osc};xtc.prototype.F=function(){return TW};xtc.prototype.D=function(){return qtc};wn("assistant",xtc);
