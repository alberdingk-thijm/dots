#!/bin/bash
# get approximate gps location in terms of latitude and longitude
# based on ip address
pubip=$( dig +short myip.opendns.com @resolver1.opendns.com )
geoipxml=/home/tim/bin/geo.xml
geoipcmd="http://api.geoiplookup.net/?query="$pubip
if [ ! -f $geoipxml ]; then
	curl -s -o "$geoipxml" -L "$geoipcmd"
fi
python -c 'from lxml.etree import parse; from sys import stdin; tree = parse(stdin); print(":".join(tree.xpath("//latitude/text()") + tree.xpath("//longitude/text()")))' < "$geoipxml"
