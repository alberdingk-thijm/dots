function Kbd(a){return ub(bIa(a),function(a){return!a.F})}function Lbd(a){var b=new Ld;C(b,1,a);return b}function Mbd(a){a=a||{};return V('<div class="waffle-printing-pane-base'+(a.Cg?" "+W(a.Cg):"")+'"><div class="waffle-printing-header-bar"><div class="waffle-printing-header-bar-left"></div><div class="waffle-printing-header-bar-right"></div></div><div class="waffle-printing-pane-content"></div></div>')}
function Nbd(){return V('<div class="waffle-printing-body-wrapper"><div class="waffle-printing-options-pane"></div><div class="waffle-printing-preview-pane"></div></div>')}function Obd(){return V('<div class="waffle-printing-preview-outer"><div class="waffle-printing-preview-inner"></div>'+Pbd()+"</div>")}function Qbd(){return V('<div class="waffle-printing-preview-card-wrapper"><div class="waffle-printing-preview-card"><div class="waffle-printing-preview-spinner"></div></div></div>')}
function Pbd(){return V('<div class="waffle-printing-preview-page-counter-outer"><div class="waffle-printing-preview-page-counter-inner"><div class="waffle-printing-preview-page-counter-ellipses"></div><span class="waffle-printing-preview-page-counter"></span></div></div>')}
function Rbd(a){var b='<div class="waffle-printing-header-button-set">'+U(ss({Ce:"waffle-printing-button waffle-printing-cancel-button waffle-printing-toplevel-cancel-button",content:ur("CANCEL"),style:0}));var c="",c=a.jqa?c+"EXPORT":c+"NEXT";b+=U(ss({Ce:"waffle-printing-button waffle-printing-active-button waffle-printing-print-button",content:ur(c),style:2}));return V(b+"</div>")}
function Sbd(){return V('<div class="waffle-printing-options-wrapper"><div class="waffle-printing-options-contents"></div></div>')}function Tbd(){return V('<div class="waffle-printing-options-section waffle-printing-options-top-section"></div>')}
function Ubd(a){var b='<div class="waffle-printing-page-setup-section"><div class="waffle-printing-print"><h3 id="waffle-printing-print-label">';b=a.jqa?b+"Export":b+"Print";return V(b+'</h3></div><div class="waffle-printing-fine-grained-selection"><h3 class="waffle-printing-fine-grained-selection-header">Selection</h3><div class="waffle-printing-fine-grained-selection-button"></div></div><div class="waffle-printing-paper-size"><h3 id="waffle-printing-paper-size-label">Paper size</h3></div><div class="waffle-printing-page-orientation-outer"><h3 id="waffle-printing-page-orientation-label">Page orientation</h3><div class="waffle-printing-page-orientation-inner" role="radiogroup" aria-labelledby="waffle-printing-page-orientation-label"></div></div></div>')}
function Vbd(){var a=""+('<div class="waffle-printing-scale-and-margins-section"><div class="waffle-printing-custom-scale-wrapper"><h3 class="waffle-printing-scale-header" id="waffle-printing-custom-scale-label">Per cent</h3><div class="waffle-printing-custom-scale"></div></div><div class="waffle-printing-scale-wrapper"><h3 class="waffle-printing-scale-header" id="waffle-printing-scale-label">Scale</h3><div class="waffle-printing-scale"></div></div>'+Wbd()+'<h3 class="waffle-printing-margins-header" id="waffle-printing-margins-label">Margins</h3><div class="waffle-printing-margins"></div></div>');
return V(a)}function Xbd(){return V('<div class="waffle-printing-options-section waffle-printing-page-breaks-section"><h2>Page breaks</h2><h3>Page breaks determine where pages begin and end. Set custom breaks to change locations.</h3></div>')}
function Ybd(a){var b='<div class="waffle-printing-formatting-section"><div class="waffle-printing-formatting-toplevel"></div><div class="waffle-printing-collaboration"></div><div class="waffle-printing-horizontal-alignment"><h3 id="waffle-printing-horizontal-alignment-label">Horizontal alignment</h3></div><div class="waffle-printing-vertical-alignment"><h3 id="waffle-printing-vertical-alignment-label">Vertical alignment</h3></div><h3 id="waffle-printing-page-order-label">Page order</h3><div class="waffle-printing-page-order" role="radiogroup" aria-labelledby="waffle-printing-page-order-label"></div>';a.sfb&&
(b+='<h3>Charts and above-cell photos</h3><div class="waffle-printing-formatting-embedded-objects"></div>');return V(b+"</div>")}function Zbd(){var a=""+('<div class="waffle-printing-headers-and-footers-section"><div class="waffle-printing-haf-toplevel"></div>'+U(ss({Ce:"waffle-printing-button waffle-printing-custom-headers-footers-button waffle-printing-custom-headers-footers-entry-button",content:ur("EDIT CUSTOM FIELDS"),style:0}))+"</div>");return V(a)}
function $bd(){var a=""+('<div class="waffle-printing-repeat-header-cells-section"><h3>Go to View &gt; Freeze to select which rows/columns to repeat on all pages.</h3><div class="waffle-printing-checkbox-wrapper"><div class="waffle-printing-checkbox-wrapper waffle-printing-rfs-columns"></div>'+acd({ck:"waffle-printing-rfs-columns-warning"})+'</div><div class="waffle-printing-checkbox-wrapper"><div class="waffle-printing-checkbox-wrapper waffle-printing-rfs-rows"></div>'+acd({ck:"waffle-printing-rfs-rows-warning"})+
"</div></div>");return V(a)}function acd(a){a=""+('<span class="waffle-printing-warning '+W(a.ck)+'" aria-live="polite">(None detected)</span>');return V(a)}function bcd(){return V('<div class="waffle-printing-zoom-wrapper" tabindex="0"><div class="waffle-printing-zoom-in-button"></div><div class="waffle-printing-zoom-out-button"></div></div>')}
function ccd(){return V('<div class="waffle-printing-margins-control">'+dcd({FZ:"waffle-printing-margins-control-top"})+dcd({FZ:"waffle-printing-margins-control-right"})+dcd({FZ:"waffle-printing-margins-control-bottom"})+dcd({FZ:"waffle-printing-margins-control-left"})+"</div>")}function dcd(a){return V('<div class="'+W(a.FZ)+'"><input type="text" class="'+W(a.FZ)+'-display" style="display:none;"></input></div>')}
function ecd(){var a=""+('<div class="waffle-printing-custom-headers-footers-header-left">'+U(ss({Ce:"waffle-printing-button waffle-printing-cancel-button waffle-printing-custom-headers-footers-cancel",content:ur("CANCEL"),style:0}))+"</div>");return V(a)}
function fcd(){var a=""+('<div class="waffle-printing-custom-headers-footers-header-right">'+U(ss({Ce:"waffle-printing-button waffle-printing-active-button waffle-printing-custom-headers-footers-confirm",content:ur("CONFIRM"),style:2}))+"</div>");return V(a)}
function gcd(){var a=""+('<div class="waffle-printing-custom-headers-footers-body"><div class="waffle-printing-custom-headers-footers-instructions">Click into fields to customize. Cut and paste items to rearrange. | '+U(ss({Ce:"waffle-printing-button waffle-printing-custom-headers-footers-button waffle-printing-custom-headers-footers-clear",content:ur("CLEAR FIELDS"),style:0}))+'</div><div class="waffle-printing-custom-headers-footers-card-wrapper"></div></div>');return V(a)}
function hcd(a){return V('<div class="waffle-printing-checkbox-wrapper"><span id="'+W(a.id)+'" class="jfk-checkbox waffle-printing-checkbox" aria-labelledby="'+W(a.id)+'.lbl"></span><label for="'+W(a.id)+'" id="'+W(a.id)+'.lbl" class="waffle-printing-checkbox-label">'+U(a.label)+"</label></div>")}
function icd(a){return V('<div class="waffle-printing-radio-button-wrapper">'+U(iU({id:a.id,label:vr('<label for="'+W(a.id)+'" id="'+W(a.id)+'.lbl" class="jfk-radiobutton-label">'+U(a.label)+"</label>"),checked:a.checked}))+"</div>")}function Wbd(){return V('<div class="waffle-printing-float-clear"></div>')};function z3(a,b){a=void 0===a?null:a;gq.call(this,!0,b);this.pb=a;this.Ia=null}la(z3,gq);z3.prototype.Ga=function(){gq.prototype.Ga.call(this);var a=this.La;a.style.left="0";a.style.top="0";a.style.bottom="0";a.style.right="0";var b=T(Mbd,{Cg:this.pb});this.Ba().appendChild(a,b)};z3.prototype.Sa=function(){gq.prototype.Sa.call(this);var a=new zq(this.La);F(this,a);this.getHandler().R(a,"key",this.H);this.setVisible(!0);this.La.focus()};
function jcd(a){return a.bb("waffle-printing-header-bar-right")}function kcd(a,b){if(!a.Ia){var c=a.bb("waffle-printing-pane-content");a.Ba().appendChild(c,b);a.Ia=b}}z3.prototype.H=ca();function A3(a){E.call(this);this.D=a;this.cb=new J(this);F(this,this.cb)}la(A3,E);A3.prototype.F=function(a,b,c,d,e,f,h){var k=this;b.save();ritz_api.RitzEntryPoint.loadChartsApi(function(){if(k.isDisposed())b.restore();else{var l=JC(k.D.C(parseInt(a,10))),m=l.tf(),q=new Xg(c,d,e,f);l.Rd()?lcd(k,l,b,q,h):m&&(new hU(KC,m)).send(u(k.C,k,l,b,q,h))}})};A3.prototype.C=function(a,b,c,d,e){this.isDisposed()||e.Ci()?b.restore():(a.$d(e.Rd()),lcd(this,a,b,c,d))};
function lcd(a,b,c,d,e){c.globalAlpha=1;c.translate(d.left,d.top);var f=d.width,h=d.height;c.lineWidth=1;c.strokeStyle="#999";c.strokeRect(0,0,f,h);if(en()&&(d=ritz_api.ChartsApi.createChart(b.toJSON(),b.Rd().toJSON(),ritz_api.RitzModelApi.getWorkbookLocale()))){ritz_api.ChartsApi.drawChart(c,d,ritz.charts.api.InteractionState.none(),f,h,!0);c.restore();e();return}d=Jl("DIV");CU(b,b.Rd(),!0);b.setOption("height",h);b.setOption("width",f);b.qj(d);var k=d.getElementsByTagName("img")[0];!k&&(b=d.getElementsByTagName("svg")[0])&&
(b=(new XMLSerializer).serializeToString(b),k=new Image(f,h),k.src="data:image/svg+xml,"+encodeURIComponent(b));k?a.cb.Jc(k,"load",function(){c.drawImage(k,0,0,f,h);c.restore();e()}):(c.fillStyle="#efefef",c.fillRect(0,0,f,h),d.getElementsByTagName("object")[0]||mcd(c,f,h),c.restore(),e())}A3.prototype.printChart=A3.prototype.F;
function mcd(a,b,c){a.save();a.fillStyle="#212121";a.textAlign="center";a.font="bold 16px Roboto,Arial,sans-serif";a.textBaseline="bottom";a.fillText("Chart will appear in final pages",b/2,c/2,b-10);a.font="16px Roboto,Arial,sans-serif";a.textBaseline="top";a.fillText("Can't load in preview",b/2,c/2,b-10);a.restore()};function B3(a,b,c){Wt(a,b,c,void 0,function(){c.gb(b.Za())},Ha(ncd,b))}function ocd(a,b,c){var d=new Wia;N(d,1,1E3*c);c=lja(qi(new pi,25),d).build();a.fc(b,c)}function ncd(){return qi(new pi,25).build()};function pcd(a,b){R.call(this,b);this.J=a;this.D=this.Ba().createElement("CANVAS");axb(this.D);this.C=X3a(this.D);this.F=new lV(!0,void 0,void 0,void 0,void 0,this.Ba());this.Wa(this.F);this.L=0;this.H=!0}la(pcd,R);p=pcd.prototype;p.Ga=function(){this.La=T(Qbd);this.Ba().appendChild(Dl("waffle-printing-preview-card",this.La),this.D)};p.Sa=function(){R.prototype.Sa.call(this);this.F.render(Dl("waffle-printing-preview-spinner",this.La))};
p.JK=function(a){return this.isDisposed()?zi("This card has been disposed."):qcd(this,a)};function rcd(a,b){a.L!=b&&(a.L=b,a.La.firstChild.style.width=100*b+"%",b=Math.min(40,40*b)+"px",a.La.style.marginBottom=b,a.La.style.marginTop=b)}p.Jd=function(a){if(a.width!=this.D.width||a.height!=this.D.height)Cp(this.bb("waffle-printing-preview-card"),a),this.D.width=a.width,this.D.height=a.height;this.C.fillStyle="#FFFFFF";this.C.globalAlpha=1;this.C.fillRect(0,0,this.D.width,this.D.height)};
p.getWidth=function(){return Fp(this.La.firstChild).width};function qcd(a,b){if(a.isDisposed())return zi("This card has been disposed.");var c=a.C;c.save();var d=96*a.J.getHeight()/72,e=96*a.J.getWidth()/72;c.scale(a.D.width/e,a.D.height/d);return new wi(function(a){ritz_api.PrintApi.printNextPage(b,c,u(function(b){this.isDisposed()||(this.H=!1,this.F.setActive(!1),c.restore(),a(b))},this))},a)};function C3(a,b,c,d,e,f,h){z3.call(this,"waffle-custom-headers-footers-pane",h);this.D=a.D;this.Xb=scd.cd(vf.Ra(),tcd.serialize(a.C));this.Qb=b;this.Ub=c;this.V=e;this.zb=f;this.fb=b.J;this.$a=new A3(this.fb);F(this,this.$a);this.Mb=SD(d,7);this.Ib=SD(d,4);this.F=new ts(void 0,this.Ba());this.Wa(this.F);this.J=new ts(void 0,this.Ba());this.Wa(this.J);this.O=new ts(void 0,this.Ba());this.Wa(this.O);this.C=new pcd(this.D,this.Ba());this.Wa(this.C);this.Ca=Xja(0);this.ib=ritz_api.PrintApi.createRitzPrinter(ritz_api.RitzModelApi.getTopLevelModel(),
this.Qb.D.F,96*this.D.getHeight()/72,96*this.D.getWidth()/72,scd.serialize(this.Xb),this.Ub.C,wD,this.zb,this.fb,this.Mb,this.Ib,this.$a);this.L=null}la(C3,z3);C3.prototype.Ga=function(){z3.prototype.Ga.call(this);this.Ba().appendChild(this.bb("waffle-printing-header-bar-left"),T(ecd));this.Ba().appendChild(jcd(this),T(fcd));kcd(this,T(gcd));this.C.render(this.bb("waffle-printing-custom-headers-footers-card-wrapper"))};
C3.prototype.Sa=function(){var a=this;z3.prototype.Sa.call(this);B3(this.V,this.F,X.s6);B3(this.V,this.J,X.KX);B3(this.V,this.O,X.Tga);this.F.mb(this.bb("waffle-printing-custom-headers-footers-confirm"));this.J.mb(this.bb("waffle-printing-custom-headers-footers-cancel"));this.O.mb(this.bb("waffle-printing-custom-headers-footers-clear"));rcd(this.C,ucd(this));vcd(this);this.C.Jd(wcd(this));this.Ca=this.Ca.then(function(){return a.C.JK(a.ib)})};function wcd(a){a.L||vcd(a);return a.L}
function ucd(a){var b=wcd(a).height;a=Fp(a.La).height-182;return b<=a?1:a/b}function vcd(a){var b=a.C.getWidth(),c=b*a.D.getHeight()/a.D.getWidth();a.L=new Ug(b,c)}C3.prototype.H=function(a){27==a.keyCode&&X.KX.Ec()};C3.prototype.Ja=function(){this.Ca.cancel("Dispose internal");ritz_api.PrintApi.dispose(this.ib);z3.prototype.Ja.call(this)};var scd=new rh;function xcd(){this.C=[new D3("letter",612,792,'Letter (8.5" x 11")',"Letter (21.6 cm x 27.9 cm)","Letter, 8.5 inches by 11 inches","Letter, 21.6 centimetres by 27.9 centimetres"),new D3("letter",792,612),new D3("tabloid",792,1224,'Tabloid (11" x 17")',"Tabloid (27.9 cm x 43.2 cm)","Tabloid, 11 inches by 17 inches","Tabloid, 27.9 centimetres by 43.2 centimetres"),new D3("tabloid",1224,792),new D3("legal",612,1008,'Legal (8.5" x 14")',"Legal (21.6 cm x 35.6 cm)","Legal, 8.5 inches by 14 inches","Legal, 21.6 centimetres by 35.6 centimetres"),
new D3("legal",1008,612),new D3("statement",396,612,'Statement (5.5" x 8.5")',"Statement (14.0 cm x 21.6 cm)","Statement, 5.5 inches by 8.5 inches","Statement, 14.0 centimetres by 21.6 centimetres"),new D3("statement",612,396),new D3("executive",522,756,'Executive (7.25" x 10.5")',"Executive (18.4 cm x 26.7 cm)","Executive, 7.25 inches by 10.5 inches","Executive, 18.4 centimetres by 26.7 centimetres"),new D3("executive",756,522),new D3("folio",612,936,'Folio (8.5" x 13")',"Folio (21.6 cm x 33.0 cm)",
"Folio, 8.5 inches by 13 inches","Folio, 21.6 centimetres by 33.0 centimetres"),new D3("folio",936,612),new D3("A3",297*Az,420*Az,'A3 (11.69" x 16.54")',"A3 (29.7 cm x 42.0 cm)","A3, 11.69 inches by 16.54 inches","A3, 29.7 centimetres by 42.0 centimetres"),new D3("A3",420*Az,297*Az),new D3("A4",210*Az,297*Az,'A4 (8.27" x 11.69")',"A4 (21.0 cm x 29.7 cm)","A4, 8.27 inches by 11.69 inches","A4, 21.0 centimetres by 29.7 centimetres"),new D3("A4",297*Az,210*Az),new D3("A5",148*Az,210*Az,'A5 (5.83" x 8.27")',
"A5 (14.8 cm x 21.0 cm)","A5, 5.83 inches by 8.27 inches","A5, 14.8 centimetres by 21.0 centimetres"),new D3("A5",210*Az,148*Az),new D3("B4",250*Az,353*Az,'B4 (9.84" x 13.90")',"B4 (25.0 cm x 35.3 cm)","B4, 9.84 inches by 13.90 inches","B4, 25.0 centimetres by 35.3 centimetres"),new D3("B4",353*Az,250*Az),new D3("B5",176*Az,250*Az,'B5 (6.93" x 9.84")',"B5 (17.6 cm x 25.0 cm)","B5, 6.93 inches by 9.84 inches","B5, 17.6 centimetres by 25.0 centimetres"),new D3("B5",250*Az,176*Az)]}ta(xcd);
function ycd(a,b,c){for(var d=0;d<a.C.length;d++){var e=a.C[d];if(e.C==b&&e.D==c)return e}return null}function D3(a,b,c,d,e,f,h){this.C=a;this.xd=b;this.ad=c;this.H=d||null;this.F=e||null;this.L=f||this.H;this.J=h||this.F;this.D=this.ad>this.xd}D3.prototype.getWidth=g("xd");D3.prototype.getHeight=g("ad");function zcd(a,b,c){I.call(this);this.C=tcd.cd(vf.Ra(),a);C(this.C,20,!0);Bc(this.C,11);a=Lbd(""+c);Ac(this.C,11,a);b=Db(Acd,b.C)?"letter":"A4";this.D=ycd(xcd.getInstance(),b,!1);this.F=1;this.H=!1;this.J=new Be}la(zcd,I);function Bcd(a){return yc(a.C,11)?Ec(a.C,11):[]}function Ccd(a,b,c){if(a.F!=b||!Vb(c,Bcd(a),zic)){a.F=b;Bc(a.C,11);for(b=0;b<c.length;b++)Ac(a.C,11,c[b]);a.dispatchEvent(new H("rf"))}}function Dcd(a,b){B(a.C,28)!=b&&(C(a.C,28,b),a.dispatchEvent(new H("rf")))}
function Ecd(a){return a.H?"c":lc(Fcd,function(b){return Gcd(Hcd(b),E3(a))})||"c"}function Icd(a,b){b&&!Gcd(b,E3(a))&&(C(a.C,15,b),a.dispatchEvent(new H("rf")))}function E3(a){return yc(a.C,15)?B(a.C,15):new wf}function Jcd(a){var b=[];$b(Kcd(a,!0),function(a,d){b.push(d+"="+a)});return b.join(",")}function Lcd(a){switch(a){case 0:return"DEFAULT";case 1:return"LEFT";case 2:return"CENTER";case 3:return"RIGHT"}}
function Mcd(a){switch(a){case 1:return"TOP";case 2:return"MIDDLE";case 3:return"BOTTOM"}}
function Kcd(a,b){var c=new rh;c.rv=!0;b={size:Ncd[a.D.C],fzr:B(a.C,21),fzc:B(a.C,22),portrait:a.D.D,scale:B(a.C,6)+"",spct:B(a.C,7)+"",gridlines:!B(a.C,1),printnotes:B(a.C,8),printtitle:B(a.C,3),printdate:B(a.C,18),printtime:B(a.C,19),sheetnames:B(a.C,4),pagenum:B(a.C,2)?"CENTER":void 0,pageorder:B(a.C,16),attachment:!b,top_margin:E3(a).getTop(),bottom_margin:B(E3(a),2),left_margin:E3(a).getLeft(),right_margin:B(E3(a),4),timestamp:B(a.C,27),horizontal_alignment:Lcd(B(a.C,28)),vertical_alignment:Mcd(B(a.C,
29)),gridFiltersProto:Uh(c.serialize(a.J))};a=Bcd(a);0!=a.length&&(b.gid=a.map(function(a){return a.Jb()}).join("\uee00"),yc(a[0],2)||yc(a[0],3)||yc(a[0],4)||yc(a[0],5))&&(b.r1=a[0].qc()||0,b.r2=a[0].Lc()||0,b.c1=a[0].hc()||0,b.c2=a[0].Sc()||0,yc(a[0],4)||yc(a[0],5)||(b.ir=!0),yc(a[0],2)||yc(a[0],3)||(b.ic=!0));return b}
var Fcd={Gga:"n",V1a:"r",w4a:"w",CUSTOM:"c"},Hcd=Ly(function(a){switch(a){case "n":return B(tcd.cd(vf.Ra(),sc(ritz_api.PrintApi.getDefaultPrintConfig())),15);case "r":return a=new wf,C(a,1,.75),C(a,2,.75),C(a,3,.25),C(a,4,.25),a;case "w":return a=new wf,C(a,1,1),C(a,2,1),C(a,3,1),C(a,4,1),a;case "c":return null}});function Gcd(a,b){return a==b||!!a&&!!b&&a.getLeft()==b.getLeft()&&B(a,4)==B(b,4)&&a.getTop()==b.getTop()&&B(a,2)==B(b,2)}
var tcd=new rh,Acd=["en","en_US","fil"],Ncd={letter:"0",tabloid:"33",legal:"2",statement:"32",executive:"30",folio:"31",A3:"6",A4:"7",A5:"8",B4:"18",B5:"19"};var Ocd=new Ln(Kn.DECIMAL_PATTERN),Pcd=new Ln(Kn.Pd);function Qcd(a,b,c){Iq.call(this,void 0,void 0,c);var d=this;this.Xa=a;this.J=b;this.Z=[];this.Ca=this.C=this.H=null;this.O=new QS(this.Ba());this.Wa(this.O);this.Pa=new Fk(function(){return Rcd(d)},1);F(this,this.Pa);this.V={top:!1,right:!1,bottom:!1,left:!1}}la(Qcd,Iq);p=Qcd.prototype;p.Ga=function(){this.La=T(ccd)};
p.Sa=function(){var a=this;Iq.prototype.Sa.call(this);this.O.render();fp(this.O.La,"waffle-printing-error-bubble");Wt(this.Xa,this,X.Ap);var b=new Io(this);F(this,b);Jo(Jo(Jo(Jo(Jo(Jo(b,X.Ap,Zn,this.nV),X.GJ,Yn,this.nV),X.HJ,Yn,this.nV),X.EJ,Yn,this.nV),X.yJ,Yn,this.nV),X.zJ,Yn,this.nV);$b(Scd,function(b){var c=F3(a,b);cp(c,Tcd(a,b));var e=new zq(c);F(a,e);a.getHandler().R(e,"key",Ha(a.sKb,b)).R(c,"blur",Ha(a.qKb,b)).R(c,"focus",Ha(a.rKb,b));a.getHandler().R(c,["mousedown","mouseup","click"],function(a){return a.stopPropagation()})})};
p.Di=function(a){for(var b=a.target,c=gc(Scd),d=0;d<c.length;d++)if(F3(this,c[d])==b){Ucd(this,c[d]);break}return Iq.prototype.Di.call(this,a)};p.nV=function(){this.Pa.start()};p.sKb=function(a,b){if(this.V[a])switch(b.keyCode){case 13:case 9:Ucd(this,a)}};p.rKb=function(a){this.V[a]||(this.V[a]=!0,F3(this,a).select())};p.qKb=function(a){this.V[a]=!1;Ucd(this,a)};function Rcd(a){a.H&&a.C&&a.wc()&&a.kb()&&(Ic(a.Z),a.Z=[],Vcd(a,"top"),Vcd(a,"right"),Vcd(a,"bottom"),Vcd(a,"left"))}
p.setVisible=function(a,b){(b=Iq.prototype.setVisible.call(this,a,b))&&a&&Rcd(this);return b};
function Vcd(a,b){var c=Wcd(b),d=Xcd(a,b),e=Ycd(a,Zcd(a,b)),e=G3(a,Math.min(d,Math.max(c,e))),f=$cd(a,b),h=new Vp(f);F(a,h);a.Z.push(h);switch(b){case "top":f.style.top=e+"px";var k=new Xg(0,G3(a,c),0,G3(a,d-c));break;case "right":f.style.left=a.H.width-e+"px";k=new Xg(G3(a,a.C.getWidth()/72-d),0,G3(a,d-c),0);break;case "bottom":f.style.top=a.H.height-e+"px";k=new Xg(0,G3(a,a.C.getHeight()/72-d),0,G3(a,d-c));break;case "left":f.style.left=e+"px",k=new Xg(G3(a,c),0,G3(a,d-c),0)}Xp(h,k);a.pXa(b);Q(F3(a,
b),!0);a.getHandler().R(h,"drag",Ha(a.pXa,b)).R(h,"end",function(){add(a,b,bdd(a,b))})}p.pXa=function(a){F3(this,a).value=cdd(this,bdd(this,a));ddd(this,a,!1)};function Wcd(a){switch(a){case "left":case "right":return 0;case "top":return X.GJ.gg()||X.HJ.gg()?.6:0;case "bottom":return X.EJ.gg()||X.yJ.gg()||X.zJ.gg()?.6:0}}
function Xcd(a,b){switch(b){case "left":return a.C.getWidth()/72-B(H3(a),4)-1;case "right":return a.C.getWidth()/72-H3(a).getLeft()-1;case "top":return a.C.getHeight()/72-B(H3(a),2)-1;case "bottom":return a.C.getHeight()/72-H3(a).getTop()-1}}function Ucd(a,b){var c=F3(a,b);var d=Ocd.parse(c.value);isNaN(d)?d=null:(d=Ycd(a,d),d=d<Wcd(b)||Xcd(a,b)<d?null:d);null===d?ddd(a,b,!0):(add(a,b,d),ddd(a,b,!1),c.blur())}
function ddd(a,b,c){ZS(a.O);if(c){var d=Wcd(b),e=Xcd(a,b);c="Please enter a number in inches between "+(cdd(a,d)+(" and "+(cdd(a,e)+".")));d="Please enter a number in centimetres between "+(cdd(a,d)+(" and "+(cdd(a,e)+".")));a.O.Lj(F3(a,b));$S(a.O,F3(a,b));XS(a.O,a.J?c:d,!0)}}function cdd(a,b){b=Ocd.format(edd(a,b));return a.J?b+'"':b+" cm"}
function Zcd(a,b){switch(b){case "top":return edd(a,H3(a).getTop());case "right":return edd(a,B(H3(a),4));case "left":return edd(a,H3(a).getLeft());case "bottom":return edd(a,B(H3(a),2))}}function add(a,b,c){a=sc(H3(a));switch(b){case "top":C(a,1,c);break;case "right":C(a,4,c);break;case "left":C(a,3,c);break;case "bottom":C(a,2,c)}X.Ap.gb(a)}function G3(a,b){return b*a.H.width/(a.C.getWidth()/72)}function edd(a,b){return a.J?b:2.54*b}function Ycd(a,b){return a.J?b:b/2.54}
function bdd(a,b){var c=$cd(a,b);a:{switch(b){case "bottom":b=a.H.height-parseFloat(c.style.top);break a;case "left":b=parseFloat(c.style.left);break a;case "right":b=a.H.width-parseFloat(c.style.left);break a;case "top":b=parseFloat(c.style.top);break a}b=void 0}return b/a.H.width*(a.C.getWidth()/72)}function H3(a){return X.Ap.Za()||a.Ca}
function F3(a,b){switch(b){case "bottom":return a.bb("waffle-printing-margins-control-bottom-display");case "left":return a.bb("waffle-printing-margins-control-left-display");case "right":return a.bb("waffle-printing-margins-control-right-display");case "top":return a.bb("waffle-printing-margins-control-top-display")}}
function $cd(a,b){switch(b){case "bottom":return a.bb("waffle-printing-margins-control-bottom");case "left":return a.bb("waffle-printing-margins-control-left");case "right":return a.bb("waffle-printing-margins-control-right");case "top":return a.bb("waffle-printing-margins-control-top")}}
function Tcd(a,b){switch(b){case "bottom":return a.J?"Bottom margin (in inches)":"Bottom margin (in centimetres)";case "left":return a.J?"Left margin (in inches)":"Left margin (in centimetres)";case "right":return a.J?"Right margin (in inches)":"Right margin (in centimetres)";case "top":return a.J?"Top margin (in inches)":"Top margin (in centimetres)"}}var Scd={BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOP:"top"};function I3(a){E.call(this);this.ob=a||xl();this.cb=new J(this);F(this,this.cb);this.D=this.ob.createElement("DIV");this.D.style.display="inline";this.C=this.ob.createElement("DIV");this.C.style.display="inline";this.F=this.H=null}la(I3,E);function fdd(a,b,c){a.H=b;a.F=c;a.ob.lH(a.D,a.H);a.ob.RC(a.C,a.F);a.cb.R(a.D,"focus",a.J).R(a.C,"focus",a.L)}I3.prototype.eb=function(a){am(this.D,a);am(this.C,a)};I3.prototype.J=function(){this.F.focus()};I3.prototype.L=function(){this.H.focus()};
I3.prototype.Ja=function(){E.prototype.Ja.call(this);this.ob.removeNode(this.D);this.ob.removeNode(this.C)};function J3(a,b){Iq.call(this);this.H=a;this.O=b;this.C=new lU;F(this,this.C);this.getHandler().R(this.C,"change",this.J)}la(J3,Iq);J3.prototype.gb=function(a){for(var b=0;b<this.C.D.Lk();b++){var c=this.C.D.Bf(b);if(c.Za()==this.H(a)){mU(this.C,c);break}}};J3.prototype.Za=function(){return this.O(nU(this.C).Za())};J3.prototype.J=function(){this.dispatchEvent("action")};function K3(a,b,c,d){R.call(this,d);this.F=b;this.D=nb();this.C=new jU(this.Ba(),void 0,c);a.vH(this.C)}la(K3,R);K3.prototype.Ga=function(){this.La=T(icd,{id:this.D,label:this.F,checked:this.C.isChecked()})};K3.prototype.Sa=function(){R.prototype.Sa.call(this);this.C.mb(Al(this.D))};function gdd(a,b,c){R.call(this,c);this.O=a;this.Xa=b;this.F=new mV("Formatting",this.Ba());this.Wa(this.F);b=new Ms(this.Ba());b.Wa(new Tq("Centre",2,this.Ba()),!0);b.Wa(new Tq("Left",1,this.Ba()),!0);b.Wa(new Tq("Right",3,this.Ba()),!0);this.C=new NH(void 0,b,this.Ba());this.Wa(this.C);LS(this.C,RT.getInstance());dO(this.C,!0);b=new Ms(this.Ba());b.Wa(new Tq("Top",1,this.Ba()),!0);b.Wa(new Tq("Bottom",3,this.Ba()),!0);b.Wa(new Tq("Centre",2,this.Ba()),!0);this.D=new NH(void 0,b,this.Ba());this.Wa(this.D);
LS(this.D,RT.getInstance());dO(this.D,!0);this.Pa=new qV(X.LX,a,!0,this.Ba());this.Wa(this.Pa);this.Oa=new qV(X.Sga,a,!0,this.Ba());this.Wa(this.Oa);this.Ia=new qV(X.PX,a,!0,this.Ba());this.Wa(this.Ia);this.J=new J3(hdd,idd);F(this,this.J);this.qa=new K3(this.J.C,"Down, then over","1",this.Ba());this.Wa(this.qa);this.Ca=new K3(this.J.C,"Over, then down","2",this.Ba());this.Wa(this.Ca);this.L=new lU;F(this,this.L);this.Z=new K3(this.L,"Display inline","",this.Ba());this.Wa(this.Z);this.V=new K3(this.L,
"Append after page","",this.Ba());this.Wa(this.V);this.H=new I3(this.Ba());F(this,this.H)}la(gdd,R);
gdd.prototype.Sa=function(){var a=this;R.prototype.Sa.call(this);fp(this.La,"waffle-printing-options-section");this.F.render(this.La);this.F.setContent(T(Ybd,{sfb:Bg(K(),"fepui-extra")}));var b=this.bb("waffle-printing-formatting-toplevel");this.C.render(this.bb("waffle-printing-horizontal-alignment"));$o(this.C.La,"labelledby","waffle-printing-horizontal-alignment-label");this.D.render(this.bb("waffle-printing-vertical-alignment"));$o(this.D.La,"labelledby","waffle-printing-vertical-alignment-label");
this.Pa.render(b);Bg(K(),"fepui-extra")||(fdd(this.H,F3(this.Xa,"left"),this.F.C.La),this.H.eb(X.Ap.isEnabled()),b=new Io(this),F(this,b),Jo(b,X.Ap,$n,function(b){a.H.eb(b.newValue)}));b=this.bb("waffle-printing-collaboration");Bg(K(),"fepui-extra")&&this.Oa.render(b);this.Ia.render(b);b=this.bb("waffle-printing-page-order");this.qa.render(b);this.Ca.render(b);b.appendChild(T(Wbd));Bg(K(),"fepui-extra")&&(b=this.bb("waffle-printing-formatting-embedded-objects"),this.Z.render(b),this.V.render(b),b.appendChild(T(Wbd)));
B3(this.O,this.C,X.NX);B3(this.O,this.D,X.UX);B3(this.O,this.J,X.QX)};function hdd(a){return""+a}function idd(a){return parseInt(a,10)};function jdd(a,b,c){R.call(this,c);this.V=b;this.D=new mV("Headers & footers",this.Ba());this.Wa(this.D);this.L=new qV(X.EJ,b,!0,this.Ba());this.Wa(this.L);this.J=new qV(X.HJ,b,!0,this.Ba());this.Wa(this.J);this.O=new qV(X.GJ,b,!0,this.Ba());this.Wa(this.O);this.F=new qV(X.yJ,b,!0,this.Ba());this.Wa(this.F);this.H=new qV(X.zJ,b,!0,this.Ba());this.Wa(this.H);this.C=new ts(void 0,this.Ba());this.Wa(this.C)}la(jdd,R);
jdd.prototype.Sa=function(){R.prototype.Sa.call(this);fp(this.La,"waffle-printing-options-section");this.D.render(this.La);this.D.setContent(T(Zbd));var a=this.Hb("waffle-printing-haf-toplevel");this.L.render(a);this.J.render(a);this.O.render(a);this.F.render(a);this.H.render(a);this.C.mb(this.bb("waffle-printing-custom-headers-footers-entry-button"));B3(this.V,this.C,X.JX);this.C.setVisible(X.JX.kb())};function kdd(a,b,c){R.call(this,c);this.F=b;this.D=new ts(void 0,this.Ba());this.Wa(this.D);this.C=new I3(this.Ba());F(this,this.C)}la(kdd,R);kdd.prototype.Ga=function(){this.La=T(Xbd)};kdd.prototype.Sa=function(){var a=this;R.prototype.Sa.call(this);this.D.render(this.La);fdd(this.C,F3(this.F,"left"),this.D.La);this.C.eb(X.Ap.isEnabled());var b=new Io(this);F(this,b);Jo(b,X.Ap,$n,function(b){a.C.eb(b.newValue)})};function ldd(a,b,c,d){R.call(this,d);this.Z=a;this.J=c;this.C=new mV("Row & column headers",this.Ba());this.Wa(this.C);this.L=new qV(X.AJ,b,!0,this.Ba());this.Wa(this.L);this.H=new qV(X.CJ,b,!0,this.Ba());this.Wa(this.H);this.F=new I3(this.Ba());F(this,this.F);this.D=new I3(this.Ba());F(this,this.D)}la(ldd,R);
ldd.prototype.Sa=function(){var a=this;R.prototype.Sa.call(this);fp(this.La,"waffle-printing-options-section");this.C.render(this.La);this.C.setContent(T($bd));this.L.render(this.bb("waffle-printing-rfs-columns"));this.H.render(this.bb("waffle-printing-rfs-rows"));fdd(this.F,this.H.C.La,this.J.C.La);this.F.eb(!1);fdd(this.D,this.C.C.La,this.J.C.La);this.D.eb(!0);mdd(this,"c",X.AJ.gg());mdd(this,"r",X.CJ.gg());var b=new Io(this);F(this,b);Jo(Jo(b,X.AJ,Yn,this.O),X.CJ,Yn,this.V);this.getHandler().R(this.C,
"charteditor-collapsiblesectionheader-opened",function(){a.F.eb(!0);a.D.eb(!1)}).R(this.C,"charteditor-collapsiblesectionheader-closed",function(){a.F.eb(!1);a.D.eb(!0)})};ldd.prototype.O=function(a){mdd(this,"c",a.newValue)};ldd.prototype.V=function(a){mdd(this,"r",a.newValue)};function mdd(a,b,c){c=c&&!Kbd(a.Z).some(function(a){return rz(a.Pc(),b)});Q(a.bb("r"==b?"waffle-printing-rfs-rows-warning":"waffle-printing-rfs-columns-warning"),c)};function L3(a,b,c,d){ls.call(this,a,c,d);this.C=b||null;F(this,this.C);this.Rf(64,!0)}la(L3,ls);L3.prototype.Sa=function(){ls.prototype.Sa.call(this);$o(this.La,"haspopup",!0);Pq(this,64,!0)};function ndd(a,b){G(a.C);a.C=b;F(a,a.C);a.getHandler().R(a.C,"action",function(b){b.target==a.C&&(a.xe(!1),a.La.focus(),a.dispatchEvent("action"))})}L3.prototype.gb=function(a){if(this.C)return this.C.gb(a)};L3.prototype.Za=function(){return this.C?this.C.Za():null};
L3.prototype.xe=function(a){ls.prototype.xe.call(this,a);a&&!this.C.wc()&&this.C.render();this.C.setVisible(a);a&&$r(this.La,0,this.C.La,0,void 0,void 0,32)};function odd(a,b){R.call(this,b);this.F=a;this.D=nb();this.C=new Fr(void 0,this.Ba());LS(this.C,fV.getInstance());this.Wa(this.C)}la(odd,R);odd.prototype.Ga=function(){this.La=T(hcd,{id:this.D,label:this.F})};odd.prototype.Sa=function(){R.prototype.Sa.call(this);var a=this.Ba().getElement(this.D);this.C.mb(a);pr(this.C,a.nextSibling)};function pdd(){var a=""+('<div class="waffle-printing-select-list"><div><div class="waffle-printing-select-list-checkboxes"></div><div class="waffle-printing-select-list-buttons">'+U(ss({content:ur("CANCEL"),style:0,Ce:"waffle-printing-button waffle-printing-cancel-button waffle-printing-select-list-cancel"}))+U(ss({content:ur("APPLY"),style:2,Ce:"waffle-printing-button waffle-printing-active-button waffle-printing-select-list-apply"}))+"</div></div></div>");return V(a)};function qdd(a,b,c){Iq.call(this,void 0,void 0,c);Jq(this,!1);this.V=a;this.O=b;this.C=[];this.H=new ts("",this.Ba());this.Wa(this.H);this.J=new ts("",this.Ba());this.Wa(this.J)}la(qdd,Iq);p=qdd.prototype;p.Ga=function(){this.La=T(pdd)};
p.Sa=function(){var a=this;Iq.prototype.Sa.call(this);this.H.mb(this.Hb("waffle-printing-select-list-apply"));this.J.mb(this.Hb("waffle-printing-select-list-cancel"));for(var b=ka(this.V),c=b.next();!c.done;c=b.next()){var d=c.value,c=d.id,d=new odd(d.label,this.Ba());this.Wa(d);d.render(this.bb("waffle-printing-select-list-checkboxes"));d.C.Ee(c);this.C.push(d.C)}rdd(this);b=new HG(this.La.firstChild,this.Ba());F(this,b);IG(b);b=new mp(this.La);F(this,b);this.getHandler().R(this.H,"action",function(){return sdd(a,
!0)}).R(this.J,"action",function(){return sdd(a,!1)}).R(b,"focusout",this.BKb)};p.setVisible=function(a,b){b=Iq.prototype.setVisible.call(this,a,b);a&&(this.C.length?this.C[0].La.focus():this.La.focus());return b};p.gb=function(a){this.O=a;rdd(this)};p.Za=g("O");p.Wj=function(a){return 27==a.keyCode?(sdd(this,!1),!0):Iq.prototype.Wj.call(this,a)};function sdd(a,b){b?a.gb(tdd(a)):rdd(a);a.setVisible(!1);a.dispatchEvent("action")}
p.BKb=function(a){function b(a){a&&!c.Ba().contains(c.La,a)&&sdd(c,!1)}var c=this;a.relatedTarget?b(a.relatedTarget):(a=new Fk(function(){var a=nm(c.Ba());b(a)}),F(this,a),a.start())};p.Di=function(a){return a.target!=this};function rdd(a){if(a.Za()&&0<a.Za().length)udd(a,a.Za());else{a=ka(a.C);for(var b=a.next();!b.done;b=a.next())b.value.tc(!0)}}function udd(a,b){a.C.forEach(function(a){a.tc(b.some(function(b){return zic(b,a.hb())}))})}
function tdd(a){var b=a.C.filter(function(a){return a.isChecked()});return b.length==a.C.length?[]:b.map(function(a){return a.hb()})};function M3(a,b,c,d,e){R.call(this,e);this.L=a;this.Ca=b;this.O=c;this.Xa=d;this.C=new NH(void 0,void 0,this.Ba());this.Wa(this.C);LS(this.C,RT.getInstance());dO(this.C,!0);this.J=new L3(void 0,void 0,RT.getInstance(),this.Ba());this.Wa(this.J);this.D=new NH(void 0,void 0,this.Ba());this.Wa(this.D);LS(this.D,RT.getInstance());dO(this.D,!0);this.V=new J3(vdd,wdd);F(this,this.V);this.qa=new K3(this.V.C,"Landscape","false",this.Ba());this.Wa(this.qa);this.Ia=new K3(this.V.C,"Portrait","true",this.Ba());
this.Wa(this.Ia);this.F=[];this.H=this.Z=null}la(M3,R);M3.prototype.Ga=function(){this.La=T(Ubd,{jqa:this.Xa})};
M3.prototype.Sa=function(){R.prototype.Sa.call(this);var a=this.Hb("waffle-printing-print");this.C.render(a);fp(this.C.La,"waffle-printing-full-size");$o(this.C.La,"labelledby","waffle-printing-print-label");a=this.Hb("waffle-printing-fine-grained-selection-button");this.J.render(a);fp(this.C.La,"waffle-printing-full-size");Q(this.bb("waffle-printing-fine-grained-selection"),!1);X.Qy.eb(!1);a=this.Hb("waffle-printing-paper-size");this.D.render(a);fp(this.D.La,"waffle-printing-full-size");$o(this.D.La,
"labelledby","waffle-printing-paper-size-label");a=this.Hb("waffle-printing-page-orientation-inner");this.qa.render(a);this.Ia.render(a);a.appendChild(T(Wbd));xdd(this);for(var a=xcd.getInstance().C,b=0;b<a.length;b++)if(a[b].D){var c=new Tq(this.Ca?a[b].H:a[b].F,a[b].C,this.Ba());Lq(c,this.Ca?a[b].L:a[b].J);this.D.re(c)}B3(this.O,this.C,X.gQ);B3(this.O,this.J,X.Qy);B3(this.O,this.D,X.SX);B3(this.O,this.V,X.RX);a=new Io(this);F(this,a);Jo(Jo(a,X.gQ,Zn,this.Oa),X.Qy,Zn,this.Pa)};
function xdd(a){for(;0<a.C.Lk();)a.C.rC(0);var b=a.L.getActiveGrid(),c="Selected cells ("+((b?yv(b.Pc().Rc()):null)+")"),d=new Tq("Current sheet",1,a.Ba());a.C.re(d);kt(a.C,d);a.Z=new Tq("Workbook",0,a.Ba());a.C.re(a.Z);a.Z.setVisible(1<uB(a.L));c=new Tq(c,2,a.Ba());a.C.re(c);c.setVisible(!!b);Bg(K(),"fepui-extra")&&(a.H=new Tq("Detected tables",3,a.Ba()),a.C.re(a.H),a.H.setVisible(!1),ritz_api.TablesApi.getAllTables(function(b){!a.isDisposed()&&b.length&&ydd(a,b)},ritz_api.TablesApi.filterByMinNumRecordsAndFields(4,
4)))}function ydd(a,b){a.F=b.filter(function(b){b=bWb(b.getTableRange());return!hz(a.L,parseInt(b.Jb(),10)).F}).map(function(a){return bWb(a.getTableRange())});0<a.F.length&&a.H.setVisible(!0);1==a.F.length?(b="Detected table ("+(zdd(a,a.F[0])+")"),a.H.setContent(b)):a.H.Ee(a.F)}function zdd(a,b){var c=1<Kbd(a.L).length,d=parseInt(b.Jb(),10);return yv(xh(b),c?hz(a.L,d).C:void 0)}M3.prototype.Oa=function(a){Add(this,X.Qy.Za());3==a.newValue&&X.Qy.gb(this.F)};
M3.prototype.Pa=function(a){Vb(a.newValue,a.oldValue,zic)||Add(this,a.newValue)};
function Add(a,b){if(!a.J.Of()){var c=a.C.Cf(),d="",e=[];c==a.Z?(e=G_a(a.L).map(function(a){return{id:Lbd(""+a.Jb()),label:a.C}}),d=(new Nn("{NUM_SHEETS,plural, =0{All sheets}=1{1 sheet}other{# sheets}}")).format({NUM_SHEETS:b.length})):c==a.H&&(e=a.F.map(function(b){return{id:b,label:zdd(a,b)}}),d=(new Nn("{NUM_TABLES,plural, =0{All detected tables}=1{1 detected table}other{# detected tables}}")).format({NUM_TABLES:b.length}));c=a.bb("waffle-printing-fine-grained-selection");Q(c,null!=e&&1<e.length);
X.Qy.eb(!0);a.J.xM(d);ndd(a.J,new qdd(e,b,a.Ba()))}}function vdd(a){return""+a}function wdd(a){return"true"==a};function Bdd(a){Iq.call(this,void 0,void 0,a);this.C=new JO(void 0,this.Ba());this.Wa(this.C);this.H=new QS(this.Ba());F(this,this.H);this.O=1;this.J=!1;xza(this,!0);this.Rf(32,!1)}la(Bdd,Iq);p=Bdd.prototype;
p.Sa=function(){Iq.prototype.Sa.call(this);this.C.render(this.La);var a=this.C.La;this.Ba().Vk(this.La,!1);this.Ba().Vk(a,!0);this.H.render();this.H.Lj(a);$S(this.H,a);ZS(this.H);fp(a,"waffle-printing-percent-input");fp(this.H.La,"waffle-printing-error-bubble");fp(this.H.La,"waffle-printing-percent-error-bubble");Cdd(this,this.Za());var b=new zq(a);F(this,b);this.getHandler().R(b,"key",this.vKb).R(a,"blur",this.tKb).R(a,"focus",this.uKb)};p.vKb=function(a){if(this.J)switch(a.keyCode){case 13:case 9:Ddd(this)}};
p.uKb=function(){this.J||(this.J=!0,this.C.La.select())};p.tKb=function(){this.J=!1;Ddd(this)};function Ddd(a){var b=db(a.C.Za(),Kn.PERCENT),b=Ocd.parse(b);!isNaN(b)&&isFinite(b)&&0<b?(Edd(a,!1),a.gb(b/100)&&a.dispatchEvent("action")):Edd(a,!0)}function Edd(a,b){b?XS(a.H,"Please enter a positive number.",!0):ZS(a.H)}p.gb=function(a){Cdd(this,a);return this.O!=a?(this.O=a,this.dispatchEvent("change"),!0):!1};p.Za=g("O");function Cdd(a,b){a.wc()&&(a.C.gb(Pcd.format(b)),a.C.La.blur())};function Fdd(a,b,c){R.call(this,c);this.J=a;this.L=b;a=new Ms(this.Ba());a.Wa(new Tq("Normal (100%)",1,this.Ba()),!0);a.Wa(new Tq("Fit to width",2,this.Ba()),!0);a.Wa(new Tq("Fit to height",3,this.Ba()),!0);a.Wa(new Tq("Fit to page",4,this.Ba()),!0);a.Wa(new Tq("Customised",5,this.Ba()),!0);this.F=new NH(void 0,a,this.Ba());this.Wa(this.F);LS(this.F,RT.getInstance());dO(this.F,!0);this.D=new Bdd(this.Ba());LS(this.D,rV.getInstance());this.Wa(this.D);a=new Ms(this.Ba());a.Wa(new Tq("Normal","n",this.Ba()),
!0);a.Wa(new Tq("Narrow","r",this.Ba()),!0);a.Wa(new Tq("Wide","w",this.Ba()),!0);a.Wa(new Tq("Customised","c",this.Ba()),!0);this.C=new NH(void 0,a,this.Ba());this.Wa(this.C);LS(this.C,RT.getInstance());dO(this.C,!0);this.H=new I3(this.Ba());F(this,this.H)}la(Fdd,R);Fdd.prototype.Ga=function(){this.La=T(Vbd)};
Fdd.prototype.Sa=function(){var a=this;R.prototype.Sa.call(this);var b=this.Hb("waffle-printing-scale");this.F.render(b);$o(this.F.La,"labelledby","waffle-printing-scale-label");b=this.Hb("waffle-printing-custom-scale");this.D.render(b);$o(this.D.C.La,"labelledby","waffle-printing-custom-scale-label");b=this.Hb("waffle-printing-margins");this.C.render(b);$o(this.C.La,"labelledby","waffle-printing-margins-label");fdd(this.H,this.C.La,F3(this.L,"top"));this.H.eb(X.Ap.isEnabled());B3(this.J,this.F,X.TX);
B3(this.J,this.D,X.WE);B3(this.J,this.C,X.OX);b=new Io(this);F(this,b);Jo(Jo(b,X.WE,$n,function(b){Q(a.bb("waffle-printing-custom-scale-wrapper"),b.newValue);b.newValue&&a.D.C.La.focus()}),X.Ap,$n,function(b){a.H.eb(b.newValue)});Q(this.bb("waffle-printing-custom-scale-wrapper"),X.WE.isEnabled())};function Gdd(a,b,c,d,e,f){R.call(this,f);this.C=new M3(a,b,c,e,this.Ba());this.Wa(this.C);this.D=new Fdd(c,d,this.Ba());this.Wa(this.D)}la(Gdd,R);Gdd.prototype.Ga=function(){this.La=T(Tbd)};Gdd.prototype.Sa=function(){R.prototype.Sa.call(this);this.C.render(this.La);this.D.render(this.La)};function Hdd(a,b,c,d,e,f,h,k){R.call(this,k);this.F=new ts("");this.Wa(this.F);this.D=new ts("");this.Wa(this.D);this.C=[new Gdd(b,f,c,d,h,this.Ba()),Bg(K(),"fepui-extra")?new kdd(0,d,this.Ba()):new R(this.Ba()),new gdd(c,d,this.Ba()),new jdd(0,c,this.Ba()),new ldd(b,c,e,this.Ba())];for(a=0;a<this.C.length;a++)this.Wa(this.C[a])}la(Hdd,R);Hdd.prototype.Ga=function(){this.La=T(Sbd)};Hdd.prototype.Sa=function(){R.prototype.Sa.call(this);for(var a=0;a<this.C.length;a++)this.C[a].render(this.Hb("waffle-printing-options-contents"))};function Idd(a){a=a.$b;var b=ur("Loading...");a=""+('<div class="waffle-ellipses'+(a?" waffle-ellipses-active":"")+'" aria-label="'+W(b)+'"><div class="waffle-ellipses-message-container" aria-live="assertive"'+(a?"":' style="display: none"')+">"+U(b)+'</div><div class="waffle-ellipses-container"><svg xmlns="http://www.w3.org/2000/svg" width="174px" height="14px" class="waffle-ellipses-sprite" viewBox="0 0 348 14"><g fill="#D8D8D8"><circle cx="341" cy="7" r="7"/><circle cx="319" cy="7" r="7"/><circle cx="297" cy="7" r="7"/><circle cx="283" cy="7" r="7"/><circle cx="261" cy="7" r="7"/><circle cx="239" cy="7" r="7" opacity=".3"/><circle cx="225" cy="7" r="7"/><circle cx="203" cy="7" r="7" opacity=".3"/><circle cx="181" cy="7" r="7" opacity=".3"/><circle cx="167" cy="7" r="7" opacity=".3"/><circle cx="145" cy="7" r="7" opacity=".3"/><circle cx="123" cy="7" r="7" opacity=".3"/><circle cx="109" cy="7" r="7" opacity=".3"/><circle cx="87" cy="7" r="7" opacity=".3"/><circle cx="65" cy="7" r="7"/><circle cx="51" cy="7" r="7" opacity=".3"/><circle cx="29" cy="7" r="7"/><circle cx="7" cy="7" r="7"/></g></svg></div></div>');
return V(a)};function Jdd(a,b){R.call(this,b);this.C=a}la(Jdd,R);Jdd.prototype.Ga=function(){this.La=T(Idd,{$b:this.C})};Jdd.prototype.setActive=function(a){this.C!=a&&(this.C=a,jp(this.La,"waffle-ellipses-active",a),Q(this.bb("waffle-ellipses-message-container"),a))};function Kdd(a){R.call(this,a);this.D=0;this.C=null;this.F=new Jdd(!0,this.Ba())}la(Kdd,R);Kdd.prototype.Ga=function(){this.La=T(Pbd)};Kdd.prototype.Sa=function(){R.prototype.Sa.call(this);this.F.render(this.Ba().bb("waffle-printing-preview-page-counter-ellipses",this.La));this.reset()};Kdd.prototype.reset=function(){this.D=0;this.C=null;Ldd(this,!0)};function Mdd(a,b){a.D=b;Ndd(a)}
function Ldd(a,b){a.F.setActive(b);Q(a.F.getElement(),b);a=a.Ba().bb("waffle-printing-preview-page-counter",a.La);Q(a,!b)}function Ndd(a){var b=a.D+1+(" of "+a.C),c=a.Ba().bb("waffle-printing-preview-page-counter",a.La);a.Ba().Df(c,b)};function Odd(a,b,c,d,e,f,h,k,l,m){R.call(this,m);this.D=a;this.Oa=b;this.ib=c;this.fb=d;this.Z=f;this.Kb=h;this.Ia=k;this.Wa(this.Ia);this.$a=l;this.Wa(this.$a);this.Ca=b.J;this.L=new A3(this.Ca);F(this,this.L);this.Xa=SD(e,7);this.Pa=SD(e,4);this.H=new Kdd(this.Ba());this.Wa(this.H);this.qa=Pdd(this);this.C=[];this.F=yi();this.O=0;this.J=null;this.V=!1}la(Odd,R);p=Odd.prototype;p.Ga=function(){this.La=T(Obd)};
p.Sa=function(){var a=this;R.prototype.Sa.call(this);var b=this.bb("waffle-printing-preview-inner"),c=new Io(this);F(this,c);Jo(Jo(Jo(c,X.u6,bo,this.zKb),X.v6,bo,this.DGb),X.Ap,$n,this.ipb);this.getHandler().R(b,"scroll",Bic(this.yKb,100,this)).R(this.D,"rf",function(){N3(a,"Printing model update",!1)}).R(this.D,"sf",function(){N3(a,"Printing model update",!0)}).R(this.Z,"image-loaded",this.wKb).R(this.Xa,"embedded-object-url-fetch-success",function(b){a.Z.C(b.url,void 0)}).R(this.Pa,"embedded-object-url-fetch-success",
function(b){a.Z.C(b.url,"use-credentials")}).R(this.fb,"I",this.xKb).R(dv(this.Oa.C),Qdd,this.TMa).R(this.Oa,Rdd,this.TMa);b=this.Ba().bb("waffle-printing-preview-page-counter-outer",this.La);this.H.mb(b);this.$a.render(this.La);this.Ia.render(this.La);N3(this,"Enter document",!0)};p.TMa=function(){N3(this,"Model update",!1)};p.wKb=function(){N3(this,"Image load",!1)};p.xKb=function(){N3(this,"Resize",!0)};
p.yKb=function(){var a=this.bb("waffle-printing-preview-inner"),b=a.scrollTop,c=Fp(a).height;this.V?Sdd(this,b,c):Tdd(this,b,a.scrollHeight,c)};function Sdd(a,b,c){if(a.V){var d=0,e=1;2<a.C.length&&(e=a.C[1].La.offsetTop-a.C[0].La.offsetTop,d=Math.floor(b/e),e=Math.min(Math.ceil((b+c)/e),a.C.length));for(b=d;b<e;b++)c=a.C[b],c.H&&c.F.setActive(!0)}}function Tdd(a,b,c,d){if(null!==a.H.C){var e=b+d/2;b=0==b?0:b>=c-d?a.C.length-1:Taa(a.C,function(a){return a.La.offsetTop<e},a);Mdd(a.H,b)}}
function N3(a,b,c){function d(b){if(!a.isDisposed()){if(0<e){var c=Ka(),h=c-f;f=c;1==e&&ocd(a.Kb,35434,h);ocd(a.Kb,35435,h)}if(b){b=Udd(a,e++);rcd(b,Vdd(a));b.Jd(Wdd(a));if(1==e){var c=a.Ia,h=b.La.children[0],m=a.D.D,q=E3(a.D);c.Ba().appendChild(h,c.La);c.H=Fp(h);Cp(c.La,c.H);c.C=m;c.Ca=q;Rcd(c)}a.F=a.F.then(Ha(Xja,10)).then(u(b.JK,b,a.qa)).then(d)}else{for(b=e;b<a.C.length;b++)G(a.C[b]);a.C.length=e;a.V=!1;b=a.H;b.C=a.C.length;Ndd(b);Ldd(b,!1);b=a.bb("waffle-printing-preview-inner");Tdd(a,b.scrollTop,
b.scrollHeight,Fp(b).height)}}}a.F.cancel(b);a.F=Xja(0);a.V=!0;c&&(a.J=null);G(a.L);a.L=new A3(a.Ca);F(a,a.L);ritz_api.PrintApi.dispose(a.qa);a.qa=Pdd(a);a.H.reset();var e=0,f=Ka();a.F=a.F.then(function(){if(!a.isDisposed()){a.J||(rcd(Udd(a,0),Vdd(a)),Xdd(a));for(var b=0;b<a.C.length;b++){var c=a.C[b];c.J=a.D.D;c.H=!0;rcd(c,Vdd(a));c.Jd(Wdd(a))}b=a.bb("waffle-printing-preview-inner");Sdd(a,b.scrollTop,Fp(b).height)}}).then(Sf).then(d)}
function Vdd(a){if(a.O)return a.O;var b=Wdd(a).height,c=Fp(a.La).height-100;a.O=b<=c?1:c/b;return a.O}function Wdd(a){a.J||Xdd(a);return a.J}function Xdd(a){var b=a.D.D,c=Udd(a,0).getWidth(),b=c*b.getHeight()/b.getWidth();a.J=new Ug(c,b)}p.zKb=function(){Ydd(this,.1)};p.DGb=function(){Ydd(this,-.1)};p.ipb=function(a){a.newValue&&(this.bb("waffle-printing-preview-inner").scrollTop=0)};
function Ydd(a,b){var c=a.bb("waffle-printing-preview-inner"),d=Fp(c),e=c.scrollHeight-d.height,f=c.scrollWidth-d.width,h=0>=e?0:c.scrollTop/e,k=0>=f?.5:c.scrollLeft/f;a.O=Math.max(Vdd(a)+b,.1);e=c.scrollHeight-d.height;f=c.scrollWidth-d.width;c.scrollTop=e*h;c.scrollLeft=f*k;N3(a,"zoom",!0)}
function Pdd(a){var b=a.D,c=Ka();C(b.C,27,25569+(c-6E4*(new Date(c)).getTimezoneOffset())/864E5);b=a.D.D;return ritz_api.PrintApi.createRitzPrinter(ritz_api.RitzModelApi.getTopLevelModel(),a.Oa.D.F,96*b.getHeight()/72,96*b.getWidth()/72,tcd.serialize(a.D.C),a.ib.C,wD,a.Z,a.Ca,a.Xa,a.Pa,a.L)}function Udd(a,b){b=a.C[b]||new pcd(a.D.D,a.Ba());if(!b.wc()){a.Wa(b);var c=a.Ba().bb("waffle-printing-preview-inner",a.La);b.render(c);a.C.push(b)}return b}
p.Ja=function(){this.F.cancel("Dispose internal");ritz_api.PrintApi.dispose(this.qa);ritz_api.PrintApi.clearCache();R.prototype.Ja.call(this)};var Qdd="qa Ma La ra oa Ka ua va ta ja $a Pa Qa fa ga ha ma ka na la Ia Sa Ya ea ia Za Va pa sa".split(" "),Rdd=["conditional-formats-updated","number_format","locale_change"];function O3(a,b){R.call(this,b);this.F=a;this.C=new ts("+",this.Ba());this.C.Ae("Zoom in");Lq(this.C,"Zoom in");this.D=new ts("-",this.Ba());this.D.Ae("Zoom out");Lq(this.D,"Zoom out")}la(O3,R);O3.prototype.Ga=function(){this.La=T(bcd)};
O3.prototype.Sa=function(){R.prototype.Sa.call(this);Wt(this.F,this.C,X.u6);Wt(this.F,this.D,X.v6);this.C.render(this.bb("waffle-printing-zoom-in-button"));this.D.render(this.bb("waffle-printing-zoom-out-button"));var a=new mp(this.La);F(this,a);this.getHandler().R(a,"focusin",this.H).R(a,"focusout",this.J)};O3.prototype.H=function(){fp(this.C.La,"waffle-printing-zoom-force-visible");fp(this.D.La,"waffle-printing-zoom-force-visible");nm(this.Ba())==this.La&&this.C.focus()};
O3.prototype.J=function(){hp(this.C.La,"waffle-printing-zoom-force-visible");hp(this.D.La,"waffle-printing-zoom-force-visible")};function Zdd(a,b,c,d,e,f,h,k,l,m,q){z3.call(this,"waffle-printing-pane",q);this.V=a;this.Db=c;this.O=m;this.C=l;this.F=new ts(void 0,this.Ba());this.Wa(this.F);this.D=new ts(void 0,this.Ba());this.Wa(this.D);a="en"==b.qa.C||"US"==b.qa.eC();c=new Qcd(this.C,a,this.Ba());l=new O3(this.C,this.Ba());this.L=new Odd(this.V,b,d,e,f,h,k,c,l,this.Ba());this.Wa(this.L);this.J=new Hdd(0,b.C,this.C,c,l,a,m,this.Ba());this.Wa(this.J)}la(Zdd,z3);
Zdd.prototype.Ga=function(){z3.prototype.Ga.call(this);this.Ba().appendChild(jcd(this),T(Rbd,{jqa:this.O}));kcd(this,T(Nbd));this.J.render(this.Hb("waffle-printing-options-pane"));this.L.render(this.Hb("waffle-printing-preview-pane"))};Zdd.prototype.Sa=function(){z3.prototype.Sa.call(this);B3(this.C,this.F,X.t6);B3(this.C,this.D,X.IX);this.F.mb(this.Hb("waffle-printing-print-button"));this.D.mb(this.Hb("waffle-printing-cancel-button"));this.Db.Rb(2)};Zdd.prototype.H=function(a){27==a.keyCode&&X.IX.Ec()};function $dd(a,b,c,d,e,f,h,k){On.call(this);this.fb=b;this.Db=c;this.Pa=d;this.J=a;this.$a=e;this.ib=f;this.Xa=h;this.Kb=k;this.Ia=new cR;F(this,this.Ia);this.qa=new AL;F(this,this.qa);this.C=new zcd(sc(ritz_api.PrintApi.getDefaultPrintConfig()),this.J.qa,cD(this.J.C));Dcd(this.C,2);F(this,this.C);this.Ca=yYb().build();F(this,this.Ca);this.V=this.O=this.H=null;this.Oa=!1;a=new Io(this);F(this,a);Jo(Jo(a,X.t6,bo,this.Vzb),X.IX,bo,this.AKb);this.D["waffle-printing"]=!1}la($dd,On);p=$dd.prototype;
p.uh=da("Pa");
p.UVa=function(a){if(!this.H){this.Oa=a;this.H=new Zdd(this.C,this.J,this.Db,this.$a,this.ib,this.Xa,this.qa,this.Kb,this.Ca,a);F(this,this.H);Ccd(this.C,1,[Lbd(""+cD(this.J.C))]);a=new Be;for(var b=bIa(this.J.C),c=0;c<b.length;c++){var d=b[c],e=d.Pc().H;if(gv(e)){jv(e);var f=new Ae,h=""+d.Jb();C(f,1,h);h=chc(e);C(f,3,h);d=vh(hv(e),d.Jb());C(f,4,d);Ac(a,1,f)}}this.C.J=a;Qn(this,{"waffle-printing":!0});this.hXa();this.V=new Io(this);F(this,this.V);aed(this);this.getHandler().R(this.C,["rf","sf"],this.hXa);
this.H.render()}};function bed(a){Qn(a,{"waffle-printing":!1});G(a.V);a.V=null;a.H&&a.H.setVisible(!1);G(a.H);a.H=null;a.Db.Rb(3)}
function aed(a){Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(Jo(a.V,X.gQ,Zn,a.Rzb,a),X.Qy,Zn,function(b){Ccd(a.C,a.C.F,b.newValue)}),X.SX,Zn,function(b){var c=a.C;b=b.newValue;b=ycd(xcd.getInstance(),b,c.D.D);if(c.D!=b){if("c"==Ecd(c)){var d=Hcd("n");C(c.C,15,d)}c.D=b;c.dispatchEvent(new H("sf"))}}),X.RX,Zn,function(b){var c=a.C;b=b.newValue;var d=ycd(xcd.getInstance(),c.D.C,b);if(c.D!=d){if(c.H&&yc(c.C,15)){var e=c.C,f=E3(c),h=new wf,f=[f.getTop(),B(f,4),B(f,2),f.getLeft()];
b?f.unshift(f.pop()):f.push(f.shift());C(h,1,f[0]);C(h,4,f[1]);C(h,2,f[2]);C(h,3,f[3]);C(e,15,h)}c.D=d;c.dispatchEvent(new H("sf"))}}),X.TX,Zn,function(b){var c=a.C;b=b.newValue;B(c.C,6)!=b&&(C(c.C,6,b),c.dispatchEvent(new H("rf")))}),X.WE,Zn,function(b){var c=a.C;b=b.newValue;B(c.C,7)!=b&&(C(c.C,7,b),c.dispatchEvent(new H("rf")))}),X.OX,Zn,function(b){var c=a.C,d=Hcd(b.newValue);c.H=!d;d&&C(c.C,15,d);c.dispatchEvent(new H("rf"));"c"==b.newValue&&Icd(a.C,X.Ap.Za())}),X.Ap,Zn,function(b){Icd(a.C,b.newValue)}),
X.AJ,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,22)!=b&&(C(c.C,22,b),c.dispatchEvent(new H("rf")))}),X.CJ,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,21)!=b&&(C(c.C,21,b),c.dispatchEvent(new H("rf")))}),X.PX,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,8)!=b&&(C(c.C,8,b),c.dispatchEvent(new H("rf")))}),X.LX,Yn,function(b){var c=a.C;b=!b.newValue;B(c.C,1)!=b&&(C(c.C,1,b),c.dispatchEvent(new H("rf")))}),X.QX,Zn,function(b){var c=a.C;C(c.C,16,b.newValue);c.dispatchEvent(new H("rf"))}),X.EJ,Yn,function(b){var c=
a.C;b=b.newValue;B(c.C,2)!=b&&(C(c.C,2,b),c.dispatchEvent(new H("rf")))}),X.HJ,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,3)!=b&&(C(c.C,3,b),c.dispatchEvent(new H("rf")))}),X.GJ,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,4)!=b&&(C(c.C,4,b),c.dispatchEvent(new H("rf")))}),X.yJ,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,18)!=b&&(C(c.C,18,b),c.dispatchEvent(new H("rf")))}),X.zJ,Yn,function(b){var c=a.C;b=b.newValue;B(c.C,19)!=b&&(C(c.C,19,b),c.dispatchEvent(new H("rf")))}),X.NX,Zn,function(b){Dcd(a.C,
b.newValue)}),X.UX,Zn,function(b){var c=a.C;b=b.newValue;B(c.C,29)!=b&&(C(c.C,29,b),c.dispatchEvent(new H("rf")))}),X.JX,bo,a.gpb),X.s6,bo,a.fpb),X.KX,bo,a.epb)}p.Rzb=function(a){var b=cD(this.J.C),c=[];switch(a.newValue){case 1:c=[Lbd(""+b)];break;case 2:c=this.J.C.getActiveGrid(),c=[vh(c.Pc().Rc(),b)]}Ccd(this.C,a.newValue,c)};
p.hXa=function(){var a=this.C;X.gQ.gb(a.F);X.Qy.gb(Bcd(a));X.SX.gb(a.D.C);X.RX.gb(a.D.D);var b=B(a.C,6);X.TX.gb(b);X.WE.gb(B(a.C,7));X.WE.eb(5==b);X.NX.gb(B(a.C,28));X.UX.gb(B(a.C,29));X.OX.gb(Ecd(a));X.Ap.eb("c"==Ecd(a));X.Ap.gb(E3(a));X.PX.zd(B(a.C,8));X.LX.zd(!B(a.C,1));X.QX.gb(B(a.C,16));X.EJ.zd(B(a.C,2));X.HJ.zd(B(a.C,3));X.GJ.zd(B(a.C,4));X.yJ.zd(B(a.C,18));X.zJ.zd(B(a.C,19));X.CJ.zd(B(a.C,21));X.AJ.zd(B(a.C,22))};
p.gpb=function(){this.O||(this.O=new C3(this.C,this.J,this.$a,this.Xa,this.Ca,this.qa),this.O.render(),this.H.setVisible(!1))};p.epb=function(){G(this.O);this.O=null;this.H.setVisible(!0)};p.fpb=ca();p.Vzb=function(){ced||(ced=$Rb(ZRb(YRb(XRb(this.fb)),this.J.D)).$f());var a=ehc()&&!this.Oa,b=this.Pa.Qf("/export"),c=u,d=this.Ia.J,e=this.Ia,b=ck(Dk(b)),f={format:"pdf"};uc(f,Kcd(this.C,a));a=c(d,e,b,f,a);ced&&!this.Oa?(c=ced,d=Jcd(this.C),lhc(c.D,c.H,khc(c),d?"id="+c.C+","+d:c.C,a)):a();bed(this)};
p.AKb=function(){bed(this)};p.Ja=function(){G(this.O);On.prototype.Ja.call(this)};var ced=null;function ded(){E.call(this)}w(ded,jn);ded.prototype.C=function(){return $dd};wn("printing",ded);
